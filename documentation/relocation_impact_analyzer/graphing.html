<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>relocation_impact_analyzer.graphing API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../relocation_impact_analyzer.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;relocation_impact_analyzer</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Graphing">Graphing</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Graphing.__init__">Graphing</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.configure_map_plot">configure_map_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_addresses">plot_addresses</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_offices">plot_offices</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.add_scalebar">add_scalebar</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.round_to_nearest_order_of_magnitude">round_to_nearest_order_of_magnitude</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.calculate_zoom_level">calculate_zoom_level</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.filter_radius">filter_radius</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.filter_drive_distance">filter_drive_distance</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.filter_drive_time">filter_drive_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_common_points">get_common_points</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_unique_points">get_unique_points</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.haversine">haversine</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.haversine_newpoint">haversine_newpoint</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_ellipses">plot_ellipses</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_elines">plot_elines</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.create_eline">create_eline</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_convex_hull">plot_convex_hull</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_commute_values">get_commute_values</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.plot_preamble">plot_preamble</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_map_view">get_map_view</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.map_view_standard_legend">map_view_standard_legend</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_heatmap">get_heatmap</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_histogram">get_histogram</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_scatterplot">get_scatterplot</a>
                        </li>
                        <li>
                                <a class="function" href="#Graphing.get_piechart">get_piechart</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../relocation_impact_analyzer.html">relocation_impact_analyzer</a><wbr>.graphing    </h1>

                        <div class="docstring"><p>Graphing utility class for the Relocation Impact Analysis Tool</p>

<p>The Graphing class in this module is designed to support creating visual representations of commute data, offering insightful visual analytics 
for relocation impact analysis. It harnesses the power of Matplotlib, Cartopy, and other scientific computing libraries to produce 
detailed maps, heatmaps, and histograms. These visualizations can illustrate geographical distributions, commute distances and times, 
and other critical metrics such as CO2 emissions or cost implications of potential office relocations. The class provides methods to 
plot employee and office locations on maps with various base layers, including OpenStreetMap and Google Maps, and to draw commuting 
radii, convex hulls, and more. It supports filtering employees based on commute distances and times, enhancing decision-making with 
visual data exploration tools. This module stands as a core component for analyzing the spatial aspects of commute data, aiding in 
the evaluation of relocation strategies through comprehensive, easy-to-understand graphical outputs.</p>

<p>Author: Victor Foulk
License: MIT License
Date: 2024-03-15
Version: 0.0.1 Pre-Alpha</p>
</div>

                        <input id="mod-graphing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-graphing-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Graphing utility class for the Relocation Impact Analysis Tool</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">The Graphing class in this module is designed to support creating visual representations of commute data, offering insightful visual analytics </span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">for relocation impact analysis. It harnesses the power of Matplotlib, Cartopy, and other scientific computing libraries to produce </span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">detailed maps, heatmaps, and histograms. These visualizations can illustrate geographical distributions, commute distances and times, </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">and other critical metrics such as CO2 emissions or cost implications of potential office relocations. The class provides methods to </span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">plot employee and office locations on maps with various base layers, including OpenStreetMap and Google Maps, and to draw commuting </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">radii, convex hulls, and more. It supports filtering employees based on commute distances and times, enhancing decision-making with </span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">visual data exploration tools. This module stands as a core component for analyzing the spatial aspects of commute data, aiding in </span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="sd">the evaluation of relocation strategies through comprehensive, easy-to-understand graphical outputs.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="sd">Author: Victor Foulk</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd">License: MIT License</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">Date: 2024-03-15</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="sd">Version: 0.0.1 Pre-Alpha</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">Ellipse</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">ConvexHull</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">cartopy.io.img_tiles</span> <span class="kn">import</span> <span class="n">OSM</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span> <span class="nn">cartopy.io.img_tiles</span> <span class="kn">import</span> <span class="n">GoogleTiles</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="k">class</span> <span class="nc">Graphing</span><span class="p">:</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">        Initializes the Graphing class instance.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>        <span class="k">pass</span>  
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="k">def</span> <span class="nf">configure_map_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">        Configures a map plot with specified latitudes and longitudes and an optional background imagery source.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">        Args:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">            latitudes (list): A list of latitude coordinates for plotting.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">            longitudes (list): A list of longitude coordinates for plotting.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">            imagery (str, optional): The background imagery source. Options include &quot;OSM&quot; (default), &quot;Google&quot;, and &quot;GoogleSatellite&quot;.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">            padding (float, optional): Padding around the coordinate extents to ensure all points are visible on the map.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">        Returns:</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">            tuple: A tuple containing the figure and axis objects of the map plot.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>        <span class="c1"># configure the map plot</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>        <span class="k">if</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;OSM&quot;</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>            <span class="c1"># use OpenStreetMap as the background map</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;Google&quot;</span><span class="p">:</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">()</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;GoogleSatellite&quot;</span><span class="p">:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;satellite&#39;</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>        <span class="c1"># set figure size for readability</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">imagery</span><span class="o">.</span><span class="n">crs</span><span class="p">})</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>        
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>        <span class="c1"># set the extent of the map to include all the points plus a little extra</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="n">lat_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="n">long_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>        <span class="n">min_max</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">-</span><span class="n">long_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">+</span><span class="n">long_delta</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">-</span><span class="n">lat_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">+</span><span class="n">lat_delta</span><span class="p">]</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">min_max</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>        <span class="c1"># Add the imagery to the map at an automatically-chosen zoom level</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">imagery</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_zoom_level</span><span class="p">(</span><span class="n">ax</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>    <span class="k">def</span> <span class="nf">plot_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">):</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        Plots address points on the map.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">        Args:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;red&#39;.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 10.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;o&#39; (circle).</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="k">def</span> <span class="nf">plot_offices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">        Plots office location points on the map.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">        Args:</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;black&#39;.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 100.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;*&#39; (star).</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>        
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="k">def</span> <span class="nf">add_scalebar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        Adds a scale bar to the map plot.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        Args:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">            ax: The matplotlib axes object to add the scale bar to.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">            location (tuple, optional): A tuple (x, y) representing the location of the scale bar as a fraction of the axis dimensions. </span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">            Defaults to (0.05, 0.05).</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="c1"># first get the extent of the map</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="c1"># calculate the width of the x axis in miles</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="n">xd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>        <span class="n">yd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="n">xd</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="n">bar</span> <span class="o">=</span> <span class="n">order</span><span class="o">/</span><span class="mf">4.0</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>        
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="n">np</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="c1"># now we create a tuple of long/lats for the scalebar</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">])</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="c1"># now, adjust the coordinates of the scalebar for proper chart placement, up location[0]% and right location[1]%</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="c1"># now we create end bars for the scale bar using scalebar as the source coordinates.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="c1"># end bars are positioned one at each end of the scalebar, centered vertically on the scalebar, and total height being 2% of y axis</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="n">scalebar_end</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="n">scalebar_end2</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="c1"># now we put a text label on the scale bar indicating the number of miles shown (bar).  Center the lable on the scalebar</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles&#39;</span><span class="p">,</span> 
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>        <span class="c1"># draw a scale bar</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>    <span class="k">def</span> <span class="nf">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        Rounds a number to the nearest order of magnitude.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        Args:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">            number (float): The number to round.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="sd">        Returns:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">            float: The rounded number.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="c1"># Calculate the order of magnitude of the number</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="n">order_of_magnitude</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)))</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="c1"># Normalize the number to a value between 1 and 10 and round it</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="n">rounded_normalized_number</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span> <span class="o">/</span> <span class="n">order_of_magnitude</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>        <span class="c1"># Multiply back by the order of magnitude to get the rounded number</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="k">return</span> <span class="n">rounded_normalized_number</span> <span class="o">*</span> <span class="n">order_of_magnitude</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>    <span class="k">def</span> <span class="nf">calculate_zoom_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">tile_service_resolution</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">        Calculate an appropriate zoom level for a Cartopy axis based on its extent.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">        </span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">        Args:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">        - ax: The Cartopy GeoAxes object.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">        - tile_service_resolution: The resolution of the tile service (256 for most web services).</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        </span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">        Returns:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        - An integer zoom level.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="c1"># Get the extent of the axis and calculate the width in degrees</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="n">width_deg</span> <span class="o">=</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="c1"># Estimate the width of the plot in pixels</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="n">width_in_pixels</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="c1"># Calculate the zoom level</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="c1"># This formula is an approximation and might need adjustment for your specific needs</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">((</span><span class="mi">360</span> <span class="o">*</span> <span class="n">width_in_pixels</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">width_deg</span> <span class="o">*</span> <span class="n">tile_service_resolution</span><span class="p">))</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zoom_level</span><span class="p">),</span> <span class="mi">19</span><span class="p">))</span>  <span class="c1"># Ensure zoom level is within a valid range</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>    
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="k">def</span> <span class="nf">filter_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">        Filters source points based on their linear distance from target points within a specified radius.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        Args:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">            inside (bool, optional): If True, filters for source points inside the radius. If False, filters for source points </span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">            outside the radius. Defaults to True.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        Returns:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the radius criteria.</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="c1"># check if the lat/long pair is within radius of any of the targets.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="c1"># offices is a pandas dataframe with columns latitude and longitude, and each row represents a cetnered target location</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="c1"># return true if the lat/long pair is within radius of any of the offices, otherwise return false (vice versa for outside)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="k">def</span> <span class="nf">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>                <span class="k">if</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>                <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> 
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>                                <span class="k">if</span> <span class="n">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>    <span class="k">def</span> <span class="nf">filter_drive_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">        Filters source points based on the driving distance to target points using commute data.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        Args:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the driving distance radius. If False, </span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">            filters for source points outside the radius. Defaults to True.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        Returns:</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving distance criteria.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="c1"># employee address maps to source, office address maps to destination</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="c1"># for each office, check if the lat/long pair is within radius of any of the offices based upon actual driving distance</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>        <span class="k">def</span> <span class="nf">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lon</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>                                <span class="p">]</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>                                <span class="k">if</span> <span class="n">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>    <span class="k">def</span> <span class="nf">filter_drive_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        Filters source points based on the driving time to target points using commute data.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">        Args:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">            minutes (float): The maximum driving time in minutes within which to filter source points.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the specified driving time. If False, filters for source points outside the driving time. Defaults to True.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        Returns:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving time criteria.</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="k">def</span> <span class="nf">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">long</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>                                <span class="p">]</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">long</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>                                <span class="k">if</span> <span class="n">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>                            
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>    <span class="k">def</span> <span class="nf">get_common_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        Finds common points between two sets of latitudes and longitudes.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">        Args:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">        Returns:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">            DataFrame: A DataFrame of common points between the two sets.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>        <span class="c1"># find the common points between the two sets</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">set2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>    <span class="k">def</span> <span class="nf">get_unique_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        Finds unique points in the first set that are not present in the second set.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        Args:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        Returns:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">            DataFrame: A DataFrame of unique points in the first set.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="c1"># find the unique points in the first set</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="p">[</span><span class="o">~</span><span class="n">set1</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">set2</span><span class="p">)]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>    <span class="k">def</span> <span class="nf">haversine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        Calculates the great-circle distance between two points on the Earth specified in decimal degrees using the Haversine formula.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">        Args:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">            lat1 (float): Latitude of the first point.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">            lon1 (float): Longitude of the first point.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">            lat2 (float): Latitude of the second point.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">            lon2 (float): Longitude of the second point.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        Returns:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">            float: The distance between the two points in miles.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="c1">#To calculate the distance between two latitude/longitude coordinates while taking the curvature of the Earth into account, </span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="c1">#you use the Haversine formula. This formula gives you the great-circle distance between two points on the surface of a sphere, </span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>        <span class="c1">#given their longitudes and latitudes. This is particularly useful for calculating the approximate distance between two points </span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="c1">#on the Earth.&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>        <span class="c1"># Radius of the Earth in miles</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>        <span class="n">R</span> <span class="o">=</span> <span class="mf">3958.8</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="c1"># Radius of the Earth in kilometers (uncomment to use kilometers)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="c1">#R = 6371.0</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>        <span class="c1"># Convert latitude and longitude from degrees to radians</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>        <span class="n">lat1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="n">lon1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="n">lat2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>        <span class="n">lon2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="c1"># Difference in coordinates</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="n">dlat</span> <span class="o">=</span> <span class="n">lat2_rad</span> <span class="o">-</span> <span class="n">lat1_rad</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">dlon</span> <span class="o">=</span> <span class="n">lon2_rad</span> <span class="o">-</span> <span class="n">lon1_rad</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="c1"># Haversine formula</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="c1"># Total distance in (units selected above)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">c</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="k">return</span> <span class="n">distance</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>    
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>    <span class="c1"># calcuate a new point given a distance and bearing from a starting point using haversine</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>    <span class="k">def</span> <span class="nf">haversine_newpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">bearing</span><span class="p">):</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">        Calculates a new point given a distance and bearing from a starting point using the Haversine formula.</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">        Args:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">            lat1 (float): Latitude of the starting point.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">            lon1 (float): Longitude of the starting point.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">            distance (float): Distance from the starting point in miles.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">            bearing (float): Bearing in degrees from the starting point to the new point.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">        Returns:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">            tuple: A tuple (lat2, lon2) representing the latitude and longitude of the new point.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>        <span class="c1"># convert distance to radians</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">/</span> <span class="mf">3958.8</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>        <span class="c1"># convert bearing to radians</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>        <span class="n">bearing</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="c1"># convert latitude to radians</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="n">lat1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="c1"># convert longitude to radians</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="n">lon1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>        <span class="c1"># calculate the new latitude</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bearing</span><span class="p">))</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="c1"># calculate the new longitude</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">))</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="c1"># convert latitude back to degrees</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="c1"># convert longitude back to degrees</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>    <span class="k">def</span> <span class="nf">plot_ellipses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">):</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">        Draws ellipses around office locations to represent the commute radius from each office.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        Args:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">            offices (DataFrame): A DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            commute_radius (float): The radius to draw around each office location, in miles.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="c1"># draw an ellipse around the office locations to represent the radius from each office (ellipse in thise OSM projection will be a circle)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>        <span class="c1"># note: this will be a jagged representation due to cartopy handling, better to use our own eline function</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">xcdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">ycdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">offices</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>            <span class="c1"># if cdelta is None, calculate the circle radius using first set of lat long, and using haversine to calcuate a new point, then x0-x1</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>            <span class="k">if</span> <span class="n">ycdelta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>                <span class="c1"># calculate the circle radius using the first set of lat long</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>                <span class="n">ycdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>                <span class="n">xcdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">90</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>            <span class="c1"># calculate the ellipse around the office location</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">xcdelta</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ycdelta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipse</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>    
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>    <span class="k">def</span> <span class="nf">plot_elines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        Draws lines (elipses) around target points to represent a specified radius from each point on a map.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">        Args:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">            commute_radius (float): The radius around each target point to draw, in miles.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">            color (str, optional): Color of the lines. Defaults to &#39;black&#39;.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">            linestyle (str, optional): Style of the line. Defaults to &#39;--&#39;.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">            linewidth (int, optional): Width of the lines. Defaults to 2.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="c1"># plot an eline</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="n">elinex</span><span class="p">,</span><span class="n">eliney</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_eline</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;New Line&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>    <span class="k">def</span> <span class="nf">create_eline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">        Creates a set of latitude and longitude points that form a circle (or ellipse) around a central point.</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">        Args:</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">            lat (float): Latitude of the central point.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">            long (float): Longitude of the central point.</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">            r (float): Radius of the circle in miles.</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">            step (int, optional): Degrees between each point on the circle. Smaller values create a smoother circle. Defaults to 10.</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">        Returns:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">            tuple: Two lists containing the longitude and latitude of points forming the circle.</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="c1"># start with the lat/long, and calculate a point r miles away at 0 degrees, then, repeat every step degrees until 360, inclusive</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="n">elinex</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="n">eliney</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>            <span class="n">np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>            <span class="n">elinex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="n">eliney</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">]</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>    
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>    <span class="k">def</span> <span class="nf">plot_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">        Draws a convex hull around a set of points on the map, effectively creating a boundary that encloses all the points.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">        Args:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">            data (DataFrame): A DataFrame containing points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">            color (str, optional): Color of the convex hull boundary. Defaults to &#39;green&#39;.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">            linestyle (str, optional): Style of the hull boundary line. Defaults to &#39;--&#39;.</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">            linewidth (int, optional): Width of the hull boundary line. Defaults to 2.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">            linealpha (float, optional): Transparency of the hull boundary line. Defaults to 0.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">            fillalpha (float, optional): Transparency of the hull fill. Defaults to 1.</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="c1"># plot the convex hull of the employee addresses within the commute radius</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>        <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="k">for</span> <span class="n">simplex</span> <span class="ow">in</span> <span class="n">hull</span><span class="o">.</span><span class="n">simplices</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> 
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                     <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span> 
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>    
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>    <span class="k">def</span> <span class="nf">get_commute_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">        Extracts specified values from the commute data for employee addresses that match a given office location.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a><span class="sd">        Args:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="sd">            emp (DataFrame): A DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">            office (DataFrame): A single-row DataFrame containing the target office location with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">            values (list of str or str): Column name(s) in `commute_data` to extract. Can be a single column name or a list of names.</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">        Returns:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">            DataFrame: A DataFrame containing the extracted values for each employee location that matches the given office location. The DataFrame includes &#39;latitude&#39; and &#39;longitude&#39; of the employee locations and the specified `values`.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>         <span class="c1"># Ensure the basic columns are always included</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">base_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">]</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="c1"># Combine base columns with user-specified columns, removing duplicates</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_columns</span><span class="p">]</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="k">return</span> <span class="n">commute_data</span><span class="p">[(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>                           <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>                            <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]))][</span><span class="n">selected_columns</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>    
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>    <span class="k">def</span> <span class="nf">plot_preamble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">        Filters employee locations based on a specified cutoff radius from office locations and prepares data for plotting.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        Args:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations. Only employee locations within this radius from any office location are included.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations. Only employee locations within this distance from any office location are included.</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations, required if `cutoff_distance` is specified.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">            </span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">        Returns:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">            tuple: A tuple containing the filtered employee DataFrame, and Series objects for latitudes and longitudes of all included </span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">            locations (employees and offices combined). The filtered DataFrame only includes employees within the `cutoff_radius` from </span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">            any office location if specified.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="c1"># we will use the haversine formula to calculate the distance between two lat/long pairs </span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="k">if</span> <span class="n">cutoff_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_radius of any of the offices</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="k">elif</span> <span class="n">cutoff_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_distance of any of the offices</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="n">emp</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="c1"># data is a pandas dataframe has coloumns latitude and longitude        </span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>        <span class="c1"># append the office lat/longs to the employee lat/longs to get bounding box</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="n">latitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="n">longitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]])</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>        <span class="k">return</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>    <span class="k">def</span> <span class="nf">get_map_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                      <span class="n">commute_color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                      <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                      <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">        Generates a map view showing employee and office locations, optionally with commute radius and coloring based on commute data.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        Args:</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">            commute_data (DataFrame, optional): DataFrame containing commute data between employee and office locations. Required if commute_color is True.</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations for visualization.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations for visualization.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">            commute_radius (float, optional): Radius in miles from offices to visualize commute boundaries.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">            commute_color (bool, optional): If True, colors employee locations based on commute data presence within commute_radius.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">            title (str, optional): Title for the map.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">            convex_hull (bool, optional): If True, draws a convex hull around employee locations within commute_radius.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">            legend_loc (str, optional): Location of the legend on the map. Defaults to &#39;upper right&#39;.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">            font_mod (int, optional): Font size modifier for scale bar. Defaults to 1.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">        Returns:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">            tuple: A tuple containing the matplotlib plt and axes objects.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">        Notes:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">            - Requires `commute_data` for commute_color functionality.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a><span class="sd">            - Adjust `cutoff_radius` and `commute_radius` to fine-tune the visualization.</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="c1"># configure the plot</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">)</span>        
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="c1">#plt.plot(longitudes, latitudes, color=&#39;red&#39;, marker=&#39;*&#39;, markersize=3, linestyle=&#39;&#39;, transform=ccrs.PlateCarree())#ccrs.OSGB())</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">commute_color</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>            <span class="c1"># plot the lat long points with color based on if the employee is within the linear radius of any of the offices</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>            <span class="c1"># first create two new data frames for the employees within and outside the linear radius, and populate them with the appropriate lat/long pairs</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Within &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Outside &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>            
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="c1"># use the commute data to use actual driving distance to color the data points</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\N{LESS-THAN OR EQUAL TO}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>          
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>        <span class="c1"># draw a circle around the office locations to represent the radius from each office and add legend entry, if commute_radius is not None</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Linear Radius </span><span class="se">\n</span><span class="s1">(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles)&#39;</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_elines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>        
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="k">if</span> <span class="n">convex_hull</span> <span class="ow">and</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Convex Hull&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Bounding Area, </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Commute&#39;</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>            
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="c1"># add a legend  to the plot on the middle left</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">map_view_standard_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span><span class="n">legend_loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="c1"># add a title</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>    <span class="k">def</span> <span class="nf">map_view_standard_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> 
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                                 <span class="n">legend_edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>                                 <span class="n">legend_framealpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">        Adds a standard legend to a map view plot.</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">        Args:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">            ax: The matplotlib axes object on which to draw the legend.</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">            handles (list): A list of handles to the objects being represented in the legend.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">            labels (list): A list of labels for the objects being represented in the legend.</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">            title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">            legend_title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">            legend_loc (str, optional): Location for the legend. Defaults to &#39;upper left&#39;.</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">            legend_labels (list, optional): Labels for the legend entries. Defaults to None.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">            legend_colors (list, optional): Colors for the legend entries. Defaults to None.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">            legend_markers (list, optional): Markers for the legend entries. Defaults to None.</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">            legend_edgecolor (str, optional): Edge color for the legend. Defaults to &#39;black&#39;.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">            legend_frameon (bool, optional): Whether to draw a frame around the legend. Defaults to True.</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">            legend_facecolor (str, optional): Face color for the legend. Defaults to &#39;white&#39;.</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">            legend_framealpha (float, optional): Opacity of the legend frame. Defaults to 0.7.</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">            fontsize (int, optional): Font size for the legend. Defaults to 10.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>        <span class="c1"># Add legend to the plot</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">legend_edgecolor</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="n">legend_frameon</span><span class="p">,</span> 
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>                  <span class="n">facecolor</span><span class="o">=</span><span class="n">legend_facecolor</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="n">legend_framealpha</span><span class="p">)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>   
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="c1">############################################################################################################</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>            
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>    <span class="k">def</span> <span class="nf">get_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>                    <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> 
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>                    <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)):</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">        Generates a heatmap of a specific commute data metric for employee locations relative to a single office location.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        Args:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">            value (str): The name of the column in `commute_data` representing the metric to visualize on the heatmap.</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">            title (str, optional): Title for the heatmap. Defaults to None.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">            value_label (str, optional): Label for the color bar indicating the metric. Defaults to &#39;&#39;.</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the heatmap. Defaults to None.</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">            convex_hull (bool, optional): If True, draw a convex hull around the employee locations included in the heatmap. Defaults to False.</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">            plot_points (bool, optional): If True, plot individual employee locations on the heatmap. Defaults to False.</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            imagery (str, optional): Background map style. Supports &quot;OSM&quot; for OpenStreetMap and &quot;Google&quot; for Google Maps tiles. Defaults to &quot;OSM&quot;.</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">            cmap (str, optional): Colormap for the heatmap. Defaults to &#39;jet&#39;.</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">            alpha (float, optional): Transparency of the heatmap. Defaults to 0.5.</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">            levels (int, optional): Number of levels for the color bar. Defaults to 10.</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        Returns:</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>    
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="c1"># plot a) heatmap of a data value relative to employee addresses and a target office location</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>        <span class="c1"># create an np array of the lat long pairs and the value</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="n">imagery</span><span class="p">)</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="c1"># Create the heatmap</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="c1">#plt.tricontourf(X, Y, Z, cmap=&#39;jet&#39;, levels=10, alpha=0.7, transform=ccrs.PlateCarree())</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">value</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">value_label</span><span class="p">)</span>  <span class="c1"># Add a color bar to show the temperature scale</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">convex_hull</span><span class="p">:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>        
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="k">if</span> <span class="n">plot_points</span><span class="p">:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Employee </span><span class="se">\n</span><span class="s1">Addresses&#39;</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="c1"># add a title</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>    <span class="k">def</span> <span class="nf">get_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">column_titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cumulative_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_y_label</span><span class="o">=</span><span class="s2">&quot;Cumulative %&quot;</span><span class="p">,</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>                    <span class="n">cumulative_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cumulative_linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">cumulative_linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cumulative_markers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_as_percentage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>                    <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        Generates a histogram (or set of histograms) for specified commute data metrics for employee locations relative to a single office location.</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        Args:</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location.</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">            values (list of str): Names of the columns in `commute_data` representing the metrics to visualize in the histograms.</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">            title (str, optional): Main title for the histogram plot(s). Defaults to None.</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="sd">            value_label (str, optional): Label for the metric values. Defaults to &#39;&#39;.</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">            x_label (str, optional): Label for the x-axis. Defaults to &#39;&#39;.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">            y_label (str, optional): Label for the y-axis. Defaults to &#39;&#39;.</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the histograms. Defaults to None.</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the histograms. Defaults to None.</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">            bins (int, optional): Number of bins for the histograms. Defaults to 10.</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">            column_titles (list of str, optional): Titles for each subplot column. Defaults to None.</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="sd">            cumulative_line (bool, optional): If True, add a cumulative percentage line to the histograms. Defaults to False.</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">            cumulative_y_label (str, optional): Label for the cumulative percentage y-axis. Defaults to &quot;Cumulative %&quot;.</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">            cumulative_color (str, optional): Color for the cumulative line. Defaults to &#39;black&#39;.</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">            cumulative_linestyle (str, optional): Line style for the cumulative line. Defaults to &#39;--&#39;.</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a><span class="sd">            cumulative_linewidth (int, optional): Line width for the cumulative line. Defaults to 1.</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">            cumulative_markers (dict, optional): Dictionary specifying markers for specific cumulative percentages on the line. Format {%value(float or int): {style_arguments:values}}, not all values need to be present. Defaults to False.</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">            cumulative_as_percentage (bool, optional): If True, the cumulative line is displayed as a percentage. Defaults to True.</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">            override_values (DataFrame, optional): DataFrame to override default values for the plot. Defaults to None.</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">            sharex (bool, optional): If True, share x-axis between subplots. Defaults to False.</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">            sharey (bool, optional): If True, share y-axis between subplots. Defaults to False.</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">        Returns:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cumulative Markers format: {%value(float or int): {style_arguments:values}} not all values need to be present&quot;&quot;&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.995</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>        <span class="n">y_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>        <span class="n">x_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>            
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="c1"># set x label only for last row</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>            <span class="c1"># set titles only for first row</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">column_titles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column_titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>            <span class="c1"># set y axis only for first col</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>            
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>                <span class="k">continue</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>        
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="c1"># set the xticks and yticks font size</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>            
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>            <span class="c1"># if cumulative line is requested, plot it</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>            <span class="k">if</span> <span class="n">cumulative_line</span><span class="p">:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>                <span class="n">twin</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>                <span class="c1"># add a cumulative percentage line to the other y axis</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>                <span class="n">count</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="p">)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>                <span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>                
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>                <span class="c1"># get total cumulative for denominator to convert to percentage</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>                <span class="n">total</span> <span class="o">=</span> <span class="n">cumulative</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>                <span class="c1"># convert to percentage</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>                    <span class="n">cumulative</span> <span class="o">=</span> <span class="n">cumulative</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> 
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>                
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>                <span class="c1"># plot the cumulative line</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cumulative_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">cumulative_linestyle</span><span class="p">,</span> 
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                          <span class="n">linewidth</span><span class="o">=</span><span class="n">cumulative_linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cumulative_y_label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                <span class="c1"># turn grid on relative to the twin y axis</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                <span class="c1"># twin y ticks are percentage, set only for last column</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cumulative_y_label</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>                    <span class="c1"># set ticks every 25%, only show on last col</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                <span class="c1"># turn off twin y axis numbers for first col</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>                
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="c1"># add markers to the cumulative line if requested</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>                <span class="k">if</span> <span class="n">cumulative_markers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                    <span class="c1">#cumulative_markers format: {%value: {&#39;color&#39;: &#39;red&#39;, &#39;marker&#39;: &#39;o&#39;, &#39;label&#39;: &#39;75%&#39;, linestyle=&quot;--&quot;}} not all values need to be present</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                    <span class="c1"># we plot a vertical line at x where y=%value on the twin</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                    <span class="c1"># first get a polynomial fit to the cumulative percentage and find the x value where y is closest to %value</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>                    
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2000</span><span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>                    
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cumulative_markers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>                        <span class="c1"># get the x value where y is closest to key</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>                        <span class="n">xval</span> <span class="o">=</span> <span class="n">x</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>                        <span class="c1"># add the line with the style arguments</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xval</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>                        <span class="c1"># insert a label at the top of the line</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                        <span class="c1"># get width of the plot</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>                        <span class="n">x_max</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>                        <span class="n">x_min</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>                        <span class="c1"># calculate a delta for the label based on length                         </span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                        <span class="n">x_delta</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xval</span><span class="o">-</span><span class="n">x_delta</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cumulative</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>            <span class="c1"># capture dimensionality for matching limits across cols/rows</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>            <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="n">x_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                <span class="k">continue</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>            <span class="c1">#axf(r,c).set_xticks(np.arange(0, max(xyz[values[i]]), max(xyz[values[i]])/bins))</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>            
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>        <span class="c1">#plt.xlabel(x_label)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>        <span class="c1">#plt.ylabel(y_label)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>        
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>        
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>    <span class="k">def</span> <span class="nf">get_scatterplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        Generates a scatterplot for selected commute (or provided) data.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>            <span class="n">x_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_value</span><span class="p">]</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="n">y_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_value</span><span class="p">]</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span> <span class="o">+</span> <span class="n">y_value</span><span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="c1"># set x label </span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="c1"># set title</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="c1"># set y axis </span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>        <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>        <span class="c1"># give the bars a border for visibility</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="c1">#axf(r,c).hist(xyz[values[i]], bins=bins, alpha=0.5, edgecolor=&#39;gray&#39;, linewidth=1, zorder=2, align=&#39;mid&#39;, rwidth=0.8)</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">x_value</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">y_value</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="c1"># set the xticks and yticks font size</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>    <span class="k">def</span> <span class="nf">get_piechart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_labels</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>                     <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">        Generates a pie chart or charts for selected commute data.</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">        Args:</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">            values (str or list): Names of the columns in `commute_data` representing the metrics to visualize in the pie chart(s).</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">            title (str, optional): Title for the pie chart(s). Defaults to None.</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">            value_labels (str or list, optional): Labels for the values in the pie chart(s). Defaults to &#39;&#39;.</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to None.</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">            startangle (int, optional): Starting angle for the pie chart. Defaults to 90.</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">            colors (list, optional): List of colors for the pie chart. For multi-row/col, list of lists. Defaults to None.</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">        Returns:</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="c1"># basic preamble</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_labels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>            <span class="n">value_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">value_labels</span><span class="p">]</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">titles</span><span class="p">]</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>            <span class="c1"># set title </span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>                <span class="k">continue</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="n">textprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">}</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>  <span class="c1"># Equal aspect ratio ensures that pie is drawn as a circle</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>    <span class="c1"># read lat long pairs in from employeegps file</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    <span class="n">emp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../projects/HQ_Analysis/gps_fuzz.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>    <span class="n">offices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../projects/HQ_Analysis/office_gps.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="n">commute_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../projects/HQ_Analysis/commute_data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>    <span class="n">graph</span> <span class="o">=</span> <span class="n">Graphing</span><span class="p">()</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>    <span class="c1">#graph.plot()</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>    <span class="c1">#graph.plot_map_view(emp,offices, cutoff_radius=80, commute_radius=50, commute_color=True)</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">offices</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>        <span class="n">office</span> <span class="o">=</span> <span class="n">offices</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="n">index</span><span class="p">]]</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_map_view</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">commute_color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="n">commute_data</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#,cutoff_radius=80)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="c1">#plt, ax = graph.get_heatmap(emp, office, commute_data, &#39;emissions&#39;, title=&#39;m_morning_emissions&#39;, </span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="c1">#                            value_label=&#39;CO2 Emissions&#39;, cutoff_radius=40, commute_radius=50, convex_hull=True, plot_points=True, imagery=&quot;Google&quot;, cmap=&#39;gist_heat_r&#39;)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="c1">#plt, ax = graph.get_heatmap(emp, office, commute_data, &#39;m_morning_emissions&#39;, title=&#39;m_morning_emissions&#39;, </span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="c1">#                            value_label=&#39;CO2 Emissions&#39;, cutoff_radius=40, commute_radius=50, convex_hull=True, plot_points=True, imagery=&quot;Google&quot;, cmap=&#39;gist_heat_r&#39;)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="c1">#plt, ax = graph.get_heatmap(emp, office, commute_data, &#39;commute_cost&#39;, title=&#39;Per Commute Employee $ Impact&#39;, </span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="c1">#                            value_label=&#39;$/one way commute&#39;, cutoff_radius=40, commute_radius=50, convex_hull=True, plot_points=True, imagery=&quot;Google&quot;, cmap=&#39;autumn_r&#39;)</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="c1">#emp_within = graph.filter_drive_time(emp, office, 60, commute_data)</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="c1">#graph.plot_convex_hull(ax, emp_within, color=&#39;green&#39;)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">,</span><span class="s1">&#39;m_evening_duration_in_traffic&#39;</span><span class="p">,</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                  <span class="s1">&#39;t_morning_duration_in_traffic&#39;</span><span class="p">,</span><span class="s1">&#39;t_evening_duration_in_traffic&#39;</span><span class="p">,</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>                  <span class="s1">&#39;w_morning_duration_in_traffic&#39;</span><span class="p">,</span><span class="s1">&#39;w_evening_duration_in_traffic&#39;</span><span class="p">,</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>                  <span class="s1">&#39;h_morning_duration_in_traffic&#39;</span><span class="p">,</span><span class="s1">&#39;h_evening_duration_in_traffic&#39;</span><span class="p">,</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>                  <span class="s1">&#39;f_morning_duration_in_traffic&#39;</span><span class="p">,</span><span class="s1">&#39;f_evening_duration_in_traffic&#39;</span><span class="p">]</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">cumulative_markers</span> <span class="o">=</span> <span class="p">{</span><span class="mi">50</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;50%&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>                              <span class="mi">75</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;75%&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},}</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="c1">#plt.style.use(&#39;seaborn-v0_8-dark-palette&#39;)</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>        <span class="c1">#print(plt.style.available)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="c1">#plt = graph.get_histogram(emp, office, commute_data, values, cutoff_radius=40, bins=10, rows=5, cols=2, x_label=&#39;Minutes in Traffic&#39;, y_label=&#39;# of Employees&#39;)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="n">plt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_histogram</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="s2">&quot;Existing Commute Analysis&quot;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Minutes in Traffic&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;# Employees&#39;</span><span class="p">,</span>  
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column_titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Morning Commute&#39;</span><span class="p">,</span><span class="s1">&#39;Evening Commute&#39;</span><span class="p">],</span> <span class="n">cumulative_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                    <span class="n">cumulative_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cumulative_linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">cumulative_linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cumulative_markers</span><span class="o">=</span><span class="n">cumulative_markers</span><span class="p">)</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">)</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>            <span class="c1"># Add monday through Friday labels on first column only</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>            <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">colspan</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>                <span class="c1"># first row is monday, second is tuesday, etc</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>                <span class="n">row</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">rowspan</span><span class="o">.</span><span class="n">start</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>                <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                    <span class="n">each</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">each</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>                <span class="k">elif</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                    <span class="n">each</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">each</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>                <span class="k">elif</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                    <span class="n">each</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">each</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                <span class="k">elif</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                    <span class="n">each</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">each</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                <span class="k">elif</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>                    <span class="n">each</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">each</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>                    
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>        <span class="k">break</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>    <span class="c1">#graph.</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>    <span class="c1"># plot_map_view(emp,offices, commute_radius=50)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>    <span class="c1">#main()</span>
</span></pre></div>


            </section>
                <section id="Graphing">
                            <input id="Graphing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Graphing</span>:

                <label class="view-source-button" for="Graphing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing-38"><a href="#Graphing-38"><span class="linenos">  38</span></a><span class="k">class</span> <span class="nc">Graphing</span><span class="p">:</span>
</span><span id="Graphing-39"><a href="#Graphing-39"><span class="linenos">  39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Graphing-40"><a href="#Graphing-40"><span class="linenos">  40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-41"><a href="#Graphing-41"><span class="linenos">  41</span></a><span class="sd">        Initializes the Graphing class instance.</span>
</span><span id="Graphing-42"><a href="#Graphing-42"><span class="linenos">  42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-43"><a href="#Graphing-43"><span class="linenos">  43</span></a>        <span class="k">pass</span>  
</span><span id="Graphing-44"><a href="#Graphing-44"><span class="linenos">  44</span></a>
</span><span id="Graphing-45"><a href="#Graphing-45"><span class="linenos">  45</span></a>    <span class="k">def</span> <span class="nf">configure_map_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
</span><span id="Graphing-46"><a href="#Graphing-46"><span class="linenos">  46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-47"><a href="#Graphing-47"><span class="linenos">  47</span></a><span class="sd">        Configures a map plot with specified latitudes and longitudes and an optional background imagery source.</span>
</span><span id="Graphing-48"><a href="#Graphing-48"><span class="linenos">  48</span></a>
</span><span id="Graphing-49"><a href="#Graphing-49"><span class="linenos">  49</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-50"><a href="#Graphing-50"><span class="linenos">  50</span></a><span class="sd">            latitudes (list): A list of latitude coordinates for plotting.</span>
</span><span id="Graphing-51"><a href="#Graphing-51"><span class="linenos">  51</span></a><span class="sd">            longitudes (list): A list of longitude coordinates for plotting.</span>
</span><span id="Graphing-52"><a href="#Graphing-52"><span class="linenos">  52</span></a><span class="sd">            imagery (str, optional): The background imagery source. Options include &quot;OSM&quot; (default), &quot;Google&quot;, and &quot;GoogleSatellite&quot;.</span>
</span><span id="Graphing-53"><a href="#Graphing-53"><span class="linenos">  53</span></a><span class="sd">            padding (float, optional): Padding around the coordinate extents to ensure all points are visible on the map.</span>
</span><span id="Graphing-54"><a href="#Graphing-54"><span class="linenos">  54</span></a>
</span><span id="Graphing-55"><a href="#Graphing-55"><span class="linenos">  55</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-56"><a href="#Graphing-56"><span class="linenos">  56</span></a><span class="sd">            tuple: A tuple containing the figure and axis objects of the map plot.</span>
</span><span id="Graphing-57"><a href="#Graphing-57"><span class="linenos">  57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-58"><a href="#Graphing-58"><span class="linenos">  58</span></a>        <span class="c1"># configure the map plot</span>
</span><span id="Graphing-59"><a href="#Graphing-59"><span class="linenos">  59</span></a>        <span class="k">if</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;OSM&quot;</span><span class="p">:</span>
</span><span id="Graphing-60"><a href="#Graphing-60"><span class="linenos">  60</span></a>            <span class="c1"># use OpenStreetMap as the background map</span>
</span><span id="Graphing-61"><a href="#Graphing-61"><span class="linenos">  61</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="Graphing-62"><a href="#Graphing-62"><span class="linenos">  62</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;Google&quot;</span><span class="p">:</span>
</span><span id="Graphing-63"><a href="#Graphing-63"><span class="linenos">  63</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="Graphing-64"><a href="#Graphing-64"><span class="linenos">  64</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">()</span>
</span><span id="Graphing-65"><a href="#Graphing-65"><span class="linenos">  65</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;GoogleSatellite&quot;</span><span class="p">:</span>
</span><span id="Graphing-66"><a href="#Graphing-66"><span class="linenos">  66</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="Graphing-67"><a href="#Graphing-67"><span class="linenos">  67</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;satellite&#39;</span><span class="p">)</span>
</span><span id="Graphing-68"><a href="#Graphing-68"><span class="linenos">  68</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-69"><a href="#Graphing-69"><span class="linenos">  69</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="Graphing-70"><a href="#Graphing-70"><span class="linenos">  70</span></a>
</span><span id="Graphing-71"><a href="#Graphing-71"><span class="linenos">  71</span></a>        <span class="c1"># set figure size for readability</span>
</span><span id="Graphing-72"><a href="#Graphing-72"><span class="linenos">  72</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">imagery</span><span class="o">.</span><span class="n">crs</span><span class="p">})</span>
</span><span id="Graphing-73"><a href="#Graphing-73"><span class="linenos">  73</span></a>        
</span><span id="Graphing-74"><a href="#Graphing-74"><span class="linenos">  74</span></a>        <span class="c1"># set the extent of the map to include all the points plus a little extra</span>
</span><span id="Graphing-75"><a href="#Graphing-75"><span class="linenos">  75</span></a>        <span class="n">lat_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="Graphing-76"><a href="#Graphing-76"><span class="linenos">  76</span></a>        <span class="n">long_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="Graphing-77"><a href="#Graphing-77"><span class="linenos">  77</span></a>        <span class="n">min_max</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">-</span><span class="n">long_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">+</span><span class="n">long_delta</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">-</span><span class="n">lat_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">+</span><span class="n">lat_delta</span><span class="p">]</span>
</span><span id="Graphing-78"><a href="#Graphing-78"><span class="linenos">  78</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">min_max</span><span class="p">)</span>
</span><span id="Graphing-79"><a href="#Graphing-79"><span class="linenos">  79</span></a>
</span><span id="Graphing-80"><a href="#Graphing-80"><span class="linenos">  80</span></a>        <span class="c1"># Add the imagery to the map at an automatically-chosen zoom level</span>
</span><span id="Graphing-81"><a href="#Graphing-81"><span class="linenos">  81</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">imagery</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_zoom_level</span><span class="p">(</span><span class="n">ax</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</span><span id="Graphing-82"><a href="#Graphing-82"><span class="linenos">  82</span></a>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-83"><a href="#Graphing-83"><span class="linenos">  83</span></a>
</span><span id="Graphing-84"><a href="#Graphing-84"><span class="linenos">  84</span></a>    <span class="k">def</span> <span class="nf">plot_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">):</span>
</span><span id="Graphing-85"><a href="#Graphing-85"><span class="linenos">  85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-86"><a href="#Graphing-86"><span class="linenos">  86</span></a><span class="sd">        Plots address points on the map.</span>
</span><span id="Graphing-87"><a href="#Graphing-87"><span class="linenos">  87</span></a>
</span><span id="Graphing-88"><a href="#Graphing-88"><span class="linenos">  88</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-89"><a href="#Graphing-89"><span class="linenos">  89</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="Graphing-90"><a href="#Graphing-90"><span class="linenos">  90</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="Graphing-91"><a href="#Graphing-91"><span class="linenos">  91</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing-92"><a href="#Graphing-92"><span class="linenos">  92</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="Graphing-93"><a href="#Graphing-93"><span class="linenos">  93</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 10.</span>
</span><span id="Graphing-94"><a href="#Graphing-94"><span class="linenos">  94</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="Graphing-95"><a href="#Graphing-95"><span class="linenos">  95</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="Graphing-96"><a href="#Graphing-96"><span class="linenos">  96</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;o&#39; (circle).</span>
</span><span id="Graphing-97"><a href="#Graphing-97"><span class="linenos">  97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-98"><a href="#Graphing-98"><span class="linenos">  98</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing-99"><a href="#Graphing-99"><span class="linenos">  99</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="Graphing-100"><a href="#Graphing-100"><span class="linenos"> 100</span></a>
</span><span id="Graphing-101"><a href="#Graphing-101"><span class="linenos"> 101</span></a>    <span class="k">def</span> <span class="nf">plot_offices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
</span><span id="Graphing-102"><a href="#Graphing-102"><span class="linenos"> 102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-103"><a href="#Graphing-103"><span class="linenos"> 103</span></a><span class="sd">        Plots office location points on the map.</span>
</span><span id="Graphing-104"><a href="#Graphing-104"><span class="linenos"> 104</span></a>
</span><span id="Graphing-105"><a href="#Graphing-105"><span class="linenos"> 105</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-106"><a href="#Graphing-106"><span class="linenos"> 106</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="Graphing-107"><a href="#Graphing-107"><span class="linenos"> 107</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="Graphing-108"><a href="#Graphing-108"><span class="linenos"> 108</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-109"><a href="#Graphing-109"><span class="linenos"> 109</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="Graphing-110"><a href="#Graphing-110"><span class="linenos"> 110</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 100.</span>
</span><span id="Graphing-111"><a href="#Graphing-111"><span class="linenos"> 111</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="Graphing-112"><a href="#Graphing-112"><span class="linenos"> 112</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="Graphing-113"><a href="#Graphing-113"><span class="linenos"> 113</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;*&#39; (star).</span>
</span><span id="Graphing-114"><a href="#Graphing-114"><span class="linenos"> 114</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-115"><a href="#Graphing-115"><span class="linenos"> 115</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing-116"><a href="#Graphing-116"><span class="linenos"> 116</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="Graphing-117"><a href="#Graphing-117"><span class="linenos"> 117</span></a>        
</span><span id="Graphing-118"><a href="#Graphing-118"><span class="linenos"> 118</span></a>    <span class="k">def</span> <span class="nf">add_scalebar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing-119"><a href="#Graphing-119"><span class="linenos"> 119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-120"><a href="#Graphing-120"><span class="linenos"> 120</span></a><span class="sd">        Adds a scale bar to the map plot.</span>
</span><span id="Graphing-121"><a href="#Graphing-121"><span class="linenos"> 121</span></a>
</span><span id="Graphing-122"><a href="#Graphing-122"><span class="linenos"> 122</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-123"><a href="#Graphing-123"><span class="linenos"> 123</span></a><span class="sd">            ax: The matplotlib axes object to add the scale bar to.</span>
</span><span id="Graphing-124"><a href="#Graphing-124"><span class="linenos"> 124</span></a><span class="sd">            location (tuple, optional): A tuple (x, y) representing the location of the scale bar as a fraction of the axis dimensions. </span>
</span><span id="Graphing-125"><a href="#Graphing-125"><span class="linenos"> 125</span></a><span class="sd">            Defaults to (0.05, 0.05).</span>
</span><span id="Graphing-126"><a href="#Graphing-126"><span class="linenos"> 126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-127"><a href="#Graphing-127"><span class="linenos"> 127</span></a>
</span><span id="Graphing-128"><a href="#Graphing-128"><span class="linenos"> 128</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing-129"><a href="#Graphing-129"><span class="linenos"> 129</span></a>        <span class="c1"># first get the extent of the map</span>
</span><span id="Graphing-130"><a href="#Graphing-130"><span class="linenos"> 130</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing-131"><a href="#Graphing-131"><span class="linenos"> 131</span></a>        
</span><span id="Graphing-132"><a href="#Graphing-132"><span class="linenos"> 132</span></a>        <span class="c1"># calculate the width of the x axis in miles</span>
</span><span id="Graphing-133"><a href="#Graphing-133"><span class="linenos"> 133</span></a>        <span class="n">xd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
</span><span id="Graphing-134"><a href="#Graphing-134"><span class="linenos"> 134</span></a>        <span class="n">yd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="Graphing-135"><a href="#Graphing-135"><span class="linenos"> 135</span></a>        
</span><span id="Graphing-136"><a href="#Graphing-136"><span class="linenos"> 136</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="n">xd</span><span class="p">)</span>
</span><span id="Graphing-137"><a href="#Graphing-137"><span class="linenos"> 137</span></a>        <span class="n">bar</span> <span class="o">=</span> <span class="n">order</span><span class="o">/</span><span class="mf">4.0</span>
</span><span id="Graphing-138"><a href="#Graphing-138"><span class="linenos"> 138</span></a>        
</span><span id="Graphing-139"><a href="#Graphing-139"><span class="linenos"> 139</span></a>        <span class="n">np</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span id="Graphing-140"><a href="#Graphing-140"><span class="linenos"> 140</span></a>        <span class="c1"># now we create a tuple of long/lats for the scalebar</span>
</span><span id="Graphing-141"><a href="#Graphing-141"><span class="linenos"> 141</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">])</span>
</span><span id="Graphing-142"><a href="#Graphing-142"><span class="linenos"> 142</span></a>        <span class="c1"># now, adjust the coordinates of the scalebar for proper chart placement, up location[0]% and right location[1]%</span>
</span><span id="Graphing-143"><a href="#Graphing-143"><span class="linenos"> 143</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="Graphing-144"><a href="#Graphing-144"><span class="linenos"> 144</span></a>        <span class="c1"># now we create end bars for the scale bar using scalebar as the source coordinates.</span>
</span><span id="Graphing-145"><a href="#Graphing-145"><span class="linenos"> 145</span></a>        <span class="c1"># end bars are positioned one at each end of the scalebar, centered vertically on the scalebar, and total height being 2% of y axis</span>
</span><span id="Graphing-146"><a href="#Graphing-146"><span class="linenos"> 146</span></a>        <span class="n">scalebar_end</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="Graphing-147"><a href="#Graphing-147"><span class="linenos"> 147</span></a>        <span class="n">scalebar_end2</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="Graphing-148"><a href="#Graphing-148"><span class="linenos"> 148</span></a>        <span class="c1"># now we put a text label on the scale bar indicating the number of miles shown (bar).  Center the lable on the scalebar</span>
</span><span id="Graphing-149"><a href="#Graphing-149"><span class="linenos"> 149</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles&#39;</span><span class="p">,</span> 
</span><span id="Graphing-150"><a href="#Graphing-150"><span class="linenos"> 150</span></a>                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-151"><a href="#Graphing-151"><span class="linenos"> 151</span></a>
</span><span id="Graphing-152"><a href="#Graphing-152"><span class="linenos"> 152</span></a>        <span class="c1"># draw a scale bar</span>
</span><span id="Graphing-153"><a href="#Graphing-153"><span class="linenos"> 153</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Graphing-154"><a href="#Graphing-154"><span class="linenos"> 154</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Graphing-155"><a href="#Graphing-155"><span class="linenos"> 155</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Graphing-156"><a href="#Graphing-156"><span class="linenos"> 156</span></a>
</span><span id="Graphing-157"><a href="#Graphing-157"><span class="linenos"> 157</span></a>    <span class="k">def</span> <span class="nf">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
</span><span id="Graphing-158"><a href="#Graphing-158"><span class="linenos"> 158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-159"><a href="#Graphing-159"><span class="linenos"> 159</span></a><span class="sd">        Rounds a number to the nearest order of magnitude.</span>
</span><span id="Graphing-160"><a href="#Graphing-160"><span class="linenos"> 160</span></a>
</span><span id="Graphing-161"><a href="#Graphing-161"><span class="linenos"> 161</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-162"><a href="#Graphing-162"><span class="linenos"> 162</span></a><span class="sd">            number (float): The number to round.</span>
</span><span id="Graphing-163"><a href="#Graphing-163"><span class="linenos"> 163</span></a>
</span><span id="Graphing-164"><a href="#Graphing-164"><span class="linenos"> 164</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-165"><a href="#Graphing-165"><span class="linenos"> 165</span></a><span class="sd">            float: The rounded number.</span>
</span><span id="Graphing-166"><a href="#Graphing-166"><span class="linenos"> 166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-167"><a href="#Graphing-167"><span class="linenos"> 167</span></a>
</span><span id="Graphing-168"><a href="#Graphing-168"><span class="linenos"> 168</span></a>        <span class="c1"># Calculate the order of magnitude of the number</span>
</span><span id="Graphing-169"><a href="#Graphing-169"><span class="linenos"> 169</span></a>        <span class="n">order_of_magnitude</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)))</span>
</span><span id="Graphing-170"><a href="#Graphing-170"><span class="linenos"> 170</span></a>        <span class="c1"># Normalize the number to a value between 1 and 10 and round it</span>
</span><span id="Graphing-171"><a href="#Graphing-171"><span class="linenos"> 171</span></a>        <span class="n">rounded_normalized_number</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span> <span class="o">/</span> <span class="n">order_of_magnitude</span><span class="p">)</span>
</span><span id="Graphing-172"><a href="#Graphing-172"><span class="linenos"> 172</span></a>        <span class="c1"># Multiply back by the order of magnitude to get the rounded number</span>
</span><span id="Graphing-173"><a href="#Graphing-173"><span class="linenos"> 173</span></a>        <span class="k">return</span> <span class="n">rounded_normalized_number</span> <span class="o">*</span> <span class="n">order_of_magnitude</span>
</span><span id="Graphing-174"><a href="#Graphing-174"><span class="linenos"> 174</span></a>        
</span><span id="Graphing-175"><a href="#Graphing-175"><span class="linenos"> 175</span></a>    <span class="k">def</span> <span class="nf">calculate_zoom_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">tile_service_resolution</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
</span><span id="Graphing-176"><a href="#Graphing-176"><span class="linenos"> 176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-177"><a href="#Graphing-177"><span class="linenos"> 177</span></a><span class="sd">        Calculate an appropriate zoom level for a Cartopy axis based on its extent.</span>
</span><span id="Graphing-178"><a href="#Graphing-178"><span class="linenos"> 178</span></a><span class="sd">        </span>
</span><span id="Graphing-179"><a href="#Graphing-179"><span class="linenos"> 179</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-180"><a href="#Graphing-180"><span class="linenos"> 180</span></a><span class="sd">        - ax: The Cartopy GeoAxes object.</span>
</span><span id="Graphing-181"><a href="#Graphing-181"><span class="linenos"> 181</span></a><span class="sd">        - tile_service_resolution: The resolution of the tile service (256 for most web services).</span>
</span><span id="Graphing-182"><a href="#Graphing-182"><span class="linenos"> 182</span></a><span class="sd">        </span>
</span><span id="Graphing-183"><a href="#Graphing-183"><span class="linenos"> 183</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-184"><a href="#Graphing-184"><span class="linenos"> 184</span></a><span class="sd">        - An integer zoom level.</span>
</span><span id="Graphing-185"><a href="#Graphing-185"><span class="linenos"> 185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-186"><a href="#Graphing-186"><span class="linenos"> 186</span></a>        <span class="c1"># Get the extent of the axis and calculate the width in degrees</span>
</span><span id="Graphing-187"><a href="#Graphing-187"><span class="linenos"> 187</span></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing-188"><a href="#Graphing-188"><span class="linenos"> 188</span></a>        <span class="n">width_deg</span> <span class="o">=</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing-189"><a href="#Graphing-189"><span class="linenos"> 189</span></a>        
</span><span id="Graphing-190"><a href="#Graphing-190"><span class="linenos"> 190</span></a>        <span class="c1"># Estimate the width of the plot in pixels</span>
</span><span id="Graphing-191"><a href="#Graphing-191"><span class="linenos"> 191</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Graphing-192"><a href="#Graphing-192"><span class="linenos"> 192</span></a>        <span class="n">width_in_pixels</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing-193"><a href="#Graphing-193"><span class="linenos"> 193</span></a>        
</span><span id="Graphing-194"><a href="#Graphing-194"><span class="linenos"> 194</span></a>        <span class="c1"># Calculate the zoom level</span>
</span><span id="Graphing-195"><a href="#Graphing-195"><span class="linenos"> 195</span></a>        <span class="c1"># This formula is an approximation and might need adjustment for your specific needs</span>
</span><span id="Graphing-196"><a href="#Graphing-196"><span class="linenos"> 196</span></a>        <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">((</span><span class="mi">360</span> <span class="o">*</span> <span class="n">width_in_pixels</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">width_deg</span> <span class="o">*</span> <span class="n">tile_service_resolution</span><span class="p">))</span>
</span><span id="Graphing-197"><a href="#Graphing-197"><span class="linenos"> 197</span></a>        
</span><span id="Graphing-198"><a href="#Graphing-198"><span class="linenos"> 198</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zoom_level</span><span class="p">),</span> <span class="mi">19</span><span class="p">))</span>  <span class="c1"># Ensure zoom level is within a valid range</span>
</span><span id="Graphing-199"><a href="#Graphing-199"><span class="linenos"> 199</span></a>    
</span><span id="Graphing-200"><a href="#Graphing-200"><span class="linenos"> 200</span></a>    <span class="k">def</span> <span class="nf">filter_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-201"><a href="#Graphing-201"><span class="linenos"> 201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-202"><a href="#Graphing-202"><span class="linenos"> 202</span></a><span class="sd">        Filters source points based on their linear distance from target points within a specified radius.</span>
</span><span id="Graphing-203"><a href="#Graphing-203"><span class="linenos"> 203</span></a>
</span><span id="Graphing-204"><a href="#Graphing-204"><span class="linenos"> 204</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-205"><a href="#Graphing-205"><span class="linenos"> 205</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-206"><a href="#Graphing-206"><span class="linenos"> 206</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-207"><a href="#Graphing-207"><span class="linenos"> 207</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="Graphing-208"><a href="#Graphing-208"><span class="linenos"> 208</span></a><span class="sd">            inside (bool, optional): If True, filters for source points inside the radius. If False, filters for source points </span>
</span><span id="Graphing-209"><a href="#Graphing-209"><span class="linenos"> 209</span></a><span class="sd">            outside the radius. Defaults to True.</span>
</span><span id="Graphing-210"><a href="#Graphing-210"><span class="linenos"> 210</span></a>
</span><span id="Graphing-211"><a href="#Graphing-211"><span class="linenos"> 211</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-212"><a href="#Graphing-212"><span class="linenos"> 212</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the radius criteria.</span>
</span><span id="Graphing-213"><a href="#Graphing-213"><span class="linenos"> 213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-214"><a href="#Graphing-214"><span class="linenos"> 214</span></a>
</span><span id="Graphing-215"><a href="#Graphing-215"><span class="linenos"> 215</span></a>        <span class="c1"># check if the lat/long pair is within radius of any of the targets.</span>
</span><span id="Graphing-216"><a href="#Graphing-216"><span class="linenos"> 216</span></a>        <span class="c1"># offices is a pandas dataframe with columns latitude and longitude, and each row represents a cetnered target location</span>
</span><span id="Graphing-217"><a href="#Graphing-217"><span class="linenos"> 217</span></a>        <span class="c1"># return true if the lat/long pair is within radius of any of the offices, otherwise return false (vice versa for outside)</span>
</span><span id="Graphing-218"><a href="#Graphing-218"><span class="linenos"> 218</span></a>        <span class="k">def</span> <span class="nf">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-219"><a href="#Graphing-219"><span class="linenos"> 219</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-220"><a href="#Graphing-220"><span class="linenos"> 220</span></a>                <span class="k">if</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="Graphing-221"><a href="#Graphing-221"><span class="linenos"> 221</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing-222"><a href="#Graphing-222"><span class="linenos"> 222</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-223"><a href="#Graphing-223"><span class="linenos"> 223</span></a>                <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="Graphing-224"><a href="#Graphing-224"><span class="linenos"> 224</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing-225"><a href="#Graphing-225"><span class="linenos"> 225</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-226"><a href="#Graphing-226"><span class="linenos"> 226</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing-227"><a href="#Graphing-227"><span class="linenos"> 227</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> 
</span><span id="Graphing-228"><a href="#Graphing-228"><span class="linenos"> 228</span></a>                                <span class="k">if</span> <span class="n">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="Graphing-229"><a href="#Graphing-229"><span class="linenos"> 229</span></a>
</span><span id="Graphing-230"><a href="#Graphing-230"><span class="linenos"> 230</span></a>
</span><span id="Graphing-231"><a href="#Graphing-231"><span class="linenos"> 231</span></a>    <span class="k">def</span> <span class="nf">filter_drive_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-232"><a href="#Graphing-232"><span class="linenos"> 232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-233"><a href="#Graphing-233"><span class="linenos"> 233</span></a><span class="sd">        Filters source points based on the driving distance to target points using commute data.</span>
</span><span id="Graphing-234"><a href="#Graphing-234"><span class="linenos"> 234</span></a>
</span><span id="Graphing-235"><a href="#Graphing-235"><span class="linenos"> 235</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-236"><a href="#Graphing-236"><span class="linenos"> 236</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-237"><a href="#Graphing-237"><span class="linenos"> 237</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-238"><a href="#Graphing-238"><span class="linenos"> 238</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="Graphing-239"><a href="#Graphing-239"><span class="linenos"> 239</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="Graphing-240"><a href="#Graphing-240"><span class="linenos"> 240</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the driving distance radius. If False, </span>
</span><span id="Graphing-241"><a href="#Graphing-241"><span class="linenos"> 241</span></a><span class="sd">            filters for source points outside the radius. Defaults to True.</span>
</span><span id="Graphing-242"><a href="#Graphing-242"><span class="linenos"> 242</span></a>
</span><span id="Graphing-243"><a href="#Graphing-243"><span class="linenos"> 243</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-244"><a href="#Graphing-244"><span class="linenos"> 244</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving distance criteria.</span>
</span><span id="Graphing-245"><a href="#Graphing-245"><span class="linenos"> 245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-246"><a href="#Graphing-246"><span class="linenos"> 246</span></a>
</span><span id="Graphing-247"><a href="#Graphing-247"><span class="linenos"> 247</span></a>        <span class="c1"># employee address maps to source, office address maps to destination</span>
</span><span id="Graphing-248"><a href="#Graphing-248"><span class="linenos"> 248</span></a>        <span class="c1"># for each office, check if the lat/long pair is within radius of any of the offices based upon actual driving distance</span>
</span><span id="Graphing-249"><a href="#Graphing-249"><span class="linenos"> 249</span></a>        <span class="k">def</span> <span class="nf">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-250"><a href="#Graphing-250"><span class="linenos"> 250</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-251"><a href="#Graphing-251"><span class="linenos"> 251</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="Graphing-252"><a href="#Graphing-252"><span class="linenos"> 252</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="Graphing-253"><a href="#Graphing-253"><span class="linenos"> 253</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing-254"><a href="#Graphing-254"><span class="linenos"> 254</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lon</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing-255"><a href="#Graphing-255"><span class="linenos"> 255</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="Graphing-256"><a href="#Graphing-256"><span class="linenos"> 256</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing-257"><a href="#Graphing-257"><span class="linenos"> 257</span></a>                                <span class="p">]</span>
</span><span id="Graphing-258"><a href="#Graphing-258"><span class="linenos"> 258</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-259"><a href="#Graphing-259"><span class="linenos"> 259</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing-260"><a href="#Graphing-260"><span class="linenos"> 260</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-261"><a href="#Graphing-261"><span class="linenos"> 261</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing-262"><a href="#Graphing-262"><span class="linenos"> 262</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-263"><a href="#Graphing-263"><span class="linenos"> 263</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing-264"><a href="#Graphing-264"><span class="linenos"> 264</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing-265"><a href="#Graphing-265"><span class="linenos"> 265</span></a>                                <span class="k">if</span> <span class="n">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="Graphing-266"><a href="#Graphing-266"><span class="linenos"> 266</span></a>    
</span><span id="Graphing-267"><a href="#Graphing-267"><span class="linenos"> 267</span></a>    <span class="k">def</span> <span class="nf">filter_drive_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-268"><a href="#Graphing-268"><span class="linenos"> 268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-269"><a href="#Graphing-269"><span class="linenos"> 269</span></a><span class="sd">        Filters source points based on the driving time to target points using commute data.</span>
</span><span id="Graphing-270"><a href="#Graphing-270"><span class="linenos"> 270</span></a>
</span><span id="Graphing-271"><a href="#Graphing-271"><span class="linenos"> 271</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-272"><a href="#Graphing-272"><span class="linenos"> 272</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-273"><a href="#Graphing-273"><span class="linenos"> 273</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-274"><a href="#Graphing-274"><span class="linenos"> 274</span></a><span class="sd">            minutes (float): The maximum driving time in minutes within which to filter source points.</span>
</span><span id="Graphing-275"><a href="#Graphing-275"><span class="linenos"> 275</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="Graphing-276"><a href="#Graphing-276"><span class="linenos"> 276</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the specified driving time. If False, filters for source points outside the driving time. Defaults to True.</span>
</span><span id="Graphing-277"><a href="#Graphing-277"><span class="linenos"> 277</span></a>
</span><span id="Graphing-278"><a href="#Graphing-278"><span class="linenos"> 278</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-279"><a href="#Graphing-279"><span class="linenos"> 279</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving time criteria.</span>
</span><span id="Graphing-280"><a href="#Graphing-280"><span class="linenos"> 280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-281"><a href="#Graphing-281"><span class="linenos"> 281</span></a>
</span><span id="Graphing-282"><a href="#Graphing-282"><span class="linenos"> 282</span></a>        <span class="k">def</span> <span class="nf">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing-283"><a href="#Graphing-283"><span class="linenos"> 283</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-284"><a href="#Graphing-284"><span class="linenos"> 284</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="Graphing-285"><a href="#Graphing-285"><span class="linenos"> 285</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="Graphing-286"><a href="#Graphing-286"><span class="linenos"> 286</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing-287"><a href="#Graphing-287"><span class="linenos"> 287</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">long</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing-288"><a href="#Graphing-288"><span class="linenos"> 288</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="Graphing-289"><a href="#Graphing-289"><span class="linenos"> 289</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing-290"><a href="#Graphing-290"><span class="linenos"> 290</span></a>                                <span class="p">]</span>
</span><span id="Graphing-291"><a href="#Graphing-291"><span class="linenos"> 291</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-292"><a href="#Graphing-292"><span class="linenos"> 292</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="Graphing-293"><a href="#Graphing-293"><span class="linenos"> 293</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-294"><a href="#Graphing-294"><span class="linenos"> 294</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="Graphing-295"><a href="#Graphing-295"><span class="linenos"> 295</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing-296"><a href="#Graphing-296"><span class="linenos"> 296</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing-297"><a href="#Graphing-297"><span class="linenos"> 297</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">long</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing-298"><a href="#Graphing-298"><span class="linenos"> 298</span></a>                                <span class="k">if</span> <span class="n">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span><span id="Graphing-299"><a href="#Graphing-299"><span class="linenos"> 299</span></a>                            
</span><span id="Graphing-300"><a href="#Graphing-300"><span class="linenos"> 300</span></a>    <span class="k">def</span> <span class="nf">get_common_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="Graphing-301"><a href="#Graphing-301"><span class="linenos"> 301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-302"><a href="#Graphing-302"><span class="linenos"> 302</span></a><span class="sd">        Finds common points between two sets of latitudes and longitudes.</span>
</span><span id="Graphing-303"><a href="#Graphing-303"><span class="linenos"> 303</span></a>
</span><span id="Graphing-304"><a href="#Graphing-304"><span class="linenos"> 304</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-305"><a href="#Graphing-305"><span class="linenos"> 305</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-306"><a href="#Graphing-306"><span class="linenos"> 306</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-307"><a href="#Graphing-307"><span class="linenos"> 307</span></a>
</span><span id="Graphing-308"><a href="#Graphing-308"><span class="linenos"> 308</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-309"><a href="#Graphing-309"><span class="linenos"> 309</span></a><span class="sd">            DataFrame: A DataFrame of common points between the two sets.</span>
</span><span id="Graphing-310"><a href="#Graphing-310"><span class="linenos"> 310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-311"><a href="#Graphing-311"><span class="linenos"> 311</span></a>        <span class="c1"># find the common points between the two sets</span>
</span><span id="Graphing-312"><a href="#Graphing-312"><span class="linenos"> 312</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">set2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing-313"><a href="#Graphing-313"><span class="linenos"> 313</span></a>
</span><span id="Graphing-314"><a href="#Graphing-314"><span class="linenos"> 314</span></a>    <span class="k">def</span> <span class="nf">get_unique_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="Graphing-315"><a href="#Graphing-315"><span class="linenos"> 315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-316"><a href="#Graphing-316"><span class="linenos"> 316</span></a><span class="sd">        Finds unique points in the first set that are not present in the second set.</span>
</span><span id="Graphing-317"><a href="#Graphing-317"><span class="linenos"> 317</span></a>
</span><span id="Graphing-318"><a href="#Graphing-318"><span class="linenos"> 318</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-319"><a href="#Graphing-319"><span class="linenos"> 319</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-320"><a href="#Graphing-320"><span class="linenos"> 320</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-321"><a href="#Graphing-321"><span class="linenos"> 321</span></a>
</span><span id="Graphing-322"><a href="#Graphing-322"><span class="linenos"> 322</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-323"><a href="#Graphing-323"><span class="linenos"> 323</span></a><span class="sd">            DataFrame: A DataFrame of unique points in the first set.</span>
</span><span id="Graphing-324"><a href="#Graphing-324"><span class="linenos"> 324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-325"><a href="#Graphing-325"><span class="linenos"> 325</span></a>
</span><span id="Graphing-326"><a href="#Graphing-326"><span class="linenos"> 326</span></a>        <span class="c1"># find the unique points in the first set</span>
</span><span id="Graphing-327"><a href="#Graphing-327"><span class="linenos"> 327</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="p">[</span><span class="o">~</span><span class="n">set1</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">set2</span><span class="p">)]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span id="Graphing-328"><a href="#Graphing-328"><span class="linenos"> 328</span></a>    
</span><span id="Graphing-329"><a href="#Graphing-329"><span class="linenos"> 329</span></a>    <span class="k">def</span> <span class="nf">haversine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">):</span>
</span><span id="Graphing-330"><a href="#Graphing-330"><span class="linenos"> 330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-331"><a href="#Graphing-331"><span class="linenos"> 331</span></a><span class="sd">        Calculates the great-circle distance between two points on the Earth specified in decimal degrees using the Haversine formula.</span>
</span><span id="Graphing-332"><a href="#Graphing-332"><span class="linenos"> 332</span></a>
</span><span id="Graphing-333"><a href="#Graphing-333"><span class="linenos"> 333</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-334"><a href="#Graphing-334"><span class="linenos"> 334</span></a><span class="sd">            lat1 (float): Latitude of the first point.</span>
</span><span id="Graphing-335"><a href="#Graphing-335"><span class="linenos"> 335</span></a><span class="sd">            lon1 (float): Longitude of the first point.</span>
</span><span id="Graphing-336"><a href="#Graphing-336"><span class="linenos"> 336</span></a><span class="sd">            lat2 (float): Latitude of the second point.</span>
</span><span id="Graphing-337"><a href="#Graphing-337"><span class="linenos"> 337</span></a><span class="sd">            lon2 (float): Longitude of the second point.</span>
</span><span id="Graphing-338"><a href="#Graphing-338"><span class="linenos"> 338</span></a>
</span><span id="Graphing-339"><a href="#Graphing-339"><span class="linenos"> 339</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-340"><a href="#Graphing-340"><span class="linenos"> 340</span></a><span class="sd">            float: The distance between the two points in miles.</span>
</span><span id="Graphing-341"><a href="#Graphing-341"><span class="linenos"> 341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-342"><a href="#Graphing-342"><span class="linenos"> 342</span></a>
</span><span id="Graphing-343"><a href="#Graphing-343"><span class="linenos"> 343</span></a>        <span class="c1">#To calculate the distance between two latitude/longitude coordinates while taking the curvature of the Earth into account, </span>
</span><span id="Graphing-344"><a href="#Graphing-344"><span class="linenos"> 344</span></a>        <span class="c1">#you use the Haversine formula. This formula gives you the great-circle distance between two points on the surface of a sphere, </span>
</span><span id="Graphing-345"><a href="#Graphing-345"><span class="linenos"> 345</span></a>        <span class="c1">#given their longitudes and latitudes. This is particularly useful for calculating the approximate distance between two points </span>
</span><span id="Graphing-346"><a href="#Graphing-346"><span class="linenos"> 346</span></a>        <span class="c1">#on the Earth.&quot;</span>
</span><span id="Graphing-347"><a href="#Graphing-347"><span class="linenos"> 347</span></a>
</span><span id="Graphing-348"><a href="#Graphing-348"><span class="linenos"> 348</span></a>        <span class="c1"># Radius of the Earth in miles</span>
</span><span id="Graphing-349"><a href="#Graphing-349"><span class="linenos"> 349</span></a>        <span class="n">R</span> <span class="o">=</span> <span class="mf">3958.8</span>
</span><span id="Graphing-350"><a href="#Graphing-350"><span class="linenos"> 350</span></a>        <span class="c1"># Radius of the Earth in kilometers (uncomment to use kilometers)</span>
</span><span id="Graphing-351"><a href="#Graphing-351"><span class="linenos"> 351</span></a>        <span class="c1">#R = 6371.0</span>
</span><span id="Graphing-352"><a href="#Graphing-352"><span class="linenos"> 352</span></a>
</span><span id="Graphing-353"><a href="#Graphing-353"><span class="linenos"> 353</span></a>        <span class="c1"># Convert latitude and longitude from degrees to radians</span>
</span><span id="Graphing-354"><a href="#Graphing-354"><span class="linenos"> 354</span></a>        <span class="n">lat1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Graphing-355"><a href="#Graphing-355"><span class="linenos"> 355</span></a>        <span class="n">lon1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="Graphing-356"><a href="#Graphing-356"><span class="linenos"> 356</span></a>        <span class="n">lat2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="Graphing-357"><a href="#Graphing-357"><span class="linenos"> 357</span></a>        <span class="n">lon2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="Graphing-358"><a href="#Graphing-358"><span class="linenos"> 358</span></a>
</span><span id="Graphing-359"><a href="#Graphing-359"><span class="linenos"> 359</span></a>        <span class="c1"># Difference in coordinates</span>
</span><span id="Graphing-360"><a href="#Graphing-360"><span class="linenos"> 360</span></a>        <span class="n">dlat</span> <span class="o">=</span> <span class="n">lat2_rad</span> <span class="o">-</span> <span class="n">lat1_rad</span>
</span><span id="Graphing-361"><a href="#Graphing-361"><span class="linenos"> 361</span></a>        <span class="n">dlon</span> <span class="o">=</span> <span class="n">lon2_rad</span> <span class="o">-</span> <span class="n">lon1_rad</span>
</span><span id="Graphing-362"><a href="#Graphing-362"><span class="linenos"> 362</span></a>
</span><span id="Graphing-363"><a href="#Graphing-363"><span class="linenos"> 363</span></a>        <span class="c1"># Haversine formula</span>
</span><span id="Graphing-364"><a href="#Graphing-364"><span class="linenos"> 364</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Graphing-365"><a href="#Graphing-365"><span class="linenos"> 365</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>
</span><span id="Graphing-366"><a href="#Graphing-366"><span class="linenos"> 366</span></a>
</span><span id="Graphing-367"><a href="#Graphing-367"><span class="linenos"> 367</span></a>        <span class="c1"># Total distance in (units selected above)</span>
</span><span id="Graphing-368"><a href="#Graphing-368"><span class="linenos"> 368</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">c</span>
</span><span id="Graphing-369"><a href="#Graphing-369"><span class="linenos"> 369</span></a>
</span><span id="Graphing-370"><a href="#Graphing-370"><span class="linenos"> 370</span></a>        <span class="k">return</span> <span class="n">distance</span>
</span><span id="Graphing-371"><a href="#Graphing-371"><span class="linenos"> 371</span></a>    
</span><span id="Graphing-372"><a href="#Graphing-372"><span class="linenos"> 372</span></a>    <span class="c1"># calcuate a new point given a distance and bearing from a starting point using haversine</span>
</span><span id="Graphing-373"><a href="#Graphing-373"><span class="linenos"> 373</span></a>    <span class="k">def</span> <span class="nf">haversine_newpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">bearing</span><span class="p">):</span>
</span><span id="Graphing-374"><a href="#Graphing-374"><span class="linenos"> 374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-375"><a href="#Graphing-375"><span class="linenos"> 375</span></a><span class="sd">        Calculates a new point given a distance and bearing from a starting point using the Haversine formula.</span>
</span><span id="Graphing-376"><a href="#Graphing-376"><span class="linenos"> 376</span></a>
</span><span id="Graphing-377"><a href="#Graphing-377"><span class="linenos"> 377</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-378"><a href="#Graphing-378"><span class="linenos"> 378</span></a><span class="sd">            lat1 (float): Latitude of the starting point.</span>
</span><span id="Graphing-379"><a href="#Graphing-379"><span class="linenos"> 379</span></a><span class="sd">            lon1 (float): Longitude of the starting point.</span>
</span><span id="Graphing-380"><a href="#Graphing-380"><span class="linenos"> 380</span></a><span class="sd">            distance (float): Distance from the starting point in miles.</span>
</span><span id="Graphing-381"><a href="#Graphing-381"><span class="linenos"> 381</span></a><span class="sd">            bearing (float): Bearing in degrees from the starting point to the new point.</span>
</span><span id="Graphing-382"><a href="#Graphing-382"><span class="linenos"> 382</span></a>
</span><span id="Graphing-383"><a href="#Graphing-383"><span class="linenos"> 383</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-384"><a href="#Graphing-384"><span class="linenos"> 384</span></a><span class="sd">            tuple: A tuple (lat2, lon2) representing the latitude and longitude of the new point.</span>
</span><span id="Graphing-385"><a href="#Graphing-385"><span class="linenos"> 385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-386"><a href="#Graphing-386"><span class="linenos"> 386</span></a>
</span><span id="Graphing-387"><a href="#Graphing-387"><span class="linenos"> 387</span></a>        <span class="c1"># convert distance to radians</span>
</span><span id="Graphing-388"><a href="#Graphing-388"><span class="linenos"> 388</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">/</span> <span class="mf">3958.8</span>
</span><span id="Graphing-389"><a href="#Graphing-389"><span class="linenos"> 389</span></a>        <span class="c1"># convert bearing to radians</span>
</span><span id="Graphing-390"><a href="#Graphing-390"><span class="linenos"> 390</span></a>        <span class="n">bearing</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
</span><span id="Graphing-391"><a href="#Graphing-391"><span class="linenos"> 391</span></a>        <span class="c1"># convert latitude to radians</span>
</span><span id="Graphing-392"><a href="#Graphing-392"><span class="linenos"> 392</span></a>        <span class="n">lat1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Graphing-393"><a href="#Graphing-393"><span class="linenos"> 393</span></a>        <span class="c1"># convert longitude to radians</span>
</span><span id="Graphing-394"><a href="#Graphing-394"><span class="linenos"> 394</span></a>        <span class="n">lon1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="Graphing-395"><a href="#Graphing-395"><span class="linenos"> 395</span></a>        <span class="c1"># calculate the new latitude</span>
</span><span id="Graphing-396"><a href="#Graphing-396"><span class="linenos"> 396</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bearing</span><span class="p">))</span>
</span><span id="Graphing-397"><a href="#Graphing-397"><span class="linenos"> 397</span></a>        <span class="c1"># calculate the new longitude</span>
</span><span id="Graphing-398"><a href="#Graphing-398"><span class="linenos"> 398</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">))</span>
</span><span id="Graphing-399"><a href="#Graphing-399"><span class="linenos"> 399</span></a>        <span class="c1"># convert latitude back to degrees</span>
</span><span id="Graphing-400"><a href="#Graphing-400"><span class="linenos"> 400</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="Graphing-401"><a href="#Graphing-401"><span class="linenos"> 401</span></a>        <span class="c1"># convert longitude back to degrees</span>
</span><span id="Graphing-402"><a href="#Graphing-402"><span class="linenos"> 402</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="Graphing-403"><a href="#Graphing-403"><span class="linenos"> 403</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>
</span><span id="Graphing-404"><a href="#Graphing-404"><span class="linenos"> 404</span></a>
</span><span id="Graphing-405"><a href="#Graphing-405"><span class="linenos"> 405</span></a>    <span class="k">def</span> <span class="nf">plot_ellipses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">):</span>
</span><span id="Graphing-406"><a href="#Graphing-406"><span class="linenos"> 406</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-407"><a href="#Graphing-407"><span class="linenos"> 407</span></a><span class="sd">        Draws ellipses around office locations to represent the commute radius from each office.</span>
</span><span id="Graphing-408"><a href="#Graphing-408"><span class="linenos"> 408</span></a>
</span><span id="Graphing-409"><a href="#Graphing-409"><span class="linenos"> 409</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-410"><a href="#Graphing-410"><span class="linenos"> 410</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing-411"><a href="#Graphing-411"><span class="linenos"> 411</span></a><span class="sd">            offices (DataFrame): A DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-412"><a href="#Graphing-412"><span class="linenos"> 412</span></a><span class="sd">            commute_radius (float): The radius to draw around each office location, in miles.</span>
</span><span id="Graphing-413"><a href="#Graphing-413"><span class="linenos"> 413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-414"><a href="#Graphing-414"><span class="linenos"> 414</span></a>
</span><span id="Graphing-415"><a href="#Graphing-415"><span class="linenos"> 415</span></a>        <span class="c1"># draw an ellipse around the office locations to represent the radius from each office (ellipse in thise OSM projection will be a circle)</span>
</span><span id="Graphing-416"><a href="#Graphing-416"><span class="linenos"> 416</span></a>        <span class="c1"># note: this will be a jagged representation due to cartopy handling, better to use our own eline function</span>
</span><span id="Graphing-417"><a href="#Graphing-417"><span class="linenos"> 417</span></a>        <span class="n">xcdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Graphing-418"><a href="#Graphing-418"><span class="linenos"> 418</span></a>        <span class="n">ycdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Graphing-419"><a href="#Graphing-419"><span class="linenos"> 419</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">offices</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-420"><a href="#Graphing-420"><span class="linenos"> 420</span></a>            <span class="c1"># if cdelta is None, calculate the circle radius using first set of lat long, and using haversine to calcuate a new point, then x0-x1</span>
</span><span id="Graphing-421"><a href="#Graphing-421"><span class="linenos"> 421</span></a>            <span class="k">if</span> <span class="n">ycdelta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-422"><a href="#Graphing-422"><span class="linenos"> 422</span></a>                <span class="c1"># calculate the circle radius using the first set of lat long</span>
</span><span id="Graphing-423"><a href="#Graphing-423"><span class="linenos"> 423</span></a>                <span class="n">ycdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Graphing-424"><a href="#Graphing-424"><span class="linenos"> 424</span></a>                <span class="n">xcdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">90</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing-425"><a href="#Graphing-425"><span class="linenos"> 425</span></a>
</span><span id="Graphing-426"><a href="#Graphing-426"><span class="linenos"> 426</span></a>            <span class="c1"># calculate the ellipse around the office location</span>
</span><span id="Graphing-427"><a href="#Graphing-427"><span class="linenos"> 427</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">xcdelta</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ycdelta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="p">)</span>
</span><span id="Graphing-428"><a href="#Graphing-428"><span class="linenos"> 428</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipse</span><span class="p">)</span>
</span><span id="Graphing-429"><a href="#Graphing-429"><span class="linenos"> 429</span></a>    
</span><span id="Graphing-430"><a href="#Graphing-430"><span class="linenos"> 430</span></a>    <span class="k">def</span> <span class="nf">plot_elines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="Graphing-431"><a href="#Graphing-431"><span class="linenos"> 431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-432"><a href="#Graphing-432"><span class="linenos"> 432</span></a><span class="sd">        Draws lines (elipses) around target points to represent a specified radius from each point on a map.</span>
</span><span id="Graphing-433"><a href="#Graphing-433"><span class="linenos"> 433</span></a>
</span><span id="Graphing-434"><a href="#Graphing-434"><span class="linenos"> 434</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-435"><a href="#Graphing-435"><span class="linenos"> 435</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing-436"><a href="#Graphing-436"><span class="linenos"> 436</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-437"><a href="#Graphing-437"><span class="linenos"> 437</span></a><span class="sd">            commute_radius (float): The radius around each target point to draw, in miles.</span>
</span><span id="Graphing-438"><a href="#Graphing-438"><span class="linenos"> 438</span></a><span class="sd">            color (str, optional): Color of the lines. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-439"><a href="#Graphing-439"><span class="linenos"> 439</span></a><span class="sd">            linestyle (str, optional): Style of the line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing-440"><a href="#Graphing-440"><span class="linenos"> 440</span></a><span class="sd">            linewidth (int, optional): Width of the lines. Defaults to 2.</span>
</span><span id="Graphing-441"><a href="#Graphing-441"><span class="linenos"> 441</span></a>
</span><span id="Graphing-442"><a href="#Graphing-442"><span class="linenos"> 442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-443"><a href="#Graphing-443"><span class="linenos"> 443</span></a>
</span><span id="Graphing-444"><a href="#Graphing-444"><span class="linenos"> 444</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing-445"><a href="#Graphing-445"><span class="linenos"> 445</span></a>            <span class="c1"># plot an eline</span>
</span><span id="Graphing-446"><a href="#Graphing-446"><span class="linenos"> 446</span></a>            <span class="n">elinex</span><span class="p">,</span><span class="n">eliney</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_eline</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing-447"><a href="#Graphing-447"><span class="linenos"> 447</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;New Line&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Graphing-448"><a href="#Graphing-448"><span class="linenos"> 448</span></a>
</span><span id="Graphing-449"><a href="#Graphing-449"><span class="linenos"> 449</span></a>    <span class="k">def</span> <span class="nf">create_eline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="Graphing-450"><a href="#Graphing-450"><span class="linenos"> 450</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-451"><a href="#Graphing-451"><span class="linenos"> 451</span></a><span class="sd">        Creates a set of latitude and longitude points that form a circle (or ellipse) around a central point.</span>
</span><span id="Graphing-452"><a href="#Graphing-452"><span class="linenos"> 452</span></a>
</span><span id="Graphing-453"><a href="#Graphing-453"><span class="linenos"> 453</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-454"><a href="#Graphing-454"><span class="linenos"> 454</span></a><span class="sd">            lat (float): Latitude of the central point.</span>
</span><span id="Graphing-455"><a href="#Graphing-455"><span class="linenos"> 455</span></a><span class="sd">            long (float): Longitude of the central point.</span>
</span><span id="Graphing-456"><a href="#Graphing-456"><span class="linenos"> 456</span></a><span class="sd">            r (float): Radius of the circle in miles.</span>
</span><span id="Graphing-457"><a href="#Graphing-457"><span class="linenos"> 457</span></a><span class="sd">            step (int, optional): Degrees between each point on the circle. Smaller values create a smoother circle. Defaults to 10.</span>
</span><span id="Graphing-458"><a href="#Graphing-458"><span class="linenos"> 458</span></a>
</span><span id="Graphing-459"><a href="#Graphing-459"><span class="linenos"> 459</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-460"><a href="#Graphing-460"><span class="linenos"> 460</span></a><span class="sd">            tuple: Two lists containing the longitude and latitude of points forming the circle.</span>
</span><span id="Graphing-461"><a href="#Graphing-461"><span class="linenos"> 461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-462"><a href="#Graphing-462"><span class="linenos"> 462</span></a>
</span><span id="Graphing-463"><a href="#Graphing-463"><span class="linenos"> 463</span></a>        <span class="c1"># start with the lat/long, and calculate a point r miles away at 0 degrees, then, repeat every step degrees until 360, inclusive</span>
</span><span id="Graphing-464"><a href="#Graphing-464"><span class="linenos"> 464</span></a>        <span class="n">elinex</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Graphing-465"><a href="#Graphing-465"><span class="linenos"> 465</span></a>        <span class="n">eliney</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Graphing-466"><a href="#Graphing-466"><span class="linenos"> 466</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="Graphing-467"><a href="#Graphing-467"><span class="linenos"> 467</span></a>            <span class="n">np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="Graphing-468"><a href="#Graphing-468"><span class="linenos"> 468</span></a>            <span class="n">elinex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing-469"><a href="#Graphing-469"><span class="linenos"> 469</span></a>            <span class="n">eliney</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Graphing-470"><a href="#Graphing-470"><span class="linenos"> 470</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">]</span>
</span><span id="Graphing-471"><a href="#Graphing-471"><span class="linenos"> 471</span></a>    
</span><span id="Graphing-472"><a href="#Graphing-472"><span class="linenos"> 472</span></a>    <span class="k">def</span> <span class="nf">plot_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing-473"><a href="#Graphing-473"><span class="linenos"> 473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-474"><a href="#Graphing-474"><span class="linenos"> 474</span></a><span class="sd">        Draws a convex hull around a set of points on the map, effectively creating a boundary that encloses all the points.</span>
</span><span id="Graphing-475"><a href="#Graphing-475"><span class="linenos"> 475</span></a>
</span><span id="Graphing-476"><a href="#Graphing-476"><span class="linenos"> 476</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-477"><a href="#Graphing-477"><span class="linenos"> 477</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing-478"><a href="#Graphing-478"><span class="linenos"> 478</span></a><span class="sd">            data (DataFrame): A DataFrame containing points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing-479"><a href="#Graphing-479"><span class="linenos"> 479</span></a><span class="sd">            color (str, optional): Color of the convex hull boundary. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing-480"><a href="#Graphing-480"><span class="linenos"> 480</span></a><span class="sd">            linestyle (str, optional): Style of the hull boundary line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing-481"><a href="#Graphing-481"><span class="linenos"> 481</span></a><span class="sd">            linewidth (int, optional): Width of the hull boundary line. Defaults to 2.</span>
</span><span id="Graphing-482"><a href="#Graphing-482"><span class="linenos"> 482</span></a><span class="sd">            linealpha (float, optional): Transparency of the hull boundary line. Defaults to 0.</span>
</span><span id="Graphing-483"><a href="#Graphing-483"><span class="linenos"> 483</span></a><span class="sd">            fillalpha (float, optional): Transparency of the hull fill. Defaults to 1.</span>
</span><span id="Graphing-484"><a href="#Graphing-484"><span class="linenos"> 484</span></a>
</span><span id="Graphing-485"><a href="#Graphing-485"><span class="linenos"> 485</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-486"><a href="#Graphing-486"><span class="linenos"> 486</span></a>
</span><span id="Graphing-487"><a href="#Graphing-487"><span class="linenos"> 487</span></a>        <span class="c1"># plot the convex hull of the employee addresses within the commute radius</span>
</span><span id="Graphing-488"><a href="#Graphing-488"><span class="linenos"> 488</span></a>        <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing-489"><a href="#Graphing-489"><span class="linenos"> 489</span></a>        <span class="k">for</span> <span class="n">simplex</span> <span class="ow">in</span> <span class="n">hull</span><span class="o">.</span><span class="n">simplices</span><span class="p">:</span>
</span><span id="Graphing-490"><a href="#Graphing-490"><span class="linenos"> 490</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> 
</span><span id="Graphing-491"><a href="#Graphing-491"><span class="linenos"> 491</span></a>                     <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span> 
</span><span id="Graphing-492"><a href="#Graphing-492"><span class="linenos"> 492</span></a>    
</span><span id="Graphing-493"><a href="#Graphing-493"><span class="linenos"> 493</span></a>    
</span><span id="Graphing-494"><a href="#Graphing-494"><span class="linenos"> 494</span></a>    <span class="k">def</span> <span class="nf">get_commute_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
</span><span id="Graphing-495"><a href="#Graphing-495"><span class="linenos"> 495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-496"><a href="#Graphing-496"><span class="linenos"> 496</span></a><span class="sd">        Extracts specified values from the commute data for employee addresses that match a given office location.</span>
</span><span id="Graphing-497"><a href="#Graphing-497"><span class="linenos"> 497</span></a>
</span><span id="Graphing-498"><a href="#Graphing-498"><span class="linenos"> 498</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-499"><a href="#Graphing-499"><span class="linenos"> 499</span></a><span class="sd">            emp (DataFrame): A DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-500"><a href="#Graphing-500"><span class="linenos"> 500</span></a><span class="sd">            office (DataFrame): A single-row DataFrame containing the target office location with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-501"><a href="#Graphing-501"><span class="linenos"> 501</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations.</span>
</span><span id="Graphing-502"><a href="#Graphing-502"><span class="linenos"> 502</span></a><span class="sd">            values (list of str or str): Column name(s) in `commute_data` to extract. Can be a single column name or a list of names.</span>
</span><span id="Graphing-503"><a href="#Graphing-503"><span class="linenos"> 503</span></a>
</span><span id="Graphing-504"><a href="#Graphing-504"><span class="linenos"> 504</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-505"><a href="#Graphing-505"><span class="linenos"> 505</span></a><span class="sd">            DataFrame: A DataFrame containing the extracted values for each employee location that matches the given office location. The DataFrame includes &#39;latitude&#39; and &#39;longitude&#39; of the employee locations and the specified `values`.</span>
</span><span id="Graphing-506"><a href="#Graphing-506"><span class="linenos"> 506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-507"><a href="#Graphing-507"><span class="linenos"> 507</span></a>
</span><span id="Graphing-508"><a href="#Graphing-508"><span class="linenos"> 508</span></a>         <span class="c1"># Ensure the basic columns are always included</span>
</span><span id="Graphing-509"><a href="#Graphing-509"><span class="linenos"> 509</span></a>        <span class="n">base_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">]</span>
</span><span id="Graphing-510"><a href="#Graphing-510"><span class="linenos"> 510</span></a>        <span class="c1"># Combine base columns with user-specified columns, removing duplicates</span>
</span><span id="Graphing-511"><a href="#Graphing-511"><span class="linenos"> 511</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-512"><a href="#Graphing-512"><span class="linenos"> 512</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing-513"><a href="#Graphing-513"><span class="linenos"> 513</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-514"><a href="#Graphing-514"><span class="linenos"> 514</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_columns</span><span class="p">]</span>
</span><span id="Graphing-515"><a href="#Graphing-515"><span class="linenos"> 515</span></a>        
</span><span id="Graphing-516"><a href="#Graphing-516"><span class="linenos"> 516</span></a>        <span class="k">return</span> <span class="n">commute_data</span><span class="p">[(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="Graphing-517"><a href="#Graphing-517"><span class="linenos"> 517</span></a>                           <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="Graphing-518"><a href="#Graphing-518"><span class="linenos"> 518</span></a>                            <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]))][</span><span class="n">selected_columns</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
</span><span id="Graphing-519"><a href="#Graphing-519"><span class="linenos"> 519</span></a>
</span><span id="Graphing-520"><a href="#Graphing-520"><span class="linenos"> 520</span></a>    
</span><span id="Graphing-521"><a href="#Graphing-521"><span class="linenos"> 521</span></a>    <span class="k">def</span> <span class="nf">plot_preamble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Graphing-522"><a href="#Graphing-522"><span class="linenos"> 522</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-523"><a href="#Graphing-523"><span class="linenos"> 523</span></a><span class="sd">        Filters employee locations based on a specified cutoff radius from office locations and prepares data for plotting.</span>
</span><span id="Graphing-524"><a href="#Graphing-524"><span class="linenos"> 524</span></a>
</span><span id="Graphing-525"><a href="#Graphing-525"><span class="linenos"> 525</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-526"><a href="#Graphing-526"><span class="linenos"> 526</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-527"><a href="#Graphing-527"><span class="linenos"> 527</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-528"><a href="#Graphing-528"><span class="linenos"> 528</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations. Only employee locations within this radius from any office location are included.</span>
</span><span id="Graphing-529"><a href="#Graphing-529"><span class="linenos"> 529</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations. Only employee locations within this distance from any office location are included.</span>
</span><span id="Graphing-530"><a href="#Graphing-530"><span class="linenos"> 530</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations, required if `cutoff_distance` is specified.</span>
</span><span id="Graphing-531"><a href="#Graphing-531"><span class="linenos"> 531</span></a><span class="sd">            </span>
</span><span id="Graphing-532"><a href="#Graphing-532"><span class="linenos"> 532</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-533"><a href="#Graphing-533"><span class="linenos"> 533</span></a><span class="sd">            tuple: A tuple containing the filtered employee DataFrame, and Series objects for latitudes and longitudes of all included </span>
</span><span id="Graphing-534"><a href="#Graphing-534"><span class="linenos"> 534</span></a><span class="sd">            locations (employees and offices combined). The filtered DataFrame only includes employees within the `cutoff_radius` from </span>
</span><span id="Graphing-535"><a href="#Graphing-535"><span class="linenos"> 535</span></a><span class="sd">            any office location if specified.</span>
</span><span id="Graphing-536"><a href="#Graphing-536"><span class="linenos"> 536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-537"><a href="#Graphing-537"><span class="linenos"> 537</span></a>
</span><span id="Graphing-538"><a href="#Graphing-538"><span class="linenos"> 538</span></a>        <span class="c1"># we will use the haversine formula to calculate the distance between two lat/long pairs </span>
</span><span id="Graphing-539"><a href="#Graphing-539"><span class="linenos"> 539</span></a>        <span class="k">if</span> <span class="n">cutoff_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-540"><a href="#Graphing-540"><span class="linenos"> 540</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_radius of any of the offices</span>
</span><span id="Graphing-541"><a href="#Graphing-541"><span class="linenos"> 541</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing-542"><a href="#Graphing-542"><span class="linenos"> 542</span></a>        <span class="k">elif</span> <span class="n">cutoff_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-543"><a href="#Graphing-543"><span class="linenos"> 543</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_distance of any of the offices</span>
</span><span id="Graphing-544"><a href="#Graphing-544"><span class="linenos"> 544</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-545"><a href="#Graphing-545"><span class="linenos"> 545</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-546"><a href="#Graphing-546"><span class="linenos"> 546</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="n">emp</span>
</span><span id="Graphing-547"><a href="#Graphing-547"><span class="linenos"> 547</span></a>        
</span><span id="Graphing-548"><a href="#Graphing-548"><span class="linenos"> 548</span></a>        <span class="c1"># data is a pandas dataframe has coloumns latitude and longitude        </span>
</span><span id="Graphing-549"><a href="#Graphing-549"><span class="linenos"> 549</span></a>        <span class="c1"># append the office lat/longs to the employee lat/longs to get bounding box</span>
</span><span id="Graphing-550"><a href="#Graphing-550"><span class="linenos"> 550</span></a>        <span class="n">latitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing-551"><a href="#Graphing-551"><span class="linenos"> 551</span></a>        <span class="n">longitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing-552"><a href="#Graphing-552"><span class="linenos"> 552</span></a>        <span class="k">return</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span>
</span><span id="Graphing-553"><a href="#Graphing-553"><span class="linenos"> 553</span></a>    
</span><span id="Graphing-554"><a href="#Graphing-554"><span class="linenos"> 554</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="Graphing-555"><a href="#Graphing-555"><span class="linenos"> 555</span></a>    <span class="k">def</span> <span class="nf">get_map_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing-556"><a href="#Graphing-556"><span class="linenos"> 556</span></a>                      <span class="n">commute_color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
</span><span id="Graphing-557"><a href="#Graphing-557"><span class="linenos"> 557</span></a>                      <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
</span><span id="Graphing-558"><a href="#Graphing-558"><span class="linenos"> 558</span></a>                      <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing-559"><a href="#Graphing-559"><span class="linenos"> 559</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-560"><a href="#Graphing-560"><span class="linenos"> 560</span></a><span class="sd">        Generates a map view showing employee and office locations, optionally with commute radius and coloring based on commute data.</span>
</span><span id="Graphing-561"><a href="#Graphing-561"><span class="linenos"> 561</span></a>
</span><span id="Graphing-562"><a href="#Graphing-562"><span class="linenos"> 562</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-563"><a href="#Graphing-563"><span class="linenos"> 563</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-564"><a href="#Graphing-564"><span class="linenos"> 564</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-565"><a href="#Graphing-565"><span class="linenos"> 565</span></a><span class="sd">            commute_data (DataFrame, optional): DataFrame containing commute data between employee and office locations. Required if commute_color is True.</span>
</span><span id="Graphing-566"><a href="#Graphing-566"><span class="linenos"> 566</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations for visualization.</span>
</span><span id="Graphing-567"><a href="#Graphing-567"><span class="linenos"> 567</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations for visualization.</span>
</span><span id="Graphing-568"><a href="#Graphing-568"><span class="linenos"> 568</span></a><span class="sd">            commute_radius (float, optional): Radius in miles from offices to visualize commute boundaries.</span>
</span><span id="Graphing-569"><a href="#Graphing-569"><span class="linenos"> 569</span></a><span class="sd">            commute_color (bool, optional): If True, colors employee locations based on commute data presence within commute_radius.</span>
</span><span id="Graphing-570"><a href="#Graphing-570"><span class="linenos"> 570</span></a><span class="sd">            title (str, optional): Title for the map.</span>
</span><span id="Graphing-571"><a href="#Graphing-571"><span class="linenos"> 571</span></a><span class="sd">            convex_hull (bool, optional): If True, draws a convex hull around employee locations within commute_radius.</span>
</span><span id="Graphing-572"><a href="#Graphing-572"><span class="linenos"> 572</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="Graphing-573"><a href="#Graphing-573"><span class="linenos"> 573</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="Graphing-574"><a href="#Graphing-574"><span class="linenos"> 574</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-575"><a href="#Graphing-575"><span class="linenos"> 575</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing-576"><a href="#Graphing-576"><span class="linenos"> 576</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing-577"><a href="#Graphing-577"><span class="linenos"> 577</span></a><span class="sd">            legend_loc (str, optional): Location of the legend on the map. Defaults to &#39;upper right&#39;.</span>
</span><span id="Graphing-578"><a href="#Graphing-578"><span class="linenos"> 578</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="Graphing-579"><a href="#Graphing-579"><span class="linenos"> 579</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="Graphing-580"><a href="#Graphing-580"><span class="linenos"> 580</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing-581"><a href="#Graphing-581"><span class="linenos"> 581</span></a><span class="sd">            font_mod (int, optional): Font size modifier for scale bar. Defaults to 1.</span>
</span><span id="Graphing-582"><a href="#Graphing-582"><span class="linenos"> 582</span></a>
</span><span id="Graphing-583"><a href="#Graphing-583"><span class="linenos"> 583</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-584"><a href="#Graphing-584"><span class="linenos"> 584</span></a><span class="sd">            tuple: A tuple containing the matplotlib plt and axes objects.</span>
</span><span id="Graphing-585"><a href="#Graphing-585"><span class="linenos"> 585</span></a>
</span><span id="Graphing-586"><a href="#Graphing-586"><span class="linenos"> 586</span></a><span class="sd">        Notes:</span>
</span><span id="Graphing-587"><a href="#Graphing-587"><span class="linenos"> 587</span></a><span class="sd">            - Requires `commute_data` for commute_color functionality.</span>
</span><span id="Graphing-588"><a href="#Graphing-588"><span class="linenos"> 588</span></a><span class="sd">            - Adjust `cutoff_radius` and `commute_radius` to fine-tune the visualization.</span>
</span><span id="Graphing-589"><a href="#Graphing-589"><span class="linenos"> 589</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-590"><a href="#Graphing-590"><span class="linenos"> 590</span></a>
</span><span id="Graphing-591"><a href="#Graphing-591"><span class="linenos"> 591</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing-592"><a href="#Graphing-592"><span class="linenos"> 592</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-593"><a href="#Graphing-593"><span class="linenos"> 593</span></a>
</span><span id="Graphing-594"><a href="#Graphing-594"><span class="linenos"> 594</span></a>        <span class="c1"># configure the plot</span>
</span><span id="Graphing-595"><a href="#Graphing-595"><span class="linenos"> 595</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">)</span>        
</span><span id="Graphing-596"><a href="#Graphing-596"><span class="linenos"> 596</span></a>
</span><span id="Graphing-597"><a href="#Graphing-597"><span class="linenos"> 597</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-598"><a href="#Graphing-598"><span class="linenos"> 598</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-599"><a href="#Graphing-599"><span class="linenos"> 599</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing-600"><a href="#Graphing-600"><span class="linenos"> 600</span></a>        <span class="c1">#plt.plot(longitudes, latitudes, color=&#39;red&#39;, marker=&#39;*&#39;, markersize=3, linestyle=&#39;&#39;, transform=ccrs.PlateCarree())#ccrs.OSGB())</span>
</span><span id="Graphing-601"><a href="#Graphing-601"><span class="linenos"> 601</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">commute_color</span><span class="p">:</span>
</span><span id="Graphing-602"><a href="#Graphing-602"><span class="linenos"> 602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span><span class="p">)</span>
</span><span id="Graphing-603"><a href="#Graphing-603"><span class="linenos"> 603</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="Graphing-604"><a href="#Graphing-604"><span class="linenos"> 604</span></a>            
</span><span id="Graphing-605"><a href="#Graphing-605"><span class="linenos"> 605</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-606"><a href="#Graphing-606"><span class="linenos"> 606</span></a>            <span class="c1"># plot the lat long points with color based on if the employee is within the linear radius of any of the offices</span>
</span><span id="Graphing-607"><a href="#Graphing-607"><span class="linenos"> 607</span></a>            <span class="c1"># first create two new data frames for the employees within and outside the linear radius, and populate them with the appropriate lat/long pairs</span>
</span><span id="Graphing-608"><a href="#Graphing-608"><span class="linenos"> 608</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing-609"><a href="#Graphing-609"><span class="linenos"> 609</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Graphing-610"><a href="#Graphing-610"><span class="linenos"> 610</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="Graphing-611"><a href="#Graphing-611"><span class="linenos"> 611</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing-612"><a href="#Graphing-612"><span class="linenos"> 612</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Within &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="Graphing-613"><a href="#Graphing-613"><span class="linenos"> 613</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing-614"><a href="#Graphing-614"><span class="linenos"> 614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Outside &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="Graphing-615"><a href="#Graphing-615"><span class="linenos"> 615</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="Graphing-616"><a href="#Graphing-616"><span class="linenos"> 616</span></a>            
</span><span id="Graphing-617"><a href="#Graphing-617"><span class="linenos"> 617</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-618"><a href="#Graphing-618"><span class="linenos"> 618</span></a>            <span class="c1"># use the commute data to use actual driving distance to color the data points</span>
</span><span id="Graphing-619"><a href="#Graphing-619"><span class="linenos"> 619</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-620"><a href="#Graphing-620"><span class="linenos"> 620</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Graphing-621"><a href="#Graphing-621"><span class="linenos"> 621</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="Graphing-622"><a href="#Graphing-622"><span class="linenos"> 622</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing-623"><a href="#Graphing-623"><span class="linenos"> 623</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\N{LESS-THAN OR EQUAL TO}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="Graphing-624"><a href="#Graphing-624"><span class="linenos"> 624</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing-625"><a href="#Graphing-625"><span class="linenos"> 625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="Graphing-626"><a href="#Graphing-626"><span class="linenos"> 626</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>          
</span><span id="Graphing-627"><a href="#Graphing-627"><span class="linenos"> 627</span></a>
</span><span id="Graphing-628"><a href="#Graphing-628"><span class="linenos"> 628</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing-629"><a href="#Graphing-629"><span class="linenos"> 629</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-630"><a href="#Graphing-630"><span class="linenos"> 630</span></a>        
</span><span id="Graphing-631"><a href="#Graphing-631"><span class="linenos"> 631</span></a>        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="Graphing-632"><a href="#Graphing-632"><span class="linenos"> 632</span></a>        <span class="c1"># draw a circle around the office locations to represent the radius from each office and add legend entry, if commute_radius is not None</span>
</span><span id="Graphing-633"><a href="#Graphing-633"><span class="linenos"> 633</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-634"><a href="#Graphing-634"><span class="linenos"> 634</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Graphing-635"><a href="#Graphing-635"><span class="linenos"> 635</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Linear Radius </span><span class="se">\n</span><span class="s1">(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles)&#39;</span>
</span><span id="Graphing-636"><a href="#Graphing-636"><span class="linenos"> 636</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="Graphing-637"><a href="#Graphing-637"><span class="linenos"> 637</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="Graphing-638"><a href="#Graphing-638"><span class="linenos"> 638</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_elines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing-639"><a href="#Graphing-639"><span class="linenos"> 639</span></a>        
</span><span id="Graphing-640"><a href="#Graphing-640"><span class="linenos"> 640</span></a>        <span class="k">if</span> <span class="n">convex_hull</span> <span class="ow">and</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-641"><a href="#Graphing-641"><span class="linenos"> 641</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Convex Hull&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Graphing-642"><a href="#Graphing-642"><span class="linenos"> 642</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Bounding Area, </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Commute&#39;</span>
</span><span id="Graphing-643"><a href="#Graphing-643"><span class="linenos"> 643</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="Graphing-644"><a href="#Graphing-644"><span class="linenos"> 644</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="Graphing-645"><a href="#Graphing-645"><span class="linenos"> 645</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">)</span>
</span><span id="Graphing-646"><a href="#Graphing-646"><span class="linenos"> 646</span></a>            
</span><span id="Graphing-647"><a href="#Graphing-647"><span class="linenos"> 647</span></a>        <span class="c1"># add a legend  to the plot on the middle left</span>
</span><span id="Graphing-648"><a href="#Graphing-648"><span class="linenos"> 648</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">map_view_standard_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span><span class="n">legend_loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">)</span>
</span><span id="Graphing-649"><a href="#Graphing-649"><span class="linenos"> 649</span></a>        <span class="c1"># add a title</span>
</span><span id="Graphing-650"><a href="#Graphing-650"><span class="linenos"> 650</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-651"><a href="#Graphing-651"><span class="linenos"> 651</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-652"><a href="#Graphing-652"><span class="linenos"> 652</span></a>
</span><span id="Graphing-653"><a href="#Graphing-653"><span class="linenos"> 653</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-654"><a href="#Graphing-654"><span class="linenos"> 654</span></a>
</span><span id="Graphing-655"><a href="#Graphing-655"><span class="linenos"> 655</span></a>    <span class="k">def</span> <span class="nf">map_view_standard_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> 
</span><span id="Graphing-656"><a href="#Graphing-656"><span class="linenos"> 656</span></a>                                 <span class="n">legend_edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
</span><span id="Graphing-657"><a href="#Graphing-657"><span class="linenos"> 657</span></a>                                 <span class="n">legend_framealpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="Graphing-658"><a href="#Graphing-658"><span class="linenos"> 658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-659"><a href="#Graphing-659"><span class="linenos"> 659</span></a><span class="sd">        Adds a standard legend to a map view plot.</span>
</span><span id="Graphing-660"><a href="#Graphing-660"><span class="linenos"> 660</span></a>
</span><span id="Graphing-661"><a href="#Graphing-661"><span class="linenos"> 661</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-662"><a href="#Graphing-662"><span class="linenos"> 662</span></a><span class="sd">            ax: The matplotlib axes object on which to draw the legend.</span>
</span><span id="Graphing-663"><a href="#Graphing-663"><span class="linenos"> 663</span></a><span class="sd">            handles (list): A list of handles to the objects being represented in the legend.</span>
</span><span id="Graphing-664"><a href="#Graphing-664"><span class="linenos"> 664</span></a><span class="sd">            labels (list): A list of labels for the objects being represented in the legend.</span>
</span><span id="Graphing-665"><a href="#Graphing-665"><span class="linenos"> 665</span></a><span class="sd">            title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="Graphing-666"><a href="#Graphing-666"><span class="linenos"> 666</span></a><span class="sd">            legend_title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="Graphing-667"><a href="#Graphing-667"><span class="linenos"> 667</span></a><span class="sd">            legend_loc (str, optional): Location for the legend. Defaults to &#39;upper left&#39;.</span>
</span><span id="Graphing-668"><a href="#Graphing-668"><span class="linenos"> 668</span></a><span class="sd">            legend_labels (list, optional): Labels for the legend entries. Defaults to None.</span>
</span><span id="Graphing-669"><a href="#Graphing-669"><span class="linenos"> 669</span></a><span class="sd">            legend_colors (list, optional): Colors for the legend entries. Defaults to None.</span>
</span><span id="Graphing-670"><a href="#Graphing-670"><span class="linenos"> 670</span></a><span class="sd">            legend_markers (list, optional): Markers for the legend entries. Defaults to None.</span>
</span><span id="Graphing-671"><a href="#Graphing-671"><span class="linenos"> 671</span></a><span class="sd">            legend_edgecolor (str, optional): Edge color for the legend. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-672"><a href="#Graphing-672"><span class="linenos"> 672</span></a><span class="sd">            legend_frameon (bool, optional): Whether to draw a frame around the legend. Defaults to True.</span>
</span><span id="Graphing-673"><a href="#Graphing-673"><span class="linenos"> 673</span></a><span class="sd">            legend_facecolor (str, optional): Face color for the legend. Defaults to &#39;white&#39;.</span>
</span><span id="Graphing-674"><a href="#Graphing-674"><span class="linenos"> 674</span></a><span class="sd">            legend_framealpha (float, optional): Opacity of the legend frame. Defaults to 0.7.</span>
</span><span id="Graphing-675"><a href="#Graphing-675"><span class="linenos"> 675</span></a><span class="sd">            fontsize (int, optional): Font size for the legend. Defaults to 10.</span>
</span><span id="Graphing-676"><a href="#Graphing-676"><span class="linenos"> 676</span></a>
</span><span id="Graphing-677"><a href="#Graphing-677"><span class="linenos"> 677</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-678"><a href="#Graphing-678"><span class="linenos"> 678</span></a>        
</span><span id="Graphing-679"><a href="#Graphing-679"><span class="linenos"> 679</span></a>        <span class="c1"># Add legend to the plot</span>
</span><span id="Graphing-680"><a href="#Graphing-680"><span class="linenos"> 680</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">legend_edgecolor</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="n">legend_frameon</span><span class="p">,</span> 
</span><span id="Graphing-681"><a href="#Graphing-681"><span class="linenos"> 681</span></a>                  <span class="n">facecolor</span><span class="o">=</span><span class="n">legend_facecolor</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="n">legend_framealpha</span><span class="p">)</span>
</span><span id="Graphing-682"><a href="#Graphing-682"><span class="linenos"> 682</span></a>        
</span><span id="Graphing-683"><a href="#Graphing-683"><span class="linenos"> 683</span></a>   
</span><span id="Graphing-684"><a href="#Graphing-684"><span class="linenos"> 684</span></a>
</span><span id="Graphing-685"><a href="#Graphing-685"><span class="linenos"> 685</span></a><span class="c1">############################################################################################################</span>
</span><span id="Graphing-686"><a href="#Graphing-686"><span class="linenos"> 686</span></a>            
</span><span id="Graphing-687"><a href="#Graphing-687"><span class="linenos"> 687</span></a>    <span class="k">def</span> <span class="nf">get_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Graphing-688"><a href="#Graphing-688"><span class="linenos"> 688</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
</span><span id="Graphing-689"><a href="#Graphing-689"><span class="linenos"> 689</span></a>                    <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> 
</span><span id="Graphing-690"><a href="#Graphing-690"><span class="linenos"> 690</span></a>                    <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)):</span>
</span><span id="Graphing-691"><a href="#Graphing-691"><span class="linenos"> 691</span></a>
</span><span id="Graphing-692"><a href="#Graphing-692"><span class="linenos"> 692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-693"><a href="#Graphing-693"><span class="linenos"> 693</span></a><span class="sd">        Generates a heatmap of a specific commute data metric for employee locations relative to a single office location.</span>
</span><span id="Graphing-694"><a href="#Graphing-694"><span class="linenos"> 694</span></a>
</span><span id="Graphing-695"><a href="#Graphing-695"><span class="linenos"> 695</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-696"><a href="#Graphing-696"><span class="linenos"> 696</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-697"><a href="#Graphing-697"><span class="linenos"> 697</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-698"><a href="#Graphing-698"><span class="linenos"> 698</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="Graphing-699"><a href="#Graphing-699"><span class="linenos"> 699</span></a><span class="sd">            value (str): The name of the column in `commute_data` representing the metric to visualize on the heatmap.</span>
</span><span id="Graphing-700"><a href="#Graphing-700"><span class="linenos"> 700</span></a><span class="sd">            title (str, optional): Title for the heatmap. Defaults to None.</span>
</span><span id="Graphing-701"><a href="#Graphing-701"><span class="linenos"> 701</span></a><span class="sd">            value_label (str, optional): Label for the color bar indicating the metric. Defaults to &#39;&#39;.</span>
</span><span id="Graphing-702"><a href="#Graphing-702"><span class="linenos"> 702</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="Graphing-703"><a href="#Graphing-703"><span class="linenos"> 703</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="Graphing-704"><a href="#Graphing-704"><span class="linenos"> 704</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the heatmap. Defaults to None.</span>
</span><span id="Graphing-705"><a href="#Graphing-705"><span class="linenos"> 705</span></a><span class="sd">            convex_hull (bool, optional): If True, draw a convex hull around the employee locations included in the heatmap. Defaults to False.</span>
</span><span id="Graphing-706"><a href="#Graphing-706"><span class="linenos"> 706</span></a><span class="sd">            plot_points (bool, optional): If True, plot individual employee locations on the heatmap. Defaults to False.</span>
</span><span id="Graphing-707"><a href="#Graphing-707"><span class="linenos"> 707</span></a><span class="sd">            imagery (str, optional): Background map style. Supports &quot;OSM&quot; for OpenStreetMap and &quot;Google&quot; for Google Maps tiles. Defaults to &quot;OSM&quot;.</span>
</span><span id="Graphing-708"><a href="#Graphing-708"><span class="linenos"> 708</span></a><span class="sd">            cmap (str, optional): Colormap for the heatmap. Defaults to &#39;jet&#39;.</span>
</span><span id="Graphing-709"><a href="#Graphing-709"><span class="linenos"> 709</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="Graphing-710"><a href="#Graphing-710"><span class="linenos"> 710</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="Graphing-711"><a href="#Graphing-711"><span class="linenos"> 711</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-712"><a href="#Graphing-712"><span class="linenos"> 712</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing-713"><a href="#Graphing-713"><span class="linenos"> 713</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing-714"><a href="#Graphing-714"><span class="linenos"> 714</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="Graphing-715"><a href="#Graphing-715"><span class="linenos"> 715</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="Graphing-716"><a href="#Graphing-716"><span class="linenos"> 716</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing-717"><a href="#Graphing-717"><span class="linenos"> 717</span></a><span class="sd">            alpha (float, optional): Transparency of the heatmap. Defaults to 0.5.</span>
</span><span id="Graphing-718"><a href="#Graphing-718"><span class="linenos"> 718</span></a><span class="sd">            levels (int, optional): Number of levels for the color bar. Defaults to 10.</span>
</span><span id="Graphing-719"><a href="#Graphing-719"><span class="linenos"> 719</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing-720"><a href="#Graphing-720"><span class="linenos"> 720</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="Graphing-721"><a href="#Graphing-721"><span class="linenos"> 721</span></a>
</span><span id="Graphing-722"><a href="#Graphing-722"><span class="linenos"> 722</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-723"><a href="#Graphing-723"><span class="linenos"> 723</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing-724"><a href="#Graphing-724"><span class="linenos"> 724</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-725"><a href="#Graphing-725"><span class="linenos"> 725</span></a>
</span><span id="Graphing-726"><a href="#Graphing-726"><span class="linenos"> 726</span></a>        
</span><span id="Graphing-727"><a href="#Graphing-727"><span class="linenos"> 727</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing-728"><a href="#Graphing-728"><span class="linenos"> 728</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing-729"><a href="#Graphing-729"><span class="linenos"> 729</span></a>    
</span><span id="Graphing-730"><a href="#Graphing-730"><span class="linenos"> 730</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="Graphing-731"><a href="#Graphing-731"><span class="linenos"> 731</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="Graphing-732"><a href="#Graphing-732"><span class="linenos"> 732</span></a>        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="Graphing-733"><a href="#Graphing-733"><span class="linenos"> 733</span></a>        <span class="c1"># plot a) heatmap of a data value relative to employee addresses and a target office location</span>
</span><span id="Graphing-734"><a href="#Graphing-734"><span class="linenos"> 734</span></a>        
</span><span id="Graphing-735"><a href="#Graphing-735"><span class="linenos"> 735</span></a>        <span class="c1"># create an np array of the lat long pairs and the value</span>
</span><span id="Graphing-736"><a href="#Graphing-736"><span class="linenos"> 736</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="n">imagery</span><span class="p">)</span>
</span><span id="Graphing-737"><a href="#Graphing-737"><span class="linenos"> 737</span></a>
</span><span id="Graphing-738"><a href="#Graphing-738"><span class="linenos"> 738</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-739"><a href="#Graphing-739"><span class="linenos"> 739</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-740"><a href="#Graphing-740"><span class="linenos"> 740</span></a>
</span><span id="Graphing-741"><a href="#Graphing-741"><span class="linenos"> 741</span></a>        <span class="c1"># Create the heatmap</span>
</span><span id="Graphing-742"><a href="#Graphing-742"><span class="linenos"> 742</span></a>        <span class="c1">#plt.tricontourf(X, Y, Z, cmap=&#39;jet&#39;, levels=10, alpha=0.7, transform=ccrs.PlateCarree())</span>
</span><span id="Graphing-743"><a href="#Graphing-743"><span class="linenos"> 743</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">value</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing-744"><a href="#Graphing-744"><span class="linenos"> 744</span></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">value_label</span><span class="p">)</span>  <span class="c1"># Add a color bar to show the temperature scale</span>
</span><span id="Graphing-745"><a href="#Graphing-745"><span class="linenos"> 745</span></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-746"><a href="#Graphing-746"><span class="linenos"> 746</span></a>        
</span><span id="Graphing-747"><a href="#Graphing-747"><span class="linenos"> 747</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">convex_hull</span><span class="p">:</span>
</span><span id="Graphing-748"><a href="#Graphing-748"><span class="linenos"> 748</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing-749"><a href="#Graphing-749"><span class="linenos"> 749</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-750"><a href="#Graphing-750"><span class="linenos"> 750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</span><span id="Graphing-751"><a href="#Graphing-751"><span class="linenos"> 751</span></a>        
</span><span id="Graphing-752"><a href="#Graphing-752"><span class="linenos"> 752</span></a>        <span class="k">if</span> <span class="n">plot_points</span><span class="p">:</span>
</span><span id="Graphing-753"><a href="#Graphing-753"><span class="linenos"> 753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Employee </span><span class="se">\n</span><span class="s1">Addresses&#39;</span><span class="p">)</span>
</span><span id="Graphing-754"><a href="#Graphing-754"><span class="linenos"> 754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">)</span>
</span><span id="Graphing-755"><a href="#Graphing-755"><span class="linenos"> 755</span></a>
</span><span id="Graphing-756"><a href="#Graphing-756"><span class="linenos"> 756</span></a>
</span><span id="Graphing-757"><a href="#Graphing-757"><span class="linenos"> 757</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing-758"><a href="#Graphing-758"><span class="linenos"> 758</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-759"><a href="#Graphing-759"><span class="linenos"> 759</span></a>        <span class="c1"># add a title</span>
</span><span id="Graphing-760"><a href="#Graphing-760"><span class="linenos"> 760</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-761"><a href="#Graphing-761"><span class="linenos"> 761</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-762"><a href="#Graphing-762"><span class="linenos"> 762</span></a>        
</span><span id="Graphing-763"><a href="#Graphing-763"><span class="linenos"> 763</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-764"><a href="#Graphing-764"><span class="linenos"> 764</span></a>
</span><span id="Graphing-765"><a href="#Graphing-765"><span class="linenos"> 765</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="Graphing-766"><a href="#Graphing-766"><span class="linenos"> 766</span></a>
</span><span id="Graphing-767"><a href="#Graphing-767"><span class="linenos"> 767</span></a>    <span class="k">def</span> <span class="nf">get_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing-768"><a href="#Graphing-768"><span class="linenos"> 768</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">column_titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cumulative_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_y_label</span><span class="o">=</span><span class="s2">&quot;Cumulative %&quot;</span><span class="p">,</span>
</span><span id="Graphing-769"><a href="#Graphing-769"><span class="linenos"> 769</span></a>                    <span class="n">cumulative_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cumulative_linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">cumulative_linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cumulative_markers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_as_percentage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Graphing-770"><a href="#Graphing-770"><span class="linenos"> 770</span></a>                    <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Graphing-771"><a href="#Graphing-771"><span class="linenos"> 771</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-772"><a href="#Graphing-772"><span class="linenos"> 772</span></a><span class="sd">        Generates a histogram (or set of histograms) for specified commute data metrics for employee locations relative to a single office location.</span>
</span><span id="Graphing-773"><a href="#Graphing-773"><span class="linenos"> 773</span></a>
</span><span id="Graphing-774"><a href="#Graphing-774"><span class="linenos"> 774</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-775"><a href="#Graphing-775"><span class="linenos"> 775</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing-776"><a href="#Graphing-776"><span class="linenos"> 776</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location.</span>
</span><span id="Graphing-777"><a href="#Graphing-777"><span class="linenos"> 777</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="Graphing-778"><a href="#Graphing-778"><span class="linenos"> 778</span></a><span class="sd">            values (list of str): Names of the columns in `commute_data` representing the metrics to visualize in the histograms.</span>
</span><span id="Graphing-779"><a href="#Graphing-779"><span class="linenos"> 779</span></a><span class="sd">            title (str, optional): Main title for the histogram plot(s). Defaults to None.</span>
</span><span id="Graphing-780"><a href="#Graphing-780"><span class="linenos"> 780</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="Graphing-781"><a href="#Graphing-781"><span class="linenos"> 781</span></a><span class="sd">            value_label (str, optional): Label for the metric values. Defaults to &#39;&#39;.</span>
</span><span id="Graphing-782"><a href="#Graphing-782"><span class="linenos"> 782</span></a><span class="sd">            x_label (str, optional): Label for the x-axis. Defaults to &#39;&#39;.</span>
</span><span id="Graphing-783"><a href="#Graphing-783"><span class="linenos"> 783</span></a><span class="sd">            y_label (str, optional): Label for the y-axis. Defaults to &#39;&#39;.</span>
</span><span id="Graphing-784"><a href="#Graphing-784"><span class="linenos"> 784</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the histograms. Defaults to None.</span>
</span><span id="Graphing-785"><a href="#Graphing-785"><span class="linenos"> 785</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the histograms. Defaults to None.</span>
</span><span id="Graphing-786"><a href="#Graphing-786"><span class="linenos"> 786</span></a><span class="sd">            bins (int, optional): Number of bins for the histograms. Defaults to 10.</span>
</span><span id="Graphing-787"><a href="#Graphing-787"><span class="linenos"> 787</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing-788"><a href="#Graphing-788"><span class="linenos"> 788</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing-789"><a href="#Graphing-789"><span class="linenos"> 789</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="Graphing-790"><a href="#Graphing-790"><span class="linenos"> 790</span></a><span class="sd">            column_titles (list of str, optional): Titles for each subplot column. Defaults to None.</span>
</span><span id="Graphing-791"><a href="#Graphing-791"><span class="linenos"> 791</span></a><span class="sd">            cumulative_line (bool, optional): If True, add a cumulative percentage line to the histograms. Defaults to False.</span>
</span><span id="Graphing-792"><a href="#Graphing-792"><span class="linenos"> 792</span></a><span class="sd">            cumulative_y_label (str, optional): Label for the cumulative percentage y-axis. Defaults to &quot;Cumulative %&quot;.</span>
</span><span id="Graphing-793"><a href="#Graphing-793"><span class="linenos"> 793</span></a><span class="sd">            cumulative_color (str, optional): Color for the cumulative line. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing-794"><a href="#Graphing-794"><span class="linenos"> 794</span></a><span class="sd">            cumulative_linestyle (str, optional): Line style for the cumulative line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing-795"><a href="#Graphing-795"><span class="linenos"> 795</span></a><span class="sd">            cumulative_linewidth (int, optional): Line width for the cumulative line. Defaults to 1.</span>
</span><span id="Graphing-796"><a href="#Graphing-796"><span class="linenos"> 796</span></a><span class="sd">            cumulative_markers (dict, optional): Dictionary specifying markers for specific cumulative percentages on the line. Format {%value(float or int): {style_arguments:values}}, not all values need to be present. Defaults to False.</span>
</span><span id="Graphing-797"><a href="#Graphing-797"><span class="linenos"> 797</span></a><span class="sd">            cumulative_as_percentage (bool, optional): If True, the cumulative line is displayed as a percentage. Defaults to True.</span>
</span><span id="Graphing-798"><a href="#Graphing-798"><span class="linenos"> 798</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing-799"><a href="#Graphing-799"><span class="linenos"> 799</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing-800"><a href="#Graphing-800"><span class="linenos"> 800</span></a><span class="sd">            override_values (DataFrame, optional): DataFrame to override default values for the plot. Defaults to None.</span>
</span><span id="Graphing-801"><a href="#Graphing-801"><span class="linenos"> 801</span></a><span class="sd">            sharex (bool, optional): If True, share x-axis between subplots. Defaults to False.</span>
</span><span id="Graphing-802"><a href="#Graphing-802"><span class="linenos"> 802</span></a><span class="sd">            sharey (bool, optional): If True, share y-axis between subplots. Defaults to False.</span>
</span><span id="Graphing-803"><a href="#Graphing-803"><span class="linenos"> 803</span></a>
</span><span id="Graphing-804"><a href="#Graphing-804"><span class="linenos"> 804</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-805"><a href="#Graphing-805"><span class="linenos"> 805</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing-806"><a href="#Graphing-806"><span class="linenos"> 806</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-807"><a href="#Graphing-807"><span class="linenos"> 807</span></a>
</span><span id="Graphing-808"><a href="#Graphing-808"><span class="linenos"> 808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cumulative Markers format: {%value(float or int): {style_arguments:values}} not all values need to be present&quot;&quot;&quot;</span>
</span><span id="Graphing-809"><a href="#Graphing-809"><span class="linenos"> 809</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing-810"><a href="#Graphing-810"><span class="linenos"> 810</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing-811"><a href="#Graphing-811"><span class="linenos"> 811</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-812"><a href="#Graphing-812"><span class="linenos"> 812</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing-813"><a href="#Graphing-813"><span class="linenos"> 813</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-814"><a href="#Graphing-814"><span class="linenos"> 814</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing-815"><a href="#Graphing-815"><span class="linenos"> 815</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-816"><a href="#Graphing-816"><span class="linenos"> 816</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing-817"><a href="#Graphing-817"><span class="linenos"> 817</span></a>
</span><span id="Graphing-818"><a href="#Graphing-818"><span class="linenos"> 818</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="Graphing-819"><a href="#Graphing-819"><span class="linenos"> 819</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="Graphing-820"><a href="#Graphing-820"><span class="linenos"> 820</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-821"><a href="#Graphing-821"><span class="linenos"> 821</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="Graphing-822"><a href="#Graphing-822"><span class="linenos"> 822</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-823"><a href="#Graphing-823"><span class="linenos"> 823</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</span><span id="Graphing-824"><a href="#Graphing-824"><span class="linenos"> 824</span></a>
</span><span id="Graphing-825"><a href="#Graphing-825"><span class="linenos"> 825</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
</span><span id="Graphing-826"><a href="#Graphing-826"><span class="linenos"> 826</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing-827"><a href="#Graphing-827"><span class="linenos"> 827</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.995</span><span class="p">)</span>
</span><span id="Graphing-828"><a href="#Graphing-828"><span class="linenos"> 828</span></a>        
</span><span id="Graphing-829"><a href="#Graphing-829"><span class="linenos"> 829</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing-830"><a href="#Graphing-830"><span class="linenos"> 830</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing-831"><a href="#Graphing-831"><span class="linenos"> 831</span></a>        <span class="n">y_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing-832"><a href="#Graphing-832"><span class="linenos"> 832</span></a>        <span class="n">x_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing-833"><a href="#Graphing-833"><span class="linenos"> 833</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="Graphing-834"><a href="#Graphing-834"><span class="linenos"> 834</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="Graphing-835"><a href="#Graphing-835"><span class="linenos"> 835</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="Graphing-836"><a href="#Graphing-836"><span class="linenos"> 836</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-837"><a href="#Graphing-837"><span class="linenos"> 837</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="Graphing-838"><a href="#Graphing-838"><span class="linenos"> 838</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="Graphing-839"><a href="#Graphing-839"><span class="linenos"> 839</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-840"><a href="#Graphing-840"><span class="linenos"> 840</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing-841"><a href="#Graphing-841"><span class="linenos"> 841</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="Graphing-842"><a href="#Graphing-842"><span class="linenos"> 842</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-843"><a href="#Graphing-843"><span class="linenos"> 843</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="Graphing-844"><a href="#Graphing-844"><span class="linenos"> 844</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="Graphing-845"><a href="#Graphing-845"><span class="linenos"> 845</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-846"><a href="#Graphing-846"><span class="linenos"> 846</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing-847"><a href="#Graphing-847"><span class="linenos"> 847</span></a>            
</span><span id="Graphing-848"><a href="#Graphing-848"><span class="linenos"> 848</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing-849"><a href="#Graphing-849"><span class="linenos"> 849</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-850"><a href="#Graphing-850"><span class="linenos"> 850</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing-851"><a href="#Graphing-851"><span class="linenos"> 851</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing-852"><a href="#Graphing-852"><span class="linenos"> 852</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-853"><a href="#Graphing-853"><span class="linenos"> 853</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing-854"><a href="#Graphing-854"><span class="linenos"> 854</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing-855"><a href="#Graphing-855"><span class="linenos"> 855</span></a>            <span class="c1"># set x label only for last row</span>
</span><span id="Graphing-856"><a href="#Graphing-856"><span class="linenos"> 856</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-857"><a href="#Graphing-857"><span class="linenos"> 857</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-858"><a href="#Graphing-858"><span class="linenos"> 858</span></a>            <span class="c1"># set titles only for first row</span>
</span><span id="Graphing-859"><a href="#Graphing-859"><span class="linenos"> 859</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">column_titles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-860"><a href="#Graphing-860"><span class="linenos"> 860</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column_titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-861"><a href="#Graphing-861"><span class="linenos"> 861</span></a>            <span class="c1"># set y axis only for first col</span>
</span><span id="Graphing-862"><a href="#Graphing-862"><span class="linenos"> 862</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing-863"><a href="#Graphing-863"><span class="linenos"> 863</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-864"><a href="#Graphing-864"><span class="linenos"> 864</span></a>            
</span><span id="Graphing-865"><a href="#Graphing-865"><span class="linenos"> 865</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing-866"><a href="#Graphing-866"><span class="linenos"> 866</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-867"><a href="#Graphing-867"><span class="linenos"> 867</span></a>                <span class="k">continue</span>
</span><span id="Graphing-868"><a href="#Graphing-868"><span class="linenos"> 868</span></a>        
</span><span id="Graphing-869"><a href="#Graphing-869"><span class="linenos"> 869</span></a>
</span><span id="Graphing-870"><a href="#Graphing-870"><span class="linenos"> 870</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing-871"><a href="#Graphing-871"><span class="linenos"> 871</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="Graphing-872"><a href="#Graphing-872"><span class="linenos"> 872</span></a>
</span><span id="Graphing-873"><a href="#Graphing-873"><span class="linenos"> 873</span></a>            <span class="c1"># set the xticks and yticks font size</span>
</span><span id="Graphing-874"><a href="#Graphing-874"><span class="linenos"> 874</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-875"><a href="#Graphing-875"><span class="linenos"> 875</span></a>            
</span><span id="Graphing-876"><a href="#Graphing-876"><span class="linenos"> 876</span></a>
</span><span id="Graphing-877"><a href="#Graphing-877"><span class="linenos"> 877</span></a>            <span class="c1"># if cumulative line is requested, plot it</span>
</span><span id="Graphing-878"><a href="#Graphing-878"><span class="linenos"> 878</span></a>            <span class="k">if</span> <span class="n">cumulative_line</span><span class="p">:</span>
</span><span id="Graphing-879"><a href="#Graphing-879"><span class="linenos"> 879</span></a>                <span class="n">twin</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="Graphing-880"><a href="#Graphing-880"><span class="linenos"> 880</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Graphing-881"><a href="#Graphing-881"><span class="linenos"> 881</span></a>
</span><span id="Graphing-882"><a href="#Graphing-882"><span class="linenos"> 882</span></a>                <span class="c1"># add a cumulative percentage line to the other y axis</span>
</span><span id="Graphing-883"><a href="#Graphing-883"><span class="linenos"> 883</span></a>                <span class="n">count</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="p">)</span>
</span><span id="Graphing-884"><a href="#Graphing-884"><span class="linenos"> 884</span></a>                <span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="Graphing-885"><a href="#Graphing-885"><span class="linenos"> 885</span></a>                
</span><span id="Graphing-886"><a href="#Graphing-886"><span class="linenos"> 886</span></a>                <span class="c1"># get total cumulative for denominator to convert to percentage</span>
</span><span id="Graphing-887"><a href="#Graphing-887"><span class="linenos"> 887</span></a>                <span class="n">total</span> <span class="o">=</span> <span class="n">cumulative</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Graphing-888"><a href="#Graphing-888"><span class="linenos"> 888</span></a>                <span class="c1"># convert to percentage</span>
</span><span id="Graphing-889"><a href="#Graphing-889"><span class="linenos"> 889</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="Graphing-890"><a href="#Graphing-890"><span class="linenos"> 890</span></a>                    <span class="n">cumulative</span> <span class="o">=</span> <span class="n">cumulative</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> 
</span><span id="Graphing-891"><a href="#Graphing-891"><span class="linenos"> 891</span></a>                
</span><span id="Graphing-892"><a href="#Graphing-892"><span class="linenos"> 892</span></a>                <span class="c1"># plot the cumulative line</span>
</span><span id="Graphing-893"><a href="#Graphing-893"><span class="linenos"> 893</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cumulative_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">cumulative_linestyle</span><span class="p">,</span> 
</span><span id="Graphing-894"><a href="#Graphing-894"><span class="linenos"> 894</span></a>                          <span class="n">linewidth</span><span class="o">=</span><span class="n">cumulative_linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cumulative_y_label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Graphing-895"><a href="#Graphing-895"><span class="linenos"> 895</span></a>
</span><span id="Graphing-896"><a href="#Graphing-896"><span class="linenos"> 896</span></a>                <span class="c1"># turn grid on relative to the twin y axis</span>
</span><span id="Graphing-897"><a href="#Graphing-897"><span class="linenos"> 897</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Graphing-898"><a href="#Graphing-898"><span class="linenos"> 898</span></a>                <span class="c1"># twin y ticks are percentage, set only for last column</span>
</span><span id="Graphing-899"><a href="#Graphing-899"><span class="linenos"> 899</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing-900"><a href="#Graphing-900"><span class="linenos"> 900</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cumulative_y_label</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-901"><a href="#Graphing-901"><span class="linenos"> 901</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="Graphing-902"><a href="#Graphing-902"><span class="linenos"> 902</span></a>                    <span class="c1"># set ticks every 25%, only show on last col</span>
</span><span id="Graphing-903"><a href="#Graphing-903"><span class="linenos"> 903</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</span><span id="Graphing-904"><a href="#Graphing-904"><span class="linenos"> 904</span></a>                <span class="c1"># turn off twin y axis numbers for first col</span>
</span><span id="Graphing-905"><a href="#Graphing-905"><span class="linenos"> 905</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing-906"><a href="#Graphing-906"><span class="linenos"> 906</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="Graphing-907"><a href="#Graphing-907"><span class="linenos"> 907</span></a>                
</span><span id="Graphing-908"><a href="#Graphing-908"><span class="linenos"> 908</span></a>                <span class="c1"># add markers to the cumulative line if requested</span>
</span><span id="Graphing-909"><a href="#Graphing-909"><span class="linenos"> 909</span></a>                <span class="k">if</span> <span class="n">cumulative_markers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Graphing-910"><a href="#Graphing-910"><span class="linenos"> 910</span></a>                    <span class="c1">#cumulative_markers format: {%value: {&#39;color&#39;: &#39;red&#39;, &#39;marker&#39;: &#39;o&#39;, &#39;label&#39;: &#39;75%&#39;, linestyle=&quot;--&quot;}} not all values need to be present</span>
</span><span id="Graphing-911"><a href="#Graphing-911"><span class="linenos"> 911</span></a>                    <span class="c1"># we plot a vertical line at x where y=%value on the twin</span>
</span><span id="Graphing-912"><a href="#Graphing-912"><span class="linenos"> 912</span></a>
</span><span id="Graphing-913"><a href="#Graphing-913"><span class="linenos"> 913</span></a>                    <span class="c1"># first get a polynomial fit to the cumulative percentage and find the x value where y is closest to %value</span>
</span><span id="Graphing-914"><a href="#Graphing-914"><span class="linenos"> 914</span></a>                    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="Graphing-915"><a href="#Graphing-915"><span class="linenos"> 915</span></a>                    
</span><span id="Graphing-916"><a href="#Graphing-916"><span class="linenos"> 916</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2000</span><span class="p">)</span>
</span><span id="Graphing-917"><a href="#Graphing-917"><span class="linenos"> 917</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Graphing-918"><a href="#Graphing-918"><span class="linenos"> 918</span></a>                    
</span><span id="Graphing-919"><a href="#Graphing-919"><span class="linenos"> 919</span></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cumulative_markers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Graphing-920"><a href="#Graphing-920"><span class="linenos"> 920</span></a>                        <span class="c1"># get the x value where y is closest to key</span>
</span><span id="Graphing-921"><a href="#Graphing-921"><span class="linenos"> 921</span></a>                        <span class="n">xval</span> <span class="o">=</span> <span class="n">x</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
</span><span id="Graphing-922"><a href="#Graphing-922"><span class="linenos"> 922</span></a>                        <span class="c1"># add the line with the style arguments</span>
</span><span id="Graphing-923"><a href="#Graphing-923"><span class="linenos"> 923</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xval</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">)</span>
</span><span id="Graphing-924"><a href="#Graphing-924"><span class="linenos"> 924</span></a>                        <span class="c1"># insert a label at the top of the line</span>
</span><span id="Graphing-925"><a href="#Graphing-925"><span class="linenos"> 925</span></a>                        <span class="c1"># get width of the plot</span>
</span><span id="Graphing-926"><a href="#Graphing-926"><span class="linenos"> 926</span></a>                        <span class="n">x_max</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Graphing-927"><a href="#Graphing-927"><span class="linenos"> 927</span></a>                        <span class="n">x_min</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing-928"><a href="#Graphing-928"><span class="linenos"> 928</span></a>                        <span class="c1"># calculate a delta for the label based on length                         </span>
</span><span id="Graphing-929"><a href="#Graphing-929"><span class="linenos"> 929</span></a>                        <span class="n">x_delta</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
</span><span id="Graphing-930"><a href="#Graphing-930"><span class="linenos"> 930</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xval</span><span class="o">-</span><span class="n">x_delta</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cumulative</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
</span><span id="Graphing-931"><a href="#Graphing-931"><span class="linenos"> 931</span></a>
</span><span id="Graphing-932"><a href="#Graphing-932"><span class="linenos"> 932</span></a>            <span class="c1"># capture dimensionality for matching limits across cols/rows</span>
</span><span id="Graphing-933"><a href="#Graphing-933"><span class="linenos"> 933</span></a>            <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing-934"><a href="#Graphing-934"><span class="linenos"> 934</span></a>            <span class="n">x_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing-935"><a href="#Graphing-935"><span class="linenos"> 935</span></a>
</span><span id="Graphing-936"><a href="#Graphing-936"><span class="linenos"> 936</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing-937"><a href="#Graphing-937"><span class="linenos"> 937</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-938"><a href="#Graphing-938"><span class="linenos"> 938</span></a>                <span class="k">continue</span>
</span><span id="Graphing-939"><a href="#Graphing-939"><span class="linenos"> 939</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-940"><a href="#Graphing-940"><span class="linenos"> 940</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing-941"><a href="#Graphing-941"><span class="linenos"> 941</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing-942"><a href="#Graphing-942"><span class="linenos"> 942</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-943"><a href="#Graphing-943"><span class="linenos"> 943</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing-944"><a href="#Graphing-944"><span class="linenos"> 944</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing-945"><a href="#Graphing-945"><span class="linenos"> 945</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>
</span><span id="Graphing-946"><a href="#Graphing-946"><span class="linenos"> 946</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
</span><span id="Graphing-947"><a href="#Graphing-947"><span class="linenos"> 947</span></a>            <span class="c1">#axf(r,c).set_xticks(np.arange(0, max(xyz[values[i]]), max(xyz[values[i]])/bins))</span>
</span><span id="Graphing-948"><a href="#Graphing-948"><span class="linenos"> 948</span></a>            
</span><span id="Graphing-949"><a href="#Graphing-949"><span class="linenos"> 949</span></a>
</span><span id="Graphing-950"><a href="#Graphing-950"><span class="linenos"> 950</span></a>        <span class="c1">#plt.xlabel(x_label)</span>
</span><span id="Graphing-951"><a href="#Graphing-951"><span class="linenos"> 951</span></a>        <span class="c1">#plt.ylabel(y_label)</span>
</span><span id="Graphing-952"><a href="#Graphing-952"><span class="linenos"> 952</span></a>        
</span><span id="Graphing-953"><a href="#Graphing-953"><span class="linenos"> 953</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-954"><a href="#Graphing-954"><span class="linenos"> 954</span></a>        
</span><span id="Graphing-955"><a href="#Graphing-955"><span class="linenos"> 955</span></a>    <span class="c1">############################################################################################################</span>
</span><span id="Graphing-956"><a href="#Graphing-956"><span class="linenos"> 956</span></a>
</span><span id="Graphing-957"><a href="#Graphing-957"><span class="linenos"> 957</span></a>    <span class="k">def</span> <span class="nf">get_scatterplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing-958"><a href="#Graphing-958"><span class="linenos"> 958</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing-959"><a href="#Graphing-959"><span class="linenos"> 959</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-960"><a href="#Graphing-960"><span class="linenos"> 960</span></a><span class="sd">        Generates a scatterplot for selected commute (or provided) data.</span>
</span><span id="Graphing-961"><a href="#Graphing-961"><span class="linenos"> 961</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-962"><a href="#Graphing-962"><span class="linenos"> 962</span></a>
</span><span id="Graphing-963"><a href="#Graphing-963"><span class="linenos"> 963</span></a>
</span><span id="Graphing-964"><a href="#Graphing-964"><span class="linenos"> 964</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing-965"><a href="#Graphing-965"><span class="linenos"> 965</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing-966"><a href="#Graphing-966"><span class="linenos"> 966</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-967"><a href="#Graphing-967"><span class="linenos"> 967</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing-968"><a href="#Graphing-968"><span class="linenos"> 968</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing-969"><a href="#Graphing-969"><span class="linenos"> 969</span></a>
</span><span id="Graphing-970"><a href="#Graphing-970"><span class="linenos"> 970</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing-971"><a href="#Graphing-971"><span class="linenos"> 971</span></a>        
</span><span id="Graphing-972"><a href="#Graphing-972"><span class="linenos"> 972</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-973"><a href="#Graphing-973"><span class="linenos"> 973</span></a>            <span class="n">x_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_value</span><span class="p">]</span>
</span><span id="Graphing-974"><a href="#Graphing-974"><span class="linenos"> 974</span></a>
</span><span id="Graphing-975"><a href="#Graphing-975"><span class="linenos"> 975</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-976"><a href="#Graphing-976"><span class="linenos"> 976</span></a>            <span class="n">y_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_value</span><span class="p">]</span>
</span><span id="Graphing-977"><a href="#Graphing-977"><span class="linenos"> 977</span></a>
</span><span id="Graphing-978"><a href="#Graphing-978"><span class="linenos"> 978</span></a>        
</span><span id="Graphing-979"><a href="#Graphing-979"><span class="linenos"> 979</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-980"><a href="#Graphing-980"><span class="linenos"> 980</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="Graphing-981"><a href="#Graphing-981"><span class="linenos"> 981</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-982"><a href="#Graphing-982"><span class="linenos"> 982</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span> <span class="o">+</span> <span class="n">y_value</span><span class="p">)</span>
</span><span id="Graphing-983"><a href="#Graphing-983"><span class="linenos"> 983</span></a>        
</span><span id="Graphing-984"><a href="#Graphing-984"><span class="linenos"> 984</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="Graphing-985"><a href="#Graphing-985"><span class="linenos"> 985</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing-986"><a href="#Graphing-986"><span class="linenos"> 986</span></a>        
</span><span id="Graphing-987"><a href="#Graphing-987"><span class="linenos"> 987</span></a>        <span class="c1"># set x label </span>
</span><span id="Graphing-988"><a href="#Graphing-988"><span class="linenos"> 988</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-989"><a href="#Graphing-989"><span class="linenos"> 989</span></a>        <span class="c1"># set title</span>
</span><span id="Graphing-990"><a href="#Graphing-990"><span class="linenos"> 990</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-991"><a href="#Graphing-991"><span class="linenos"> 991</span></a>        <span class="c1"># set y axis </span>
</span><span id="Graphing-992"><a href="#Graphing-992"><span class="linenos"> 992</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-993"><a href="#Graphing-993"><span class="linenos"> 993</span></a>        
</span><span id="Graphing-994"><a href="#Graphing-994"><span class="linenos"> 994</span></a>        <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing-995"><a href="#Graphing-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-996"><a href="#Graphing-996"><span class="linenos"> 996</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-997"><a href="#Graphing-997"><span class="linenos"> 997</span></a>
</span><span id="Graphing-998"><a href="#Graphing-998"><span class="linenos"> 998</span></a>        <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing-999"><a href="#Graphing-999"><span class="linenos"> 999</span></a>        <span class="c1">#axf(r,c).hist(xyz[values[i]], bins=bins, alpha=0.5, edgecolor=&#39;gray&#39;, linewidth=1, zorder=2, align=&#39;mid&#39;, rwidth=0.8)</span>
</span><span id="Graphing-1000"><a href="#Graphing-1000"><span class="linenos">1000</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">x_value</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">y_value</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="Graphing-1001"><a href="#Graphing-1001"><span class="linenos">1001</span></a>
</span><span id="Graphing-1002"><a href="#Graphing-1002"><span class="linenos">1002</span></a>        <span class="c1"># set the xticks and yticks font size</span>
</span><span id="Graphing-1003"><a href="#Graphing-1003"><span class="linenos">1003</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-1004"><a href="#Graphing-1004"><span class="linenos">1004</span></a>            
</span><span id="Graphing-1005"><a href="#Graphing-1005"><span class="linenos">1005</span></a>        
</span><span id="Graphing-1006"><a href="#Graphing-1006"><span class="linenos">1006</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing-1007"><a href="#Graphing-1007"><span class="linenos">1007</span></a>            
</span><span id="Graphing-1008"><a href="#Graphing-1008"><span class="linenos">1008</span></a>    <span class="k">def</span> <span class="nf">get_piechart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_labels</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing-1009"><a href="#Graphing-1009"><span class="linenos">1009</span></a>                     <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Graphing-1010"><a href="#Graphing-1010"><span class="linenos">1010</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing-1011"><a href="#Graphing-1011"><span class="linenos">1011</span></a><span class="sd">        Generates a pie chart or charts for selected commute data.</span>
</span><span id="Graphing-1012"><a href="#Graphing-1012"><span class="linenos">1012</span></a>
</span><span id="Graphing-1013"><a href="#Graphing-1013"><span class="linenos">1013</span></a><span class="sd">        Args:</span>
</span><span id="Graphing-1014"><a href="#Graphing-1014"><span class="linenos">1014</span></a><span class="sd">            values (str or list): Names of the columns in `commute_data` representing the metrics to visualize in the pie chart(s).</span>
</span><span id="Graphing-1015"><a href="#Graphing-1015"><span class="linenos">1015</span></a><span class="sd">            title (str, optional): Title for the pie chart(s). Defaults to None.</span>
</span><span id="Graphing-1016"><a href="#Graphing-1016"><span class="linenos">1016</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="Graphing-1017"><a href="#Graphing-1017"><span class="linenos">1017</span></a><span class="sd">            value_labels (str or list, optional): Labels for the values in the pie chart(s). Defaults to &#39;&#39;.</span>
</span><span id="Graphing-1018"><a href="#Graphing-1018"><span class="linenos">1018</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to None.</span>
</span><span id="Graphing-1019"><a href="#Graphing-1019"><span class="linenos">1019</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing-1020"><a href="#Graphing-1020"><span class="linenos">1020</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing-1021"><a href="#Graphing-1021"><span class="linenos">1021</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing-1022"><a href="#Graphing-1022"><span class="linenos">1022</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing-1023"><a href="#Graphing-1023"><span class="linenos">1023</span></a><span class="sd">            startangle (int, optional): Starting angle for the pie chart. Defaults to 90.</span>
</span><span id="Graphing-1024"><a href="#Graphing-1024"><span class="linenos">1024</span></a><span class="sd">            colors (list, optional): List of colors for the pie chart. For multi-row/col, list of lists. Defaults to None.</span>
</span><span id="Graphing-1025"><a href="#Graphing-1025"><span class="linenos">1025</span></a>
</span><span id="Graphing-1026"><a href="#Graphing-1026"><span class="linenos">1026</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing-1027"><a href="#Graphing-1027"><span class="linenos">1027</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing-1028"><a href="#Graphing-1028"><span class="linenos">1028</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing-1029"><a href="#Graphing-1029"><span class="linenos">1029</span></a>        <span class="c1"># basic preamble</span>
</span><span id="Graphing-1030"><a href="#Graphing-1030"><span class="linenos">1030</span></a>        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-1031"><a href="#Graphing-1031"><span class="linenos">1031</span></a>            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>
</span><span id="Graphing-1032"><a href="#Graphing-1032"><span class="linenos">1032</span></a>            
</span><span id="Graphing-1033"><a href="#Graphing-1033"><span class="linenos">1033</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing-1034"><a href="#Graphing-1034"><span class="linenos">1034</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-1035"><a href="#Graphing-1035"><span class="linenos">1035</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing-1036"><a href="#Graphing-1036"><span class="linenos">1036</span></a>        
</span><span id="Graphing-1037"><a href="#Graphing-1037"><span class="linenos">1037</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_labels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-1038"><a href="#Graphing-1038"><span class="linenos">1038</span></a>            <span class="n">value_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">value_labels</span><span class="p">]</span>
</span><span id="Graphing-1039"><a href="#Graphing-1039"><span class="linenos">1039</span></a>
</span><span id="Graphing-1040"><a href="#Graphing-1040"><span class="linenos">1040</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing-1041"><a href="#Graphing-1041"><span class="linenos">1041</span></a>            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">titles</span><span class="p">]</span>
</span><span id="Graphing-1042"><a href="#Graphing-1042"><span class="linenos">1042</span></a>
</span><span id="Graphing-1043"><a href="#Graphing-1043"><span class="linenos">1043</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="Graphing-1044"><a href="#Graphing-1044"><span class="linenos">1044</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing-1045"><a href="#Graphing-1045"><span class="linenos">1045</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-1046"><a href="#Graphing-1046"><span class="linenos">1046</span></a>        
</span><span id="Graphing-1047"><a href="#Graphing-1047"><span class="linenos">1047</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing-1048"><a href="#Graphing-1048"><span class="linenos">1048</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing-1049"><a href="#Graphing-1049"><span class="linenos">1049</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="Graphing-1050"><a href="#Graphing-1050"><span class="linenos">1050</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="Graphing-1051"><a href="#Graphing-1051"><span class="linenos">1051</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="Graphing-1052"><a href="#Graphing-1052"><span class="linenos">1052</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-1053"><a href="#Graphing-1053"><span class="linenos">1053</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="Graphing-1054"><a href="#Graphing-1054"><span class="linenos">1054</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="Graphing-1055"><a href="#Graphing-1055"><span class="linenos">1055</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-1056"><a href="#Graphing-1056"><span class="linenos">1056</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing-1057"><a href="#Graphing-1057"><span class="linenos">1057</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="Graphing-1058"><a href="#Graphing-1058"><span class="linenos">1058</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-1059"><a href="#Graphing-1059"><span class="linenos">1059</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="Graphing-1060"><a href="#Graphing-1060"><span class="linenos">1060</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="Graphing-1061"><a href="#Graphing-1061"><span class="linenos">1061</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-1062"><a href="#Graphing-1062"><span class="linenos">1062</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing-1063"><a href="#Graphing-1063"><span class="linenos">1063</span></a>
</span><span id="Graphing-1064"><a href="#Graphing-1064"><span class="linenos">1064</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing-1065"><a href="#Graphing-1065"><span class="linenos">1065</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing-1066"><a href="#Graphing-1066"><span class="linenos">1066</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing-1067"><a href="#Graphing-1067"><span class="linenos">1067</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing-1068"><a href="#Graphing-1068"><span class="linenos">1068</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-1069"><a href="#Graphing-1069"><span class="linenos">1069</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing-1070"><a href="#Graphing-1070"><span class="linenos">1070</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing-1071"><a href="#Graphing-1071"><span class="linenos">1071</span></a>            <span class="c1"># set title </span>
</span><span id="Graphing-1072"><a href="#Graphing-1072"><span class="linenos">1072</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing-1073"><a href="#Graphing-1073"><span class="linenos">1073</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing-1074"><a href="#Graphing-1074"><span class="linenos">1074</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing-1075"><a href="#Graphing-1075"><span class="linenos">1075</span></a>                <span class="k">continue</span>
</span><span id="Graphing-1076"><a href="#Graphing-1076"><span class="linenos">1076</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing-1077"><a href="#Graphing-1077"><span class="linenos">1077</span></a>            <span class="n">textprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">}</span>
</span><span id="Graphing-1078"><a href="#Graphing-1078"><span class="linenos">1078</span></a>            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing-1079"><a href="#Graphing-1079"><span class="linenos">1079</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="Graphing-1080"><a href="#Graphing-1080"><span class="linenos">1080</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing-1081"><a href="#Graphing-1081"><span class="linenos">1081</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="Graphing-1082"><a href="#Graphing-1082"><span class="linenos">1082</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>  <span class="c1"># Equal aspect ratio ensures that pie is drawn as a circle</span>
</span><span id="Graphing-1083"><a href="#Graphing-1083"><span class="linenos">1083</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</span><span id="Graphing-1084"><a href="#Graphing-1084"><span class="linenos">1084</span></a>
</span><span id="Graphing-1085"><a href="#Graphing-1085"><span class="linenos">1085</span></a>
</span><span id="Graphing-1086"><a href="#Graphing-1086"><span class="linenos">1086</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


    

                            <div id="Graphing.__init__" class="classattr">
                                        <input id="Graphing.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Graphing</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Graphing.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.__init__-39"><a href="#Graphing.__init__-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Graphing.__init__-40"><a href="#Graphing.__init__-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.__init__-41"><a href="#Graphing.__init__-41"><span class="linenos">41</span></a><span class="sd">        Initializes the Graphing class instance.</span>
</span><span id="Graphing.__init__-42"><a href="#Graphing.__init__-42"><span class="linenos">42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.__init__-43"><a href="#Graphing.__init__-43"><span class="linenos">43</span></a>        <span class="k">pass</span>  
</span></pre></div>


            <div class="docstring"><p>Initializes the Graphing class instance.</p>
</div>


                            </div>
                            <div id="Graphing.configure_map_plot" class="classattr">
                                        <input id="Graphing.configure_map_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">configure_map_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">latitudes</span>, </span><span class="param"><span class="n">longitudes</span>, </span><span class="param"><span class="n">imagery</span><span class="o">=</span><span class="s1">&#39;OSM&#39;</span>, </span><span class="param"><span class="n">padding</span><span class="o">=</span><span class="mf">0.03</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.configure_map_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.configure_map_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.configure_map_plot-45"><a href="#Graphing.configure_map_plot-45"><span class="linenos">45</span></a>    <span class="k">def</span> <span class="nf">configure_map_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
</span><span id="Graphing.configure_map_plot-46"><a href="#Graphing.configure_map_plot-46"><span class="linenos">46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.configure_map_plot-47"><a href="#Graphing.configure_map_plot-47"><span class="linenos">47</span></a><span class="sd">        Configures a map plot with specified latitudes and longitudes and an optional background imagery source.</span>
</span><span id="Graphing.configure_map_plot-48"><a href="#Graphing.configure_map_plot-48"><span class="linenos">48</span></a>
</span><span id="Graphing.configure_map_plot-49"><a href="#Graphing.configure_map_plot-49"><span class="linenos">49</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.configure_map_plot-50"><a href="#Graphing.configure_map_plot-50"><span class="linenos">50</span></a><span class="sd">            latitudes (list): A list of latitude coordinates for plotting.</span>
</span><span id="Graphing.configure_map_plot-51"><a href="#Graphing.configure_map_plot-51"><span class="linenos">51</span></a><span class="sd">            longitudes (list): A list of longitude coordinates for plotting.</span>
</span><span id="Graphing.configure_map_plot-52"><a href="#Graphing.configure_map_plot-52"><span class="linenos">52</span></a><span class="sd">            imagery (str, optional): The background imagery source. Options include &quot;OSM&quot; (default), &quot;Google&quot;, and &quot;GoogleSatellite&quot;.</span>
</span><span id="Graphing.configure_map_plot-53"><a href="#Graphing.configure_map_plot-53"><span class="linenos">53</span></a><span class="sd">            padding (float, optional): Padding around the coordinate extents to ensure all points are visible on the map.</span>
</span><span id="Graphing.configure_map_plot-54"><a href="#Graphing.configure_map_plot-54"><span class="linenos">54</span></a>
</span><span id="Graphing.configure_map_plot-55"><a href="#Graphing.configure_map_plot-55"><span class="linenos">55</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.configure_map_plot-56"><a href="#Graphing.configure_map_plot-56"><span class="linenos">56</span></a><span class="sd">            tuple: A tuple containing the figure and axis objects of the map plot.</span>
</span><span id="Graphing.configure_map_plot-57"><a href="#Graphing.configure_map_plot-57"><span class="linenos">57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.configure_map_plot-58"><a href="#Graphing.configure_map_plot-58"><span class="linenos">58</span></a>        <span class="c1"># configure the map plot</span>
</span><span id="Graphing.configure_map_plot-59"><a href="#Graphing.configure_map_plot-59"><span class="linenos">59</span></a>        <span class="k">if</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;OSM&quot;</span><span class="p">:</span>
</span><span id="Graphing.configure_map_plot-60"><a href="#Graphing.configure_map_plot-60"><span class="linenos">60</span></a>            <span class="c1"># use OpenStreetMap as the background map</span>
</span><span id="Graphing.configure_map_plot-61"><a href="#Graphing.configure_map_plot-61"><span class="linenos">61</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="Graphing.configure_map_plot-62"><a href="#Graphing.configure_map_plot-62"><span class="linenos">62</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;Google&quot;</span><span class="p">:</span>
</span><span id="Graphing.configure_map_plot-63"><a href="#Graphing.configure_map_plot-63"><span class="linenos">63</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="Graphing.configure_map_plot-64"><a href="#Graphing.configure_map_plot-64"><span class="linenos">64</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">()</span>
</span><span id="Graphing.configure_map_plot-65"><a href="#Graphing.configure_map_plot-65"><span class="linenos">65</span></a>        <span class="k">elif</span> <span class="n">imagery</span> <span class="o">==</span> <span class="s2">&quot;GoogleSatellite&quot;</span><span class="p">:</span>
</span><span id="Graphing.configure_map_plot-66"><a href="#Graphing.configure_map_plot-66"><span class="linenos">66</span></a>            <span class="c1"># alternatively, use GoogleTiles() for a satellite map</span>
</span><span id="Graphing.configure_map_plot-67"><a href="#Graphing.configure_map_plot-67"><span class="linenos">67</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;satellite&#39;</span><span class="p">)</span>
</span><span id="Graphing.configure_map_plot-68"><a href="#Graphing.configure_map_plot-68"><span class="linenos">68</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.configure_map_plot-69"><a href="#Graphing.configure_map_plot-69"><span class="linenos">69</span></a>            <span class="n">imagery</span> <span class="o">=</span> <span class="n">OSM</span><span class="p">()</span>
</span><span id="Graphing.configure_map_plot-70"><a href="#Graphing.configure_map_plot-70"><span class="linenos">70</span></a>
</span><span id="Graphing.configure_map_plot-71"><a href="#Graphing.configure_map_plot-71"><span class="linenos">71</span></a>        <span class="c1"># set figure size for readability</span>
</span><span id="Graphing.configure_map_plot-72"><a href="#Graphing.configure_map_plot-72"><span class="linenos">72</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">imagery</span><span class="o">.</span><span class="n">crs</span><span class="p">})</span>
</span><span id="Graphing.configure_map_plot-73"><a href="#Graphing.configure_map_plot-73"><span class="linenos">73</span></a>        
</span><span id="Graphing.configure_map_plot-74"><a href="#Graphing.configure_map_plot-74"><span class="linenos">74</span></a>        <span class="c1"># set the extent of the map to include all the points plus a little extra</span>
</span><span id="Graphing.configure_map_plot-75"><a href="#Graphing.configure_map_plot-75"><span class="linenos">75</span></a>        <span class="n">lat_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="Graphing.configure_map_plot-76"><a href="#Graphing.configure_map_plot-76"><span class="linenos">76</span></a>        <span class="n">long_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">))</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span>
</span><span id="Graphing.configure_map_plot-77"><a href="#Graphing.configure_map_plot-77"><span class="linenos">77</span></a>        <span class="n">min_max</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">-</span><span class="n">long_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">longitudes</span><span class="p">)</span><span class="o">+</span><span class="n">long_delta</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">-</span><span class="n">lat_delta</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span><span class="o">+</span><span class="n">lat_delta</span><span class="p">]</span>
</span><span id="Graphing.configure_map_plot-78"><a href="#Graphing.configure_map_plot-78"><span class="linenos">78</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">min_max</span><span class="p">)</span>
</span><span id="Graphing.configure_map_plot-79"><a href="#Graphing.configure_map_plot-79"><span class="linenos">79</span></a>
</span><span id="Graphing.configure_map_plot-80"><a href="#Graphing.configure_map_plot-80"><span class="linenos">80</span></a>        <span class="c1"># Add the imagery to the map at an automatically-chosen zoom level</span>
</span><span id="Graphing.configure_map_plot-81"><a href="#Graphing.configure_map_plot-81"><span class="linenos">81</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">imagery</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_zoom_level</span><span class="p">(</span><span class="n">ax</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</span><span id="Graphing.configure_map_plot-82"><a href="#Graphing.configure_map_plot-82"><span class="linenos">82</span></a>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Configures a map plot with specified latitudes and longitudes and an optional background imagery source.</p>

<p>Args:
    latitudes (list): A list of latitude coordinates for plotting.
    longitudes (list): A list of longitude coordinates for plotting.
    imagery (str, optional): The background imagery source. Options include "OSM" (default), "Google", and "GoogleSatellite".
    padding (float, optional): Padding around the coordinate extents to ensure all points are visible on the map.</p>

<p>Returns:
    tuple: A tuple containing the figure and axis objects of the map plot.</p>
</div>


                            </div>
                            <div id="Graphing.plot_addresses" class="classattr">
                                        <input id="Graphing.plot_addresses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_addresses</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ax</span>,</span><span class="param">	<span class="n">data</span>,</span><span class="param">	<span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">s</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_addresses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_addresses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_addresses-84"><a href="#Graphing.plot_addresses-84"><span class="linenos">84</span></a>    <span class="k">def</span> <span class="nf">plot_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">):</span>
</span><span id="Graphing.plot_addresses-85"><a href="#Graphing.plot_addresses-85"><span class="linenos">85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_addresses-86"><a href="#Graphing.plot_addresses-86"><span class="linenos">86</span></a><span class="sd">        Plots address points on the map.</span>
</span><span id="Graphing.plot_addresses-87"><a href="#Graphing.plot_addresses-87"><span class="linenos">87</span></a>
</span><span id="Graphing.plot_addresses-88"><a href="#Graphing.plot_addresses-88"><span class="linenos">88</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_addresses-89"><a href="#Graphing.plot_addresses-89"><span class="linenos">89</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="Graphing.plot_addresses-90"><a href="#Graphing.plot_addresses-90"><span class="linenos">90</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="Graphing.plot_addresses-91"><a href="#Graphing.plot_addresses-91"><span class="linenos">91</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing.plot_addresses-92"><a href="#Graphing.plot_addresses-92"><span class="linenos">92</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="Graphing.plot_addresses-93"><a href="#Graphing.plot_addresses-93"><span class="linenos">93</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 10.</span>
</span><span id="Graphing.plot_addresses-94"><a href="#Graphing.plot_addresses-94"><span class="linenos">94</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="Graphing.plot_addresses-95"><a href="#Graphing.plot_addresses-95"><span class="linenos">95</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="Graphing.plot_addresses-96"><a href="#Graphing.plot_addresses-96"><span class="linenos">96</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;o&#39; (circle).</span>
</span><span id="Graphing.plot_addresses-97"><a href="#Graphing.plot_addresses-97"><span class="linenos">97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_addresses-98"><a href="#Graphing.plot_addresses-98"><span class="linenos">98</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing.plot_addresses-99"><a href="#Graphing.plot_addresses-99"><span class="linenos">99</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots address points on the map.</p>

<p>Args:
    ax: The matplotlib axes object on which to plot.
    data (DataFrame): The data containing 'latitude' and 'longitude' columns for the points to plot.
    color (str, optional): The color of the points. Defaults to 'red'.
    label (str, optional): Label for the points. Defaults to None.
    s (int, optional): Size of the points. Defaults to 10.
    alpha (float, optional): Transparency of the points. Defaults to 1.0.
    linestyle (str, optional): Style of the point lines. Defaults to '' (solid).
    marker (str, optional): Shape of the points. Defaults to 'o' (circle).</p>
</div>


                            </div>
                            <div id="Graphing.plot_offices" class="classattr">
                                        <input id="Graphing.plot_offices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_offices</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ax</span>,</span><span class="param">	<span class="n">data</span>,</span><span class="param">	<span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">s</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_offices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_offices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_offices-101"><a href="#Graphing.plot_offices-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="nf">plot_offices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
</span><span id="Graphing.plot_offices-102"><a href="#Graphing.plot_offices-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_offices-103"><a href="#Graphing.plot_offices-103"><span class="linenos">103</span></a><span class="sd">        Plots office location points on the map.</span>
</span><span id="Graphing.plot_offices-104"><a href="#Graphing.plot_offices-104"><span class="linenos">104</span></a>
</span><span id="Graphing.plot_offices-105"><a href="#Graphing.plot_offices-105"><span class="linenos">105</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_offices-106"><a href="#Graphing.plot_offices-106"><span class="linenos">106</span></a><span class="sd">            ax: The matplotlib axes object on which to plot.</span>
</span><span id="Graphing.plot_offices-107"><a href="#Graphing.plot_offices-107"><span class="linenos">107</span></a><span class="sd">            data (DataFrame): The data containing &#39;latitude&#39; and &#39;longitude&#39; columns for the points to plot.</span>
</span><span id="Graphing.plot_offices-108"><a href="#Graphing.plot_offices-108"><span class="linenos">108</span></a><span class="sd">            color (str, optional): The color of the points. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.plot_offices-109"><a href="#Graphing.plot_offices-109"><span class="linenos">109</span></a><span class="sd">            label (str, optional): Label for the points. Defaults to None.</span>
</span><span id="Graphing.plot_offices-110"><a href="#Graphing.plot_offices-110"><span class="linenos">110</span></a><span class="sd">            s (int, optional): Size of the points. Defaults to 100.</span>
</span><span id="Graphing.plot_offices-111"><a href="#Graphing.plot_offices-111"><span class="linenos">111</span></a><span class="sd">            alpha (float, optional): Transparency of the points. Defaults to 1.0.</span>
</span><span id="Graphing.plot_offices-112"><a href="#Graphing.plot_offices-112"><span class="linenos">112</span></a><span class="sd">            linestyle (str, optional): Style of the point lines. Defaults to &#39;&#39; (solid).</span>
</span><span id="Graphing.plot_offices-113"><a href="#Graphing.plot_offices-113"><span class="linenos">113</span></a><span class="sd">            marker (str, optional): Shape of the points. Defaults to &#39;*&#39; (star).</span>
</span><span id="Graphing.plot_offices-114"><a href="#Graphing.plot_offices-114"><span class="linenos">114</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_offices-115"><a href="#Graphing.plot_offices-115"><span class="linenos">115</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing.plot_offices-116"><a href="#Graphing.plot_offices-116"><span class="linenos">116</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots office location points on the map.</p>

<p>Args:
    ax: The matplotlib axes object on which to plot.
    data (DataFrame): The data containing 'latitude' and 'longitude' columns for the points to plot.
    color (str, optional): The color of the points. Defaults to 'black'.
    label (str, optional): Label for the points. Defaults to None.
    s (int, optional): Size of the points. Defaults to 100.
    alpha (float, optional): Transparency of the points. Defaults to 1.0.
    linestyle (str, optional): Style of the point lines. Defaults to '' (solid).
    marker (str, optional): Shape of the points. Defaults to '*' (star).</p>
</div>


                            </div>
                            <div id="Graphing.add_scalebar" class="classattr">
                                        <input id="Graphing.add_scalebar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_scalebar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span>, </span><span class="param"><span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>, </span><span class="param"><span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.add_scalebar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.add_scalebar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.add_scalebar-118"><a href="#Graphing.add_scalebar-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">add_scalebar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing.add_scalebar-119"><a href="#Graphing.add_scalebar-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.add_scalebar-120"><a href="#Graphing.add_scalebar-120"><span class="linenos">120</span></a><span class="sd">        Adds a scale bar to the map plot.</span>
</span><span id="Graphing.add_scalebar-121"><a href="#Graphing.add_scalebar-121"><span class="linenos">121</span></a>
</span><span id="Graphing.add_scalebar-122"><a href="#Graphing.add_scalebar-122"><span class="linenos">122</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.add_scalebar-123"><a href="#Graphing.add_scalebar-123"><span class="linenos">123</span></a><span class="sd">            ax: The matplotlib axes object to add the scale bar to.</span>
</span><span id="Graphing.add_scalebar-124"><a href="#Graphing.add_scalebar-124"><span class="linenos">124</span></a><span class="sd">            location (tuple, optional): A tuple (x, y) representing the location of the scale bar as a fraction of the axis dimensions. </span>
</span><span id="Graphing.add_scalebar-125"><a href="#Graphing.add_scalebar-125"><span class="linenos">125</span></a><span class="sd">            Defaults to (0.05, 0.05).</span>
</span><span id="Graphing.add_scalebar-126"><a href="#Graphing.add_scalebar-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.add_scalebar-127"><a href="#Graphing.add_scalebar-127"><span class="linenos">127</span></a>
</span><span id="Graphing.add_scalebar-128"><a href="#Graphing.add_scalebar-128"><span class="linenos">128</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing.add_scalebar-129"><a href="#Graphing.add_scalebar-129"><span class="linenos">129</span></a>        <span class="c1"># first get the extent of the map</span>
</span><span id="Graphing.add_scalebar-130"><a href="#Graphing.add_scalebar-130"><span class="linenos">130</span></a>        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing.add_scalebar-131"><a href="#Graphing.add_scalebar-131"><span class="linenos">131</span></a>        
</span><span id="Graphing.add_scalebar-132"><a href="#Graphing.add_scalebar-132"><span class="linenos">132</span></a>        <span class="c1"># calculate the width of the x axis in miles</span>
</span><span id="Graphing.add_scalebar-133"><a href="#Graphing.add_scalebar-133"><span class="linenos">133</span></a>        <span class="n">xd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-134"><a href="#Graphing.add_scalebar-134"><span class="linenos">134</span></a>        <span class="n">yd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-135"><a href="#Graphing.add_scalebar-135"><span class="linenos">135</span></a>        
</span><span id="Graphing.add_scalebar-136"><a href="#Graphing.add_scalebar-136"><span class="linenos">136</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="n">xd</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-137"><a href="#Graphing.add_scalebar-137"><span class="linenos">137</span></a>        <span class="n">bar</span> <span class="o">=</span> <span class="n">order</span><span class="o">/</span><span class="mf">4.0</span>
</span><span id="Graphing.add_scalebar-138"><a href="#Graphing.add_scalebar-138"><span class="linenos">138</span></a>        
</span><span id="Graphing.add_scalebar-139"><a href="#Graphing.add_scalebar-139"><span class="linenos">139</span></a>        <span class="n">np</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-140"><a href="#Graphing.add_scalebar-140"><span class="linenos">140</span></a>        <span class="c1"># now we create a tuple of long/lats for the scalebar</span>
</span><span id="Graphing.add_scalebar-141"><a href="#Graphing.add_scalebar-141"><span class="linenos">141</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">])</span>
</span><span id="Graphing.add_scalebar-142"><a href="#Graphing.add_scalebar-142"><span class="linenos">142</span></a>        <span class="c1"># now, adjust the coordinates of the scalebar for proper chart placement, up location[0]% and right location[1]%</span>
</span><span id="Graphing.add_scalebar-143"><a href="#Graphing.add_scalebar-143"><span class="linenos">143</span></a>        <span class="n">scalebar</span> <span class="o">=</span> <span class="p">([</span><span class="n">x0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="Graphing.add_scalebar-144"><a href="#Graphing.add_scalebar-144"><span class="linenos">144</span></a>        <span class="c1"># now we create end bars for the scale bar using scalebar as the source coordinates.</span>
</span><span id="Graphing.add_scalebar-145"><a href="#Graphing.add_scalebar-145"><span class="linenos">145</span></a>        <span class="c1"># end bars are positioned one at each end of the scalebar, centered vertically on the scalebar, and total height being 2% of y axis</span>
</span><span id="Graphing.add_scalebar-146"><a href="#Graphing.add_scalebar-146"><span class="linenos">146</span></a>        <span class="n">scalebar_end</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="Graphing.add_scalebar-147"><a href="#Graphing.add_scalebar-147"><span class="linenos">147</span></a>        <span class="n">scalebar_end2</span> <span class="o">=</span> <span class="p">([</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">])</span>
</span><span id="Graphing.add_scalebar-148"><a href="#Graphing.add_scalebar-148"><span class="linenos">148</span></a>        <span class="c1"># now we put a text label on the scale bar indicating the number of miles shown (bar).  Center the lable on the scalebar</span>
</span><span id="Graphing.add_scalebar-149"><a href="#Graphing.add_scalebar-149"><span class="linenos">149</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles&#39;</span><span class="p">,</span> 
</span><span id="Graphing.add_scalebar-150"><a href="#Graphing.add_scalebar-150"><span class="linenos">150</span></a>                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-151"><a href="#Graphing.add_scalebar-151"><span class="linenos">151</span></a>
</span><span id="Graphing.add_scalebar-152"><a href="#Graphing.add_scalebar-152"><span class="linenos">152</span></a>        <span class="c1"># draw a scale bar</span>
</span><span id="Graphing.add_scalebar-153"><a href="#Graphing.add_scalebar-153"><span class="linenos">153</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-154"><a href="#Graphing.add_scalebar-154"><span class="linenos">154</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Graphing.add_scalebar-155"><a href="#Graphing.add_scalebar-155"><span class="linenos">155</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scalebar_end2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds a scale bar to the map plot.</p>

<p>Args:
    ax: The matplotlib axes object to add the scale bar to.
    location (tuple, optional): A tuple (x, y) representing the location of the scale bar as a fraction of the axis dimensions. 
    Defaults to (0.05, 0.05).</p>
</div>


                            </div>
                            <div id="Graphing.round_to_nearest_order_of_magnitude" class="classattr">
                                        <input id="Graphing.round_to_nearest_order_of_magnitude-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">round_to_nearest_order_of_magnitude</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">number</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.round_to_nearest_order_of_magnitude-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.round_to_nearest_order_of_magnitude"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.round_to_nearest_order_of_magnitude-157"><a href="#Graphing.round_to_nearest_order_of_magnitude-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">round_to_nearest_order_of_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">number</span><span class="p">):</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-158"><a href="#Graphing.round_to_nearest_order_of_magnitude-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-159"><a href="#Graphing.round_to_nearest_order_of_magnitude-159"><span class="linenos">159</span></a><span class="sd">        Rounds a number to the nearest order of magnitude.</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-160"><a href="#Graphing.round_to_nearest_order_of_magnitude-160"><span class="linenos">160</span></a>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-161"><a href="#Graphing.round_to_nearest_order_of_magnitude-161"><span class="linenos">161</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-162"><a href="#Graphing.round_to_nearest_order_of_magnitude-162"><span class="linenos">162</span></a><span class="sd">            number (float): The number to round.</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-163"><a href="#Graphing.round_to_nearest_order_of_magnitude-163"><span class="linenos">163</span></a>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-164"><a href="#Graphing.round_to_nearest_order_of_magnitude-164"><span class="linenos">164</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-165"><a href="#Graphing.round_to_nearest_order_of_magnitude-165"><span class="linenos">165</span></a><span class="sd">            float: The rounded number.</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-166"><a href="#Graphing.round_to_nearest_order_of_magnitude-166"><span class="linenos">166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-167"><a href="#Graphing.round_to_nearest_order_of_magnitude-167"><span class="linenos">167</span></a>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-168"><a href="#Graphing.round_to_nearest_order_of_magnitude-168"><span class="linenos">168</span></a>        <span class="c1"># Calculate the order of magnitude of the number</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-169"><a href="#Graphing.round_to_nearest_order_of_magnitude-169"><span class="linenos">169</span></a>        <span class="n">order_of_magnitude</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)))</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-170"><a href="#Graphing.round_to_nearest_order_of_magnitude-170"><span class="linenos">170</span></a>        <span class="c1"># Normalize the number to a value between 1 and 10 and round it</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-171"><a href="#Graphing.round_to_nearest_order_of_magnitude-171"><span class="linenos">171</span></a>        <span class="n">rounded_normalized_number</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span> <span class="o">/</span> <span class="n">order_of_magnitude</span><span class="p">)</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-172"><a href="#Graphing.round_to_nearest_order_of_magnitude-172"><span class="linenos">172</span></a>        <span class="c1"># Multiply back by the order of magnitude to get the rounded number</span>
</span><span id="Graphing.round_to_nearest_order_of_magnitude-173"><a href="#Graphing.round_to_nearest_order_of_magnitude-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="n">rounded_normalized_number</span> <span class="o">*</span> <span class="n">order_of_magnitude</span>
</span></pre></div>


            <div class="docstring"><p>Rounds a number to the nearest order of magnitude.</p>

<p>Args:
    number (float): The number to round.</p>

<p>Returns:
    float: The rounded number.</p>
</div>


                            </div>
                            <div id="Graphing.calculate_zoom_level" class="classattr">
                                        <input id="Graphing.calculate_zoom_level-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_zoom_level</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span>, </span><span class="param"><span class="n">tile_service_resolution</span><span class="o">=</span><span class="mi">256</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.calculate_zoom_level-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.calculate_zoom_level"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.calculate_zoom_level-175"><a href="#Graphing.calculate_zoom_level-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">calculate_zoom_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">tile_service_resolution</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
</span><span id="Graphing.calculate_zoom_level-176"><a href="#Graphing.calculate_zoom_level-176"><span class="linenos">176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.calculate_zoom_level-177"><a href="#Graphing.calculate_zoom_level-177"><span class="linenos">177</span></a><span class="sd">        Calculate an appropriate zoom level for a Cartopy axis based on its extent.</span>
</span><span id="Graphing.calculate_zoom_level-178"><a href="#Graphing.calculate_zoom_level-178"><span class="linenos">178</span></a><span class="sd">        </span>
</span><span id="Graphing.calculate_zoom_level-179"><a href="#Graphing.calculate_zoom_level-179"><span class="linenos">179</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.calculate_zoom_level-180"><a href="#Graphing.calculate_zoom_level-180"><span class="linenos">180</span></a><span class="sd">        - ax: The Cartopy GeoAxes object.</span>
</span><span id="Graphing.calculate_zoom_level-181"><a href="#Graphing.calculate_zoom_level-181"><span class="linenos">181</span></a><span class="sd">        - tile_service_resolution: The resolution of the tile service (256 for most web services).</span>
</span><span id="Graphing.calculate_zoom_level-182"><a href="#Graphing.calculate_zoom_level-182"><span class="linenos">182</span></a><span class="sd">        </span>
</span><span id="Graphing.calculate_zoom_level-183"><a href="#Graphing.calculate_zoom_level-183"><span class="linenos">183</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.calculate_zoom_level-184"><a href="#Graphing.calculate_zoom_level-184"><span class="linenos">184</span></a><span class="sd">        - An integer zoom level.</span>
</span><span id="Graphing.calculate_zoom_level-185"><a href="#Graphing.calculate_zoom_level-185"><span class="linenos">185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.calculate_zoom_level-186"><a href="#Graphing.calculate_zoom_level-186"><span class="linenos">186</span></a>        <span class="c1"># Get the extent of the axis and calculate the width in degrees</span>
</span><span id="Graphing.calculate_zoom_level-187"><a href="#Graphing.calculate_zoom_level-187"><span class="linenos">187</span></a>        <span class="n">extent</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing.calculate_zoom_level-188"><a href="#Graphing.calculate_zoom_level-188"><span class="linenos">188</span></a>        <span class="n">width_deg</span> <span class="o">=</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing.calculate_zoom_level-189"><a href="#Graphing.calculate_zoom_level-189"><span class="linenos">189</span></a>        
</span><span id="Graphing.calculate_zoom_level-190"><a href="#Graphing.calculate_zoom_level-190"><span class="linenos">190</span></a>        <span class="c1"># Estimate the width of the plot in pixels</span>
</span><span id="Graphing.calculate_zoom_level-191"><a href="#Graphing.calculate_zoom_level-191"><span class="linenos">191</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Graphing.calculate_zoom_level-192"><a href="#Graphing.calculate_zoom_level-192"><span class="linenos">192</span></a>        <span class="n">width_in_pixels</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing.calculate_zoom_level-193"><a href="#Graphing.calculate_zoom_level-193"><span class="linenos">193</span></a>        
</span><span id="Graphing.calculate_zoom_level-194"><a href="#Graphing.calculate_zoom_level-194"><span class="linenos">194</span></a>        <span class="c1"># Calculate the zoom level</span>
</span><span id="Graphing.calculate_zoom_level-195"><a href="#Graphing.calculate_zoom_level-195"><span class="linenos">195</span></a>        <span class="c1"># This formula is an approximation and might need adjustment for your specific needs</span>
</span><span id="Graphing.calculate_zoom_level-196"><a href="#Graphing.calculate_zoom_level-196"><span class="linenos">196</span></a>        <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">((</span><span class="mi">360</span> <span class="o">*</span> <span class="n">width_in_pixels</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">width_deg</span> <span class="o">*</span> <span class="n">tile_service_resolution</span><span class="p">))</span>
</span><span id="Graphing.calculate_zoom_level-197"><a href="#Graphing.calculate_zoom_level-197"><span class="linenos">197</span></a>        
</span><span id="Graphing.calculate_zoom_level-198"><a href="#Graphing.calculate_zoom_level-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zoom_level</span><span class="p">),</span> <span class="mi">19</span><span class="p">))</span>  <span class="c1"># Ensure zoom level is within a valid range</span>
</span></pre></div>


            <div class="docstring"><p>Calculate an appropriate zoom level for a Cartopy axis based on its extent.</p>

<p>Args:</p>

<ul>
<li>ax: The Cartopy GeoAxes object.</li>
<li>tile_service_resolution: The resolution of the tile service (256 for most web services).</li>
</ul>

<p>Returns:</p>

<ul>
<li>An integer zoom level.</li>
</ul>
</div>


                            </div>
                            <div id="Graphing.filter_radius" class="classattr">
                                        <input id="Graphing.filter_radius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_radius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sources</span>, </span><span class="param"><span class="n">targets</span>, </span><span class="param"><span class="n">radius</span>, </span><span class="param"><span class="n">inside</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.filter_radius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.filter_radius"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.filter_radius-200"><a href="#Graphing.filter_radius-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">filter_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_radius-201"><a href="#Graphing.filter_radius-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.filter_radius-202"><a href="#Graphing.filter_radius-202"><span class="linenos">202</span></a><span class="sd">        Filters source points based on their linear distance from target points within a specified radius.</span>
</span><span id="Graphing.filter_radius-203"><a href="#Graphing.filter_radius-203"><span class="linenos">203</span></a>
</span><span id="Graphing.filter_radius-204"><a href="#Graphing.filter_radius-204"><span class="linenos">204</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.filter_radius-205"><a href="#Graphing.filter_radius-205"><span class="linenos">205</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_radius-206"><a href="#Graphing.filter_radius-206"><span class="linenos">206</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_radius-207"><a href="#Graphing.filter_radius-207"><span class="linenos">207</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="Graphing.filter_radius-208"><a href="#Graphing.filter_radius-208"><span class="linenos">208</span></a><span class="sd">            inside (bool, optional): If True, filters for source points inside the radius. If False, filters for source points </span>
</span><span id="Graphing.filter_radius-209"><a href="#Graphing.filter_radius-209"><span class="linenos">209</span></a><span class="sd">            outside the radius. Defaults to True.</span>
</span><span id="Graphing.filter_radius-210"><a href="#Graphing.filter_radius-210"><span class="linenos">210</span></a>
</span><span id="Graphing.filter_radius-211"><a href="#Graphing.filter_radius-211"><span class="linenos">211</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.filter_radius-212"><a href="#Graphing.filter_radius-212"><span class="linenos">212</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the radius criteria.</span>
</span><span id="Graphing.filter_radius-213"><a href="#Graphing.filter_radius-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.filter_radius-214"><a href="#Graphing.filter_radius-214"><span class="linenos">214</span></a>
</span><span id="Graphing.filter_radius-215"><a href="#Graphing.filter_radius-215"><span class="linenos">215</span></a>        <span class="c1"># check if the lat/long pair is within radius of any of the targets.</span>
</span><span id="Graphing.filter_radius-216"><a href="#Graphing.filter_radius-216"><span class="linenos">216</span></a>        <span class="c1"># offices is a pandas dataframe with columns latitude and longitude, and each row represents a cetnered target location</span>
</span><span id="Graphing.filter_radius-217"><a href="#Graphing.filter_radius-217"><span class="linenos">217</span></a>        <span class="c1"># return true if the lat/long pair is within radius of any of the offices, otherwise return false (vice versa for outside)</span>
</span><span id="Graphing.filter_radius-218"><a href="#Graphing.filter_radius-218"><span class="linenos">218</span></a>        <span class="k">def</span> <span class="nf">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_radius-219"><a href="#Graphing.filter_radius-219"><span class="linenos">219</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.filter_radius-220"><a href="#Graphing.filter_radius-220"><span class="linenos">220</span></a>                <span class="k">if</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="Graphing.filter_radius-221"><a href="#Graphing.filter_radius-221"><span class="linenos">221</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing.filter_radius-222"><a href="#Graphing.filter_radius-222"><span class="linenos">222</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_radius-223"><a href="#Graphing.filter_radius-223"><span class="linenos">223</span></a>                <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span><span class="p">:</span>
</span><span id="Graphing.filter_radius-224"><a href="#Graphing.filter_radius-224"><span class="linenos">224</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing.filter_radius-225"><a href="#Graphing.filter_radius-225"><span class="linenos">225</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_radius-226"><a href="#Graphing.filter_radius-226"><span class="linenos">226</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing.filter_radius-227"><a href="#Graphing.filter_radius-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> 
</span><span id="Graphing.filter_radius-228"><a href="#Graphing.filter_radius-228"><span class="linenos">228</span></a>                                <span class="k">if</span> <span class="n">check_r</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>Filters source points based on their linear distance from target points within a specified radius.</p>

<p>Args:
    sources (DataFrame): A DataFrame containing source points with 'latitude' and 'longitude' columns.
    targets (DataFrame): A DataFrame containing target points with 'latitude' and 'longitude' columns.
    radius (float): The radius within which to filter source points, in miles.
    inside (bool, optional): If True, filters for source points inside the radius. If False, filters for source points 
    outside the radius. Defaults to True.</p>

<p>Returns:
    DataFrame: A DataFrame of filtered source points that meet the radius criteria.</p>
</div>


                            </div>
                            <div id="Graphing.filter_drive_distance" class="classattr">
                                        <input id="Graphing.filter_drive_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_drive_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sources</span>, </span><span class="param"><span class="n">targets</span>, </span><span class="param"><span class="n">radius</span>, </span><span class="param"><span class="n">commute_data</span>, </span><span class="param"><span class="n">inside</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.filter_drive_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.filter_drive_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.filter_drive_distance-231"><a href="#Graphing.filter_drive_distance-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">filter_drive_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_drive_distance-232"><a href="#Graphing.filter_drive_distance-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.filter_drive_distance-233"><a href="#Graphing.filter_drive_distance-233"><span class="linenos">233</span></a><span class="sd">        Filters source points based on the driving distance to target points using commute data.</span>
</span><span id="Graphing.filter_drive_distance-234"><a href="#Graphing.filter_drive_distance-234"><span class="linenos">234</span></a>
</span><span id="Graphing.filter_drive_distance-235"><a href="#Graphing.filter_drive_distance-235"><span class="linenos">235</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.filter_drive_distance-236"><a href="#Graphing.filter_drive_distance-236"><span class="linenos">236</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_drive_distance-237"><a href="#Graphing.filter_drive_distance-237"><span class="linenos">237</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_drive_distance-238"><a href="#Graphing.filter_drive_distance-238"><span class="linenos">238</span></a><span class="sd">            radius (float): The radius within which to filter source points, in miles.</span>
</span><span id="Graphing.filter_drive_distance-239"><a href="#Graphing.filter_drive_distance-239"><span class="linenos">239</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="Graphing.filter_drive_distance-240"><a href="#Graphing.filter_drive_distance-240"><span class="linenos">240</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the driving distance radius. If False, </span>
</span><span id="Graphing.filter_drive_distance-241"><a href="#Graphing.filter_drive_distance-241"><span class="linenos">241</span></a><span class="sd">            filters for source points outside the radius. Defaults to True.</span>
</span><span id="Graphing.filter_drive_distance-242"><a href="#Graphing.filter_drive_distance-242"><span class="linenos">242</span></a>
</span><span id="Graphing.filter_drive_distance-243"><a href="#Graphing.filter_drive_distance-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.filter_drive_distance-244"><a href="#Graphing.filter_drive_distance-244"><span class="linenos">244</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving distance criteria.</span>
</span><span id="Graphing.filter_drive_distance-245"><a href="#Graphing.filter_drive_distance-245"><span class="linenos">245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.filter_drive_distance-246"><a href="#Graphing.filter_drive_distance-246"><span class="linenos">246</span></a>
</span><span id="Graphing.filter_drive_distance-247"><a href="#Graphing.filter_drive_distance-247"><span class="linenos">247</span></a>        <span class="c1"># employee address maps to source, office address maps to destination</span>
</span><span id="Graphing.filter_drive_distance-248"><a href="#Graphing.filter_drive_distance-248"><span class="linenos">248</span></a>        <span class="c1"># for each office, check if the lat/long pair is within radius of any of the offices based upon actual driving distance</span>
</span><span id="Graphing.filter_drive_distance-249"><a href="#Graphing.filter_drive_distance-249"><span class="linenos">249</span></a>        <span class="k">def</span> <span class="nf">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_drive_distance-250"><a href="#Graphing.filter_drive_distance-250"><span class="linenos">250</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.filter_drive_distance-251"><a href="#Graphing.filter_drive_distance-251"><span class="linenos">251</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="Graphing.filter_drive_distance-252"><a href="#Graphing.filter_drive_distance-252"><span class="linenos">252</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="Graphing.filter_drive_distance-253"><a href="#Graphing.filter_drive_distance-253"><span class="linenos">253</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_distance-254"><a href="#Graphing.filter_drive_distance-254"><span class="linenos">254</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lon</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_distance-255"><a href="#Graphing.filter_drive_distance-255"><span class="linenos">255</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_distance-256"><a href="#Graphing.filter_drive_distance-256"><span class="linenos">256</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing.filter_drive_distance-257"><a href="#Graphing.filter_drive_distance-257"><span class="linenos">257</span></a>                                <span class="p">]</span>
</span><span id="Graphing.filter_drive_distance-258"><a href="#Graphing.filter_drive_distance-258"><span class="linenos">258</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.filter_drive_distance-259"><a href="#Graphing.filter_drive_distance-259"><span class="linenos">259</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing.filter_drive_distance-260"><a href="#Graphing.filter_drive_distance-260"><span class="linenos">260</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_drive_distance-261"><a href="#Graphing.filter_drive_distance-261"><span class="linenos">261</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;miles&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Graphing.filter_drive_distance-262"><a href="#Graphing.filter_drive_distance-262"><span class="linenos">262</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_drive_distance-263"><a href="#Graphing.filter_drive_distance-263"><span class="linenos">263</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing.filter_drive_distance-264"><a href="#Graphing.filter_drive_distance-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing.filter_drive_distance-265"><a href="#Graphing.filter_drive_distance-265"><span class="linenos">265</span></a>                                <span class="k">if</span> <span class="n">check_d</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>Filters source points based on the driving distance to target points using commute data.</p>

<p>Args:
    sources (DataFrame): A DataFrame containing source points with 'latitude' and 'longitude' columns.
    targets (DataFrame): A DataFrame containing target points with 'latitude' and 'longitude' columns.
    radius (float): The radius within which to filter source points, in miles.
    commute_data (DataFrame): A DataFrame containing commute data between source and target points.
    inside (bool, optional): If True, filters for source points within the driving distance radius. If False, 
    filters for source points outside the radius. Defaults to True.</p>

<p>Returns:
    DataFrame: A DataFrame of filtered source points that meet the driving distance criteria.</p>
</div>


                            </div>
                            <div id="Graphing.filter_drive_time" class="classattr">
                                        <input id="Graphing.filter_drive_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_drive_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sources</span>, </span><span class="param"><span class="n">targets</span>, </span><span class="param"><span class="n">minutes</span>, </span><span class="param"><span class="n">commute_data</span>, </span><span class="param"><span class="n">inside</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.filter_drive_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.filter_drive_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.filter_drive_time-267"><a href="#Graphing.filter_drive_time-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="nf">filter_drive_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_drive_time-268"><a href="#Graphing.filter_drive_time-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.filter_drive_time-269"><a href="#Graphing.filter_drive_time-269"><span class="linenos">269</span></a><span class="sd">        Filters source points based on the driving time to target points using commute data.</span>
</span><span id="Graphing.filter_drive_time-270"><a href="#Graphing.filter_drive_time-270"><span class="linenos">270</span></a>
</span><span id="Graphing.filter_drive_time-271"><a href="#Graphing.filter_drive_time-271"><span class="linenos">271</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.filter_drive_time-272"><a href="#Graphing.filter_drive_time-272"><span class="linenos">272</span></a><span class="sd">            sources (DataFrame): A DataFrame containing source points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_drive_time-273"><a href="#Graphing.filter_drive_time-273"><span class="linenos">273</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.filter_drive_time-274"><a href="#Graphing.filter_drive_time-274"><span class="linenos">274</span></a><span class="sd">            minutes (float): The maximum driving time in minutes within which to filter source points.</span>
</span><span id="Graphing.filter_drive_time-275"><a href="#Graphing.filter_drive_time-275"><span class="linenos">275</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between source and target points.</span>
</span><span id="Graphing.filter_drive_time-276"><a href="#Graphing.filter_drive_time-276"><span class="linenos">276</span></a><span class="sd">            inside (bool, optional): If True, filters for source points within the specified driving time. If False, filters for source points outside the driving time. Defaults to True.</span>
</span><span id="Graphing.filter_drive_time-277"><a href="#Graphing.filter_drive_time-277"><span class="linenos">277</span></a>
</span><span id="Graphing.filter_drive_time-278"><a href="#Graphing.filter_drive_time-278"><span class="linenos">278</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.filter_drive_time-279"><a href="#Graphing.filter_drive_time-279"><span class="linenos">279</span></a><span class="sd">            DataFrame: A DataFrame of filtered source points that meet the driving time criteria.</span>
</span><span id="Graphing.filter_drive_time-280"><a href="#Graphing.filter_drive_time-280"><span class="linenos">280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.filter_drive_time-281"><a href="#Graphing.filter_drive_time-281"><span class="linenos">281</span></a>
</span><span id="Graphing.filter_drive_time-282"><a href="#Graphing.filter_drive_time-282"><span class="linenos">282</span></a>        <span class="k">def</span> <span class="nf">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Graphing.filter_drive_time-283"><a href="#Graphing.filter_drive_time-283"><span class="linenos">283</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.filter_drive_time-284"><a href="#Graphing.filter_drive_time-284"><span class="linenos">284</span></a>                <span class="c1"># get the rows from commute_data that have the office address as the destination and lat long pair as the source</span>
</span><span id="Graphing.filter_drive_time-285"><a href="#Graphing.filter_drive_time-285"><span class="linenos">285</span></a>                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">commute_data</span><span class="p">[</span>
</span><span id="Graphing.filter_drive_time-286"><a href="#Graphing.filter_drive_time-286"><span class="linenos">286</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_time-287"><a href="#Graphing.filter_drive_time-287"><span class="linenos">287</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">long</span><span class="p">)</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_time-288"><a href="#Graphing.filter_drive_time-288"><span class="linenos">288</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
</span><span id="Graphing.filter_drive_time-289"><a href="#Graphing.filter_drive_time-289"><span class="linenos">289</span></a>                                    <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing.filter_drive_time-290"><a href="#Graphing.filter_drive_time-290"><span class="linenos">290</span></a>                                <span class="p">]</span>
</span><span id="Graphing.filter_drive_time-291"><a href="#Graphing.filter_drive_time-291"><span class="linenos">291</span></a>                <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.filter_drive_time-292"><a href="#Graphing.filter_drive_time-292"><span class="linenos">292</span></a>                    <span class="k">if</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="Graphing.filter_drive_time-293"><a href="#Graphing.filter_drive_time-293"><span class="linenos">293</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_drive_time-294"><a href="#Graphing.filter_drive_time-294"><span class="linenos">294</span></a>                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">inside</span> <span class="ow">and</span> <span class="n">row2</span><span class="p">[</span><span class="s1">&#39;m_morning_duration_in_traffic&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">minutes</span><span class="p">:</span>
</span><span id="Graphing.filter_drive_time-295"><a href="#Graphing.filter_drive_time-295"><span class="linenos">295</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Graphing.filter_drive_time-296"><a href="#Graphing.filter_drive_time-296"><span class="linenos">296</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Graphing.filter_drive_time-297"><a href="#Graphing.filter_drive_time-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">long</span><span class="p">}</span> <span class="k">for</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span><span id="Graphing.filter_drive_time-298"><a href="#Graphing.filter_drive_time-298"><span class="linenos">298</span></a>                                <span class="k">if</span> <span class="n">check_t</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="n">inside</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>Filters source points based on the driving time to target points using commute data.</p>

<p>Args:
    sources (DataFrame): A DataFrame containing source points with 'latitude' and 'longitude' columns.
    targets (DataFrame): A DataFrame containing target points with 'latitude' and 'longitude' columns.
    minutes (float): The maximum driving time in minutes within which to filter source points.
    commute_data (DataFrame): A DataFrame containing commute data between source and target points.
    inside (bool, optional): If True, filters for source points within the specified driving time. If False, filters for source points outside the driving time. Defaults to True.</p>

<p>Returns:
    DataFrame: A DataFrame of filtered source points that meet the driving time criteria.</p>
</div>


                            </div>
                            <div id="Graphing.get_common_points" class="classattr">
                                        <input id="Graphing.get_common_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_common_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">set1</span>, </span><span class="param"><span class="n">set2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_common_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_common_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_common_points-300"><a href="#Graphing.get_common_points-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">get_common_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="Graphing.get_common_points-301"><a href="#Graphing.get_common_points-301"><span class="linenos">301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_common_points-302"><a href="#Graphing.get_common_points-302"><span class="linenos">302</span></a><span class="sd">        Finds common points between two sets of latitudes and longitudes.</span>
</span><span id="Graphing.get_common_points-303"><a href="#Graphing.get_common_points-303"><span class="linenos">303</span></a>
</span><span id="Graphing.get_common_points-304"><a href="#Graphing.get_common_points-304"><span class="linenos">304</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_common_points-305"><a href="#Graphing.get_common_points-305"><span class="linenos">305</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.get_common_points-306"><a href="#Graphing.get_common_points-306"><span class="linenos">306</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.get_common_points-307"><a href="#Graphing.get_common_points-307"><span class="linenos">307</span></a>
</span><span id="Graphing.get_common_points-308"><a href="#Graphing.get_common_points-308"><span class="linenos">308</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_common_points-309"><a href="#Graphing.get_common_points-309"><span class="linenos">309</span></a><span class="sd">            DataFrame: A DataFrame of common points between the two sets.</span>
</span><span id="Graphing.get_common_points-310"><a href="#Graphing.get_common_points-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_common_points-311"><a href="#Graphing.get_common_points-311"><span class="linenos">311</span></a>        <span class="c1"># find the common points between the two sets</span>
</span><span id="Graphing.get_common_points-312"><a href="#Graphing.get_common_points-312"><span class="linenos">312</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">set2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Finds common points between two sets of latitudes and longitudes.</p>

<p>Args:
    set1 (DataFrame): A DataFrame containing 'latitude' and 'longitude' columns.
    set2 (DataFrame): A DataFrame containing 'latitude' and 'longitude' columns.</p>

<p>Returns:
    DataFrame: A DataFrame of common points between the two sets.</p>
</div>


                            </div>
                            <div id="Graphing.get_unique_points" class="classattr">
                                        <input id="Graphing.get_unique_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_unique_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">set1</span>, </span><span class="param"><span class="n">set2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_unique_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_unique_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_unique_points-314"><a href="#Graphing.get_unique_points-314"><span class="linenos">314</span></a>    <span class="k">def</span> <span class="nf">get_unique_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
</span><span id="Graphing.get_unique_points-315"><a href="#Graphing.get_unique_points-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_unique_points-316"><a href="#Graphing.get_unique_points-316"><span class="linenos">316</span></a><span class="sd">        Finds unique points in the first set that are not present in the second set.</span>
</span><span id="Graphing.get_unique_points-317"><a href="#Graphing.get_unique_points-317"><span class="linenos">317</span></a>
</span><span id="Graphing.get_unique_points-318"><a href="#Graphing.get_unique_points-318"><span class="linenos">318</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_unique_points-319"><a href="#Graphing.get_unique_points-319"><span class="linenos">319</span></a><span class="sd">            set1 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.get_unique_points-320"><a href="#Graphing.get_unique_points-320"><span class="linenos">320</span></a><span class="sd">            set2 (DataFrame): A DataFrame containing &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.get_unique_points-321"><a href="#Graphing.get_unique_points-321"><span class="linenos">321</span></a>
</span><span id="Graphing.get_unique_points-322"><a href="#Graphing.get_unique_points-322"><span class="linenos">322</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_unique_points-323"><a href="#Graphing.get_unique_points-323"><span class="linenos">323</span></a><span class="sd">            DataFrame: A DataFrame of unique points in the first set.</span>
</span><span id="Graphing.get_unique_points-324"><a href="#Graphing.get_unique_points-324"><span class="linenos">324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_unique_points-325"><a href="#Graphing.get_unique_points-325"><span class="linenos">325</span></a>
</span><span id="Graphing.get_unique_points-326"><a href="#Graphing.get_unique_points-326"><span class="linenos">326</span></a>        <span class="c1"># find the unique points in the first set</span>
</span><span id="Graphing.get_unique_points-327"><a href="#Graphing.get_unique_points-327"><span class="linenos">327</span></a>        <span class="k">return</span> <span class="n">set1</span><span class="p">[</span><span class="o">~</span><span class="n">set1</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">set2</span><span class="p">)]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Finds unique points in the first set that are not present in the second set.</p>

<p>Args:
    set1 (DataFrame): A DataFrame containing 'latitude' and 'longitude' columns.
    set2 (DataFrame): A DataFrame containing 'latitude' and 'longitude' columns.</p>

<p>Returns:
    DataFrame: A DataFrame of unique points in the first set.</p>
</div>


                            </div>
                            <div id="Graphing.haversine" class="classattr">
                                        <input id="Graphing.haversine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">haversine</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">lat1</span>, </span><span class="param"><span class="n">lon1</span>, </span><span class="param"><span class="n">lat2</span>, </span><span class="param"><span class="n">lon2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.haversine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.haversine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.haversine-329"><a href="#Graphing.haversine-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="nf">haversine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">):</span>
</span><span id="Graphing.haversine-330"><a href="#Graphing.haversine-330"><span class="linenos">330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.haversine-331"><a href="#Graphing.haversine-331"><span class="linenos">331</span></a><span class="sd">        Calculates the great-circle distance between two points on the Earth specified in decimal degrees using the Haversine formula.</span>
</span><span id="Graphing.haversine-332"><a href="#Graphing.haversine-332"><span class="linenos">332</span></a>
</span><span id="Graphing.haversine-333"><a href="#Graphing.haversine-333"><span class="linenos">333</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.haversine-334"><a href="#Graphing.haversine-334"><span class="linenos">334</span></a><span class="sd">            lat1 (float): Latitude of the first point.</span>
</span><span id="Graphing.haversine-335"><a href="#Graphing.haversine-335"><span class="linenos">335</span></a><span class="sd">            lon1 (float): Longitude of the first point.</span>
</span><span id="Graphing.haversine-336"><a href="#Graphing.haversine-336"><span class="linenos">336</span></a><span class="sd">            lat2 (float): Latitude of the second point.</span>
</span><span id="Graphing.haversine-337"><a href="#Graphing.haversine-337"><span class="linenos">337</span></a><span class="sd">            lon2 (float): Longitude of the second point.</span>
</span><span id="Graphing.haversine-338"><a href="#Graphing.haversine-338"><span class="linenos">338</span></a>
</span><span id="Graphing.haversine-339"><a href="#Graphing.haversine-339"><span class="linenos">339</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.haversine-340"><a href="#Graphing.haversine-340"><span class="linenos">340</span></a><span class="sd">            float: The distance between the two points in miles.</span>
</span><span id="Graphing.haversine-341"><a href="#Graphing.haversine-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.haversine-342"><a href="#Graphing.haversine-342"><span class="linenos">342</span></a>
</span><span id="Graphing.haversine-343"><a href="#Graphing.haversine-343"><span class="linenos">343</span></a>        <span class="c1">#To calculate the distance between two latitude/longitude coordinates while taking the curvature of the Earth into account, </span>
</span><span id="Graphing.haversine-344"><a href="#Graphing.haversine-344"><span class="linenos">344</span></a>        <span class="c1">#you use the Haversine formula. This formula gives you the great-circle distance between two points on the surface of a sphere, </span>
</span><span id="Graphing.haversine-345"><a href="#Graphing.haversine-345"><span class="linenos">345</span></a>        <span class="c1">#given their longitudes and latitudes. This is particularly useful for calculating the approximate distance between two points </span>
</span><span id="Graphing.haversine-346"><a href="#Graphing.haversine-346"><span class="linenos">346</span></a>        <span class="c1">#on the Earth.&quot;</span>
</span><span id="Graphing.haversine-347"><a href="#Graphing.haversine-347"><span class="linenos">347</span></a>
</span><span id="Graphing.haversine-348"><a href="#Graphing.haversine-348"><span class="linenos">348</span></a>        <span class="c1"># Radius of the Earth in miles</span>
</span><span id="Graphing.haversine-349"><a href="#Graphing.haversine-349"><span class="linenos">349</span></a>        <span class="n">R</span> <span class="o">=</span> <span class="mf">3958.8</span>
</span><span id="Graphing.haversine-350"><a href="#Graphing.haversine-350"><span class="linenos">350</span></a>        <span class="c1"># Radius of the Earth in kilometers (uncomment to use kilometers)</span>
</span><span id="Graphing.haversine-351"><a href="#Graphing.haversine-351"><span class="linenos">351</span></a>        <span class="c1">#R = 6371.0</span>
</span><span id="Graphing.haversine-352"><a href="#Graphing.haversine-352"><span class="linenos">352</span></a>
</span><span id="Graphing.haversine-353"><a href="#Graphing.haversine-353"><span class="linenos">353</span></a>        <span class="c1"># Convert latitude and longitude from degrees to radians</span>
</span><span id="Graphing.haversine-354"><a href="#Graphing.haversine-354"><span class="linenos">354</span></a>        <span class="n">lat1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Graphing.haversine-355"><a href="#Graphing.haversine-355"><span class="linenos">355</span></a>        <span class="n">lon1_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="Graphing.haversine-356"><a href="#Graphing.haversine-356"><span class="linenos">356</span></a>        <span class="n">lat2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="Graphing.haversine-357"><a href="#Graphing.haversine-357"><span class="linenos">357</span></a>        <span class="n">lon2_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="Graphing.haversine-358"><a href="#Graphing.haversine-358"><span class="linenos">358</span></a>
</span><span id="Graphing.haversine-359"><a href="#Graphing.haversine-359"><span class="linenos">359</span></a>        <span class="c1"># Difference in coordinates</span>
</span><span id="Graphing.haversine-360"><a href="#Graphing.haversine-360"><span class="linenos">360</span></a>        <span class="n">dlat</span> <span class="o">=</span> <span class="n">lat2_rad</span> <span class="o">-</span> <span class="n">lat1_rad</span>
</span><span id="Graphing.haversine-361"><a href="#Graphing.haversine-361"><span class="linenos">361</span></a>        <span class="n">dlon</span> <span class="o">=</span> <span class="n">lon2_rad</span> <span class="o">-</span> <span class="n">lon1_rad</span>
</span><span id="Graphing.haversine-362"><a href="#Graphing.haversine-362"><span class="linenos">362</span></a>
</span><span id="Graphing.haversine-363"><a href="#Graphing.haversine-363"><span class="linenos">363</span></a>        <span class="c1"># Haversine formula</span>
</span><span id="Graphing.haversine-364"><a href="#Graphing.haversine-364"><span class="linenos">364</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Graphing.haversine-365"><a href="#Graphing.haversine-365"><span class="linenos">365</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>
</span><span id="Graphing.haversine-366"><a href="#Graphing.haversine-366"><span class="linenos">366</span></a>
</span><span id="Graphing.haversine-367"><a href="#Graphing.haversine-367"><span class="linenos">367</span></a>        <span class="c1"># Total distance in (units selected above)</span>
</span><span id="Graphing.haversine-368"><a href="#Graphing.haversine-368"><span class="linenos">368</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">c</span>
</span><span id="Graphing.haversine-369"><a href="#Graphing.haversine-369"><span class="linenos">369</span></a>
</span><span id="Graphing.haversine-370"><a href="#Graphing.haversine-370"><span class="linenos">370</span></a>        <span class="k">return</span> <span class="n">distance</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the great-circle distance between two points on the Earth specified in decimal degrees using the Haversine formula.</p>

<p>Args:
    lat1 (float): Latitude of the first point.
    lon1 (float): Longitude of the first point.
    lat2 (float): Latitude of the second point.
    lon2 (float): Longitude of the second point.</p>

<p>Returns:
    float: The distance between the two points in miles.</p>
</div>


                            </div>
                            <div id="Graphing.haversine_newpoint" class="classattr">
                                        <input id="Graphing.haversine_newpoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">haversine_newpoint</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">lat1</span>, </span><span class="param"><span class="n">lon1</span>, </span><span class="param"><span class="n">distance</span>, </span><span class="param"><span class="n">bearing</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.haversine_newpoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.haversine_newpoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.haversine_newpoint-373"><a href="#Graphing.haversine_newpoint-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">haversine_newpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">bearing</span><span class="p">):</span>
</span><span id="Graphing.haversine_newpoint-374"><a href="#Graphing.haversine_newpoint-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.haversine_newpoint-375"><a href="#Graphing.haversine_newpoint-375"><span class="linenos">375</span></a><span class="sd">        Calculates a new point given a distance and bearing from a starting point using the Haversine formula.</span>
</span><span id="Graphing.haversine_newpoint-376"><a href="#Graphing.haversine_newpoint-376"><span class="linenos">376</span></a>
</span><span id="Graphing.haversine_newpoint-377"><a href="#Graphing.haversine_newpoint-377"><span class="linenos">377</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.haversine_newpoint-378"><a href="#Graphing.haversine_newpoint-378"><span class="linenos">378</span></a><span class="sd">            lat1 (float): Latitude of the starting point.</span>
</span><span id="Graphing.haversine_newpoint-379"><a href="#Graphing.haversine_newpoint-379"><span class="linenos">379</span></a><span class="sd">            lon1 (float): Longitude of the starting point.</span>
</span><span id="Graphing.haversine_newpoint-380"><a href="#Graphing.haversine_newpoint-380"><span class="linenos">380</span></a><span class="sd">            distance (float): Distance from the starting point in miles.</span>
</span><span id="Graphing.haversine_newpoint-381"><a href="#Graphing.haversine_newpoint-381"><span class="linenos">381</span></a><span class="sd">            bearing (float): Bearing in degrees from the starting point to the new point.</span>
</span><span id="Graphing.haversine_newpoint-382"><a href="#Graphing.haversine_newpoint-382"><span class="linenos">382</span></a>
</span><span id="Graphing.haversine_newpoint-383"><a href="#Graphing.haversine_newpoint-383"><span class="linenos">383</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.haversine_newpoint-384"><a href="#Graphing.haversine_newpoint-384"><span class="linenos">384</span></a><span class="sd">            tuple: A tuple (lat2, lon2) representing the latitude and longitude of the new point.</span>
</span><span id="Graphing.haversine_newpoint-385"><a href="#Graphing.haversine_newpoint-385"><span class="linenos">385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.haversine_newpoint-386"><a href="#Graphing.haversine_newpoint-386"><span class="linenos">386</span></a>
</span><span id="Graphing.haversine_newpoint-387"><a href="#Graphing.haversine_newpoint-387"><span class="linenos">387</span></a>        <span class="c1"># convert distance to radians</span>
</span><span id="Graphing.haversine_newpoint-388"><a href="#Graphing.haversine_newpoint-388"><span class="linenos">388</span></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">/</span> <span class="mf">3958.8</span>
</span><span id="Graphing.haversine_newpoint-389"><a href="#Graphing.haversine_newpoint-389"><span class="linenos">389</span></a>        <span class="c1"># convert bearing to radians</span>
</span><span id="Graphing.haversine_newpoint-390"><a href="#Graphing.haversine_newpoint-390"><span class="linenos">390</span></a>        <span class="n">bearing</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
</span><span id="Graphing.haversine_newpoint-391"><a href="#Graphing.haversine_newpoint-391"><span class="linenos">391</span></a>        <span class="c1"># convert latitude to radians</span>
</span><span id="Graphing.haversine_newpoint-392"><a href="#Graphing.haversine_newpoint-392"><span class="linenos">392</span></a>        <span class="n">lat1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Graphing.haversine_newpoint-393"><a href="#Graphing.haversine_newpoint-393"><span class="linenos">393</span></a>        <span class="c1"># convert longitude to radians</span>
</span><span id="Graphing.haversine_newpoint-394"><a href="#Graphing.haversine_newpoint-394"><span class="linenos">394</span></a>        <span class="n">lon1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
</span><span id="Graphing.haversine_newpoint-395"><a href="#Graphing.haversine_newpoint-395"><span class="linenos">395</span></a>        <span class="c1"># calculate the new latitude</span>
</span><span id="Graphing.haversine_newpoint-396"><a href="#Graphing.haversine_newpoint-396"><span class="linenos">396</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bearing</span><span class="p">))</span>
</span><span id="Graphing.haversine_newpoint-397"><a href="#Graphing.haversine_newpoint-397"><span class="linenos">397</span></a>        <span class="c1"># calculate the new longitude</span>
</span><span id="Graphing.haversine_newpoint-398"><a href="#Graphing.haversine_newpoint-398"><span class="linenos">398</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">))</span>
</span><span id="Graphing.haversine_newpoint-399"><a href="#Graphing.haversine_newpoint-399"><span class="linenos">399</span></a>        <span class="c1"># convert latitude back to degrees</span>
</span><span id="Graphing.haversine_newpoint-400"><a href="#Graphing.haversine_newpoint-400"><span class="linenos">400</span></a>        <span class="n">lat2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
</span><span id="Graphing.haversine_newpoint-401"><a href="#Graphing.haversine_newpoint-401"><span class="linenos">401</span></a>        <span class="c1"># convert longitude back to degrees</span>
</span><span id="Graphing.haversine_newpoint-402"><a href="#Graphing.haversine_newpoint-402"><span class="linenos">402</span></a>        <span class="n">lon2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
</span><span id="Graphing.haversine_newpoint-403"><a href="#Graphing.haversine_newpoint-403"><span class="linenos">403</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculates a new point given a distance and bearing from a starting point using the Haversine formula.</p>

<p>Args:
    lat1 (float): Latitude of the starting point.
    lon1 (float): Longitude of the starting point.
    distance (float): Distance from the starting point in miles.
    bearing (float): Bearing in degrees from the starting point to the new point.</p>

<p>Returns:
    tuple: A tuple (lat2, lon2) representing the latitude and longitude of the new point.</p>
</div>


                            </div>
                            <div id="Graphing.plot_ellipses" class="classattr">
                                        <input id="Graphing.plot_ellipses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_ellipses</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span>, </span><span class="param"><span class="n">offices</span>, </span><span class="param"><span class="n">commute_radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_ellipses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_ellipses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_ellipses-405"><a href="#Graphing.plot_ellipses-405"><span class="linenos">405</span></a>    <span class="k">def</span> <span class="nf">plot_ellipses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">):</span>
</span><span id="Graphing.plot_ellipses-406"><a href="#Graphing.plot_ellipses-406"><span class="linenos">406</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_ellipses-407"><a href="#Graphing.plot_ellipses-407"><span class="linenos">407</span></a><span class="sd">        Draws ellipses around office locations to represent the commute radius from each office.</span>
</span><span id="Graphing.plot_ellipses-408"><a href="#Graphing.plot_ellipses-408"><span class="linenos">408</span></a>
</span><span id="Graphing.plot_ellipses-409"><a href="#Graphing.plot_ellipses-409"><span class="linenos">409</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_ellipses-410"><a href="#Graphing.plot_ellipses-410"><span class="linenos">410</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing.plot_ellipses-411"><a href="#Graphing.plot_ellipses-411"><span class="linenos">411</span></a><span class="sd">            offices (DataFrame): A DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.plot_ellipses-412"><a href="#Graphing.plot_ellipses-412"><span class="linenos">412</span></a><span class="sd">            commute_radius (float): The radius to draw around each office location, in miles.</span>
</span><span id="Graphing.plot_ellipses-413"><a href="#Graphing.plot_ellipses-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_ellipses-414"><a href="#Graphing.plot_ellipses-414"><span class="linenos">414</span></a>
</span><span id="Graphing.plot_ellipses-415"><a href="#Graphing.plot_ellipses-415"><span class="linenos">415</span></a>        <span class="c1"># draw an ellipse around the office locations to represent the radius from each office (ellipse in thise OSM projection will be a circle)</span>
</span><span id="Graphing.plot_ellipses-416"><a href="#Graphing.plot_ellipses-416"><span class="linenos">416</span></a>        <span class="c1"># note: this will be a jagged representation due to cartopy handling, better to use our own eline function</span>
</span><span id="Graphing.plot_ellipses-417"><a href="#Graphing.plot_ellipses-417"><span class="linenos">417</span></a>        <span class="n">xcdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Graphing.plot_ellipses-418"><a href="#Graphing.plot_ellipses-418"><span class="linenos">418</span></a>        <span class="n">ycdelta</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Graphing.plot_ellipses-419"><a href="#Graphing.plot_ellipses-419"><span class="linenos">419</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">offices</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.plot_ellipses-420"><a href="#Graphing.plot_ellipses-420"><span class="linenos">420</span></a>            <span class="c1"># if cdelta is None, calculate the circle radius using first set of lat long, and using haversine to calcuate a new point, then x0-x1</span>
</span><span id="Graphing.plot_ellipses-421"><a href="#Graphing.plot_ellipses-421"><span class="linenos">421</span></a>            <span class="k">if</span> <span class="n">ycdelta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.plot_ellipses-422"><a href="#Graphing.plot_ellipses-422"><span class="linenos">422</span></a>                <span class="c1"># calculate the circle radius using the first set of lat long</span>
</span><span id="Graphing.plot_ellipses-423"><a href="#Graphing.plot_ellipses-423"><span class="linenos">423</span></a>                <span class="n">ycdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Graphing.plot_ellipses-424"><a href="#Graphing.plot_ellipses-424"><span class="linenos">424</span></a>                <span class="n">xcdelta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="mi">90</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing.plot_ellipses-425"><a href="#Graphing.plot_ellipses-425"><span class="linenos">425</span></a>
</span><span id="Graphing.plot_ellipses-426"><a href="#Graphing.plot_ellipses-426"><span class="linenos">426</span></a>            <span class="c1"># calculate the ellipse around the office location</span>
</span><span id="Graphing.plot_ellipses-427"><a href="#Graphing.plot_ellipses-427"><span class="linenos">427</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">xcdelta</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ycdelta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="p">)</span>
</span><span id="Graphing.plot_ellipses-428"><a href="#Graphing.plot_ellipses-428"><span class="linenos">428</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipse</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws ellipses around office locations to represent the commute radius from each office.</p>

<p>Args:
    ax: The matplotlib axes object on which to draw.
    offices (DataFrame): A DataFrame containing office locations with 'latitude' and 'longitude' columns.
    commute_radius (float): The radius to draw around each office location, in miles.</p>
</div>


                            </div>
                            <div id="Graphing.plot_elines" class="classattr">
                                        <input id="Graphing.plot_elines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_elines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ax</span>,</span><span class="param">	<span class="n">targets</span>,</span><span class="param">	<span class="n">commute_radius</span>,</span><span class="param">	<span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span>,</span><span class="param">	<span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_elines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_elines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_elines-430"><a href="#Graphing.plot_elines-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">plot_elines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="Graphing.plot_elines-431"><a href="#Graphing.plot_elines-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_elines-432"><a href="#Graphing.plot_elines-432"><span class="linenos">432</span></a><span class="sd">        Draws lines (elipses) around target points to represent a specified radius from each point on a map.</span>
</span><span id="Graphing.plot_elines-433"><a href="#Graphing.plot_elines-433"><span class="linenos">433</span></a>
</span><span id="Graphing.plot_elines-434"><a href="#Graphing.plot_elines-434"><span class="linenos">434</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_elines-435"><a href="#Graphing.plot_elines-435"><span class="linenos">435</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing.plot_elines-436"><a href="#Graphing.plot_elines-436"><span class="linenos">436</span></a><span class="sd">            targets (DataFrame): A DataFrame containing target points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.plot_elines-437"><a href="#Graphing.plot_elines-437"><span class="linenos">437</span></a><span class="sd">            commute_radius (float): The radius around each target point to draw, in miles.</span>
</span><span id="Graphing.plot_elines-438"><a href="#Graphing.plot_elines-438"><span class="linenos">438</span></a><span class="sd">            color (str, optional): Color of the lines. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.plot_elines-439"><a href="#Graphing.plot_elines-439"><span class="linenos">439</span></a><span class="sd">            linestyle (str, optional): Style of the line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing.plot_elines-440"><a href="#Graphing.plot_elines-440"><span class="linenos">440</span></a><span class="sd">            linewidth (int, optional): Width of the lines. Defaults to 2.</span>
</span><span id="Graphing.plot_elines-441"><a href="#Graphing.plot_elines-441"><span class="linenos">441</span></a>
</span><span id="Graphing.plot_elines-442"><a href="#Graphing.plot_elines-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_elines-443"><a href="#Graphing.plot_elines-443"><span class="linenos">443</span></a>
</span><span id="Graphing.plot_elines-444"><a href="#Graphing.plot_elines-444"><span class="linenos">444</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Graphing.plot_elines-445"><a href="#Graphing.plot_elines-445"><span class="linenos">445</span></a>            <span class="c1"># plot an eline</span>
</span><span id="Graphing.plot_elines-446"><a href="#Graphing.plot_elines-446"><span class="linenos">446</span></a>            <span class="n">elinex</span><span class="p">,</span><span class="n">eliney</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_eline</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing.plot_elines-447"><a href="#Graphing.plot_elines-447"><span class="linenos">447</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;New Line&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws lines (elipses) around target points to represent a specified radius from each point on a map.</p>

<p>Args:
    ax: The matplotlib axes object on which to draw.
    targets (DataFrame): A DataFrame containing target points with 'latitude' and 'longitude' columns.
    commute_radius (float): The radius around each target point to draw, in miles.
    color (str, optional): Color of the lines. Defaults to 'black'.
    linestyle (str, optional): Style of the line. Defaults to '--'.
    linewidth (int, optional): Width of the lines. Defaults to 2.</p>
</div>


                            </div>
                            <div id="Graphing.create_eline" class="classattr">
                                        <input id="Graphing.create_eline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eline</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">lat</span>, </span><span class="param"><span class="n">long</span>, </span><span class="param"><span class="n">r</span>, </span><span class="param"><span class="n">step</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.create_eline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.create_eline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.create_eline-449"><a href="#Graphing.create_eline-449"><span class="linenos">449</span></a>    <span class="k">def</span> <span class="nf">create_eline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="Graphing.create_eline-450"><a href="#Graphing.create_eline-450"><span class="linenos">450</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.create_eline-451"><a href="#Graphing.create_eline-451"><span class="linenos">451</span></a><span class="sd">        Creates a set of latitude and longitude points that form a circle (or ellipse) around a central point.</span>
</span><span id="Graphing.create_eline-452"><a href="#Graphing.create_eline-452"><span class="linenos">452</span></a>
</span><span id="Graphing.create_eline-453"><a href="#Graphing.create_eline-453"><span class="linenos">453</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.create_eline-454"><a href="#Graphing.create_eline-454"><span class="linenos">454</span></a><span class="sd">            lat (float): Latitude of the central point.</span>
</span><span id="Graphing.create_eline-455"><a href="#Graphing.create_eline-455"><span class="linenos">455</span></a><span class="sd">            long (float): Longitude of the central point.</span>
</span><span id="Graphing.create_eline-456"><a href="#Graphing.create_eline-456"><span class="linenos">456</span></a><span class="sd">            r (float): Radius of the circle in miles.</span>
</span><span id="Graphing.create_eline-457"><a href="#Graphing.create_eline-457"><span class="linenos">457</span></a><span class="sd">            step (int, optional): Degrees between each point on the circle. Smaller values create a smoother circle. Defaults to 10.</span>
</span><span id="Graphing.create_eline-458"><a href="#Graphing.create_eline-458"><span class="linenos">458</span></a>
</span><span id="Graphing.create_eline-459"><a href="#Graphing.create_eline-459"><span class="linenos">459</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.create_eline-460"><a href="#Graphing.create_eline-460"><span class="linenos">460</span></a><span class="sd">            tuple: Two lists containing the longitude and latitude of points forming the circle.</span>
</span><span id="Graphing.create_eline-461"><a href="#Graphing.create_eline-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.create_eline-462"><a href="#Graphing.create_eline-462"><span class="linenos">462</span></a>
</span><span id="Graphing.create_eline-463"><a href="#Graphing.create_eline-463"><span class="linenos">463</span></a>        <span class="c1"># start with the lat/long, and calculate a point r miles away at 0 degrees, then, repeat every step degrees until 360, inclusive</span>
</span><span id="Graphing.create_eline-464"><a href="#Graphing.create_eline-464"><span class="linenos">464</span></a>        <span class="n">elinex</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Graphing.create_eline-465"><a href="#Graphing.create_eline-465"><span class="linenos">465</span></a>        <span class="n">eliney</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Graphing.create_eline-466"><a href="#Graphing.create_eline-466"><span class="linenos">466</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</span><span id="Graphing.create_eline-467"><a href="#Graphing.create_eline-467"><span class="linenos">467</span></a>            <span class="n">np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haversine_newpoint</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="Graphing.create_eline-468"><a href="#Graphing.create_eline-468"><span class="linenos">468</span></a>            <span class="n">elinex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing.create_eline-469"><a href="#Graphing.create_eline-469"><span class="linenos">469</span></a>            <span class="n">eliney</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Graphing.create_eline-470"><a href="#Graphing.create_eline-470"><span class="linenos">470</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">elinex</span><span class="p">,</span> <span class="n">eliney</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Creates a set of latitude and longitude points that form a circle (or ellipse) around a central point.</p>

<p>Args:
    lat (float): Latitude of the central point.
    long (float): Longitude of the central point.
    r (float): Radius of the circle in miles.
    step (int, optional): Degrees between each point on the circle. Smaller values create a smoother circle. Defaults to 10.</p>

<p>Returns:
    tuple: Two lists containing the longitude and latitude of points forming the circle.</p>
</div>


                            </div>
                            <div id="Graphing.plot_convex_hull" class="classattr">
                                        <input id="Graphing.plot_convex_hull-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_convex_hull</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span>, </span><span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>, </span><span class="param"><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span>, </span><span class="param"><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_convex_hull-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_convex_hull"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_convex_hull-472"><a href="#Graphing.plot_convex_hull-472"><span class="linenos">472</span></a>    <span class="k">def</span> <span class="nf">plot_convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing.plot_convex_hull-473"><a href="#Graphing.plot_convex_hull-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_convex_hull-474"><a href="#Graphing.plot_convex_hull-474"><span class="linenos">474</span></a><span class="sd">        Draws a convex hull around a set of points on the map, effectively creating a boundary that encloses all the points.</span>
</span><span id="Graphing.plot_convex_hull-475"><a href="#Graphing.plot_convex_hull-475"><span class="linenos">475</span></a>
</span><span id="Graphing.plot_convex_hull-476"><a href="#Graphing.plot_convex_hull-476"><span class="linenos">476</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_convex_hull-477"><a href="#Graphing.plot_convex_hull-477"><span class="linenos">477</span></a><span class="sd">            ax: The matplotlib axes object on which to draw.</span>
</span><span id="Graphing.plot_convex_hull-478"><a href="#Graphing.plot_convex_hull-478"><span class="linenos">478</span></a><span class="sd">            data (DataFrame): A DataFrame containing points with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id="Graphing.plot_convex_hull-479"><a href="#Graphing.plot_convex_hull-479"><span class="linenos">479</span></a><span class="sd">            color (str, optional): Color of the convex hull boundary. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing.plot_convex_hull-480"><a href="#Graphing.plot_convex_hull-480"><span class="linenos">480</span></a><span class="sd">            linestyle (str, optional): Style of the hull boundary line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing.plot_convex_hull-481"><a href="#Graphing.plot_convex_hull-481"><span class="linenos">481</span></a><span class="sd">            linewidth (int, optional): Width of the hull boundary line. Defaults to 2.</span>
</span><span id="Graphing.plot_convex_hull-482"><a href="#Graphing.plot_convex_hull-482"><span class="linenos">482</span></a><span class="sd">            linealpha (float, optional): Transparency of the hull boundary line. Defaults to 0.</span>
</span><span id="Graphing.plot_convex_hull-483"><a href="#Graphing.plot_convex_hull-483"><span class="linenos">483</span></a><span class="sd">            fillalpha (float, optional): Transparency of the hull fill. Defaults to 1.</span>
</span><span id="Graphing.plot_convex_hull-484"><a href="#Graphing.plot_convex_hull-484"><span class="linenos">484</span></a>
</span><span id="Graphing.plot_convex_hull-485"><a href="#Graphing.plot_convex_hull-485"><span class="linenos">485</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_convex_hull-486"><a href="#Graphing.plot_convex_hull-486"><span class="linenos">486</span></a>
</span><span id="Graphing.plot_convex_hull-487"><a href="#Graphing.plot_convex_hull-487"><span class="linenos">487</span></a>        <span class="c1"># plot the convex hull of the employee addresses within the commute radius</span>
</span><span id="Graphing.plot_convex_hull-488"><a href="#Graphing.plot_convex_hull-488"><span class="linenos">488</span></a>        <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing.plot_convex_hull-489"><a href="#Graphing.plot_convex_hull-489"><span class="linenos">489</span></a>        <span class="k">for</span> <span class="n">simplex</span> <span class="ow">in</span> <span class="n">hull</span><span class="o">.</span><span class="n">simplices</span><span class="p">:</span>
</span><span id="Graphing.plot_convex_hull-490"><a href="#Graphing.plot_convex_hull-490"><span class="linenos">490</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">simplex</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> 
</span><span id="Graphing.plot_convex_hull-491"><a href="#Graphing.plot_convex_hull-491"><span class="linenos">491</span></a>                     <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span> 
</span></pre></div>


            <div class="docstring"><p>Draws a convex hull around a set of points on the map, effectively creating a boundary that encloses all the points.</p>

<p>Args:
    ax: The matplotlib axes object on which to draw.
    data (DataFrame): A DataFrame containing points with 'latitude' and 'longitude' columns.
    color (str, optional): Color of the convex hull boundary. Defaults to 'green'.
    linestyle (str, optional): Style of the hull boundary line. Defaults to '--'.
    linewidth (int, optional): Width of the hull boundary line. Defaults to 2.
    linealpha (float, optional): Transparency of the hull boundary line. Defaults to 0.
    fillalpha (float, optional): Transparency of the hull fill. Defaults to 1.</p>
</div>


                            </div>
                            <div id="Graphing.get_commute_values" class="classattr">
                                        <input id="Graphing.get_commute_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_commute_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">emp</span>, </span><span class="param"><span class="n">office</span>, </span><span class="param"><span class="n">commute_data</span>, </span><span class="param"><span class="n">values</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_commute_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_commute_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_commute_values-494"><a href="#Graphing.get_commute_values-494"><span class="linenos">494</span></a>    <span class="k">def</span> <span class="nf">get_commute_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
</span><span id="Graphing.get_commute_values-495"><a href="#Graphing.get_commute_values-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_commute_values-496"><a href="#Graphing.get_commute_values-496"><span class="linenos">496</span></a><span class="sd">        Extracts specified values from the commute data for employee addresses that match a given office location.</span>
</span><span id="Graphing.get_commute_values-497"><a href="#Graphing.get_commute_values-497"><span class="linenos">497</span></a>
</span><span id="Graphing.get_commute_values-498"><a href="#Graphing.get_commute_values-498"><span class="linenos">498</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_commute_values-499"><a href="#Graphing.get_commute_values-499"><span class="linenos">499</span></a><span class="sd">            emp (DataFrame): A DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_commute_values-500"><a href="#Graphing.get_commute_values-500"><span class="linenos">500</span></a><span class="sd">            office (DataFrame): A single-row DataFrame containing the target office location with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_commute_values-501"><a href="#Graphing.get_commute_values-501"><span class="linenos">501</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations.</span>
</span><span id="Graphing.get_commute_values-502"><a href="#Graphing.get_commute_values-502"><span class="linenos">502</span></a><span class="sd">            values (list of str or str): Column name(s) in `commute_data` to extract. Can be a single column name or a list of names.</span>
</span><span id="Graphing.get_commute_values-503"><a href="#Graphing.get_commute_values-503"><span class="linenos">503</span></a>
</span><span id="Graphing.get_commute_values-504"><a href="#Graphing.get_commute_values-504"><span class="linenos">504</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_commute_values-505"><a href="#Graphing.get_commute_values-505"><span class="linenos">505</span></a><span class="sd">            DataFrame: A DataFrame containing the extracted values for each employee location that matches the given office location. The DataFrame includes &#39;latitude&#39; and &#39;longitude&#39; of the employee locations and the specified `values`.</span>
</span><span id="Graphing.get_commute_values-506"><a href="#Graphing.get_commute_values-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_commute_values-507"><a href="#Graphing.get_commute_values-507"><span class="linenos">507</span></a>
</span><span id="Graphing.get_commute_values-508"><a href="#Graphing.get_commute_values-508"><span class="linenos">508</span></a>         <span class="c1"># Ensure the basic columns are always included</span>
</span><span id="Graphing.get_commute_values-509"><a href="#Graphing.get_commute_values-509"><span class="linenos">509</span></a>        <span class="n">base_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">]</span>
</span><span id="Graphing.get_commute_values-510"><a href="#Graphing.get_commute_values-510"><span class="linenos">510</span></a>        <span class="c1"># Combine base columns with user-specified columns, removing duplicates</span>
</span><span id="Graphing.get_commute_values-511"><a href="#Graphing.get_commute_values-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_commute_values-512"><a href="#Graphing.get_commute_values-512"><span class="linenos">512</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing.get_commute_values-513"><a href="#Graphing.get_commute_values-513"><span class="linenos">513</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_commute_values-514"><a href="#Graphing.get_commute_values-514"><span class="linenos">514</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="n">base_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_columns</span><span class="p">]</span>
</span><span id="Graphing.get_commute_values-515"><a href="#Graphing.get_commute_values-515"><span class="linenos">515</span></a>        
</span><span id="Graphing.get_commute_values-516"><a href="#Graphing.get_commute_values-516"><span class="linenos">516</span></a>        <span class="k">return</span> <span class="n">commute_data</span><span class="p">[(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="Graphing.get_commute_values-517"><a href="#Graphing.get_commute_values-517"><span class="linenos">517</span></a>                           <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;destination_long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">office</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> 
</span><span id="Graphing.get_commute_values-518"><a href="#Graphing.get_commute_values-518"><span class="linenos">518</span></a>                            <span class="p">(</span><span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">commute_data</span><span class="p">[</span><span class="s1">&#39;origin_long&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]))][</span><span class="n">selected_columns</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;origin_lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_long&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
</span></pre></div>


            <div class="docstring"><p>Extracts specified values from the commute data for employee addresses that match a given office location.</p>

<p>Args:
    emp (DataFrame): A DataFrame containing employee locations with 'latitude' and 'longitude'.
    office (DataFrame): A single-row DataFrame containing the target office location with 'latitude' and 'longitude'.
    commute_data (DataFrame): A DataFrame containing commute data between employee and office locations.
    values (list of str or str): Column name(s) in <code>commute_data</code> to extract. Can be a single column name or a list of names.</p>

<p>Returns:
    DataFrame: A DataFrame containing the extracted values for each employee location that matches the given office location. The DataFrame includes 'latitude' and 'longitude' of the employee locations and the specified <code>values</code>.</p>
</div>


                            </div>
                            <div id="Graphing.plot_preamble" class="classattr">
                                        <input id="Graphing.plot_preamble-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_preamble</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emp</span>,</span><span class="param">	<span class="n">offices</span>,</span><span class="param">	<span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.plot_preamble-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.plot_preamble"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.plot_preamble-521"><a href="#Graphing.plot_preamble-521"><span class="linenos">521</span></a>    <span class="k">def</span> <span class="nf">plot_preamble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Graphing.plot_preamble-522"><a href="#Graphing.plot_preamble-522"><span class="linenos">522</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.plot_preamble-523"><a href="#Graphing.plot_preamble-523"><span class="linenos">523</span></a><span class="sd">        Filters employee locations based on a specified cutoff radius from office locations and prepares data for plotting.</span>
</span><span id="Graphing.plot_preamble-524"><a href="#Graphing.plot_preamble-524"><span class="linenos">524</span></a>
</span><span id="Graphing.plot_preamble-525"><a href="#Graphing.plot_preamble-525"><span class="linenos">525</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.plot_preamble-526"><a href="#Graphing.plot_preamble-526"><span class="linenos">526</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.plot_preamble-527"><a href="#Graphing.plot_preamble-527"><span class="linenos">527</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.plot_preamble-528"><a href="#Graphing.plot_preamble-528"><span class="linenos">528</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations. Only employee locations within this radius from any office location are included.</span>
</span><span id="Graphing.plot_preamble-529"><a href="#Graphing.plot_preamble-529"><span class="linenos">529</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations. Only employee locations within this distance from any office location are included.</span>
</span><span id="Graphing.plot_preamble-530"><a href="#Graphing.plot_preamble-530"><span class="linenos">530</span></a><span class="sd">            commute_data (DataFrame): A DataFrame containing commute data between employee and office locations, required if `cutoff_distance` is specified.</span>
</span><span id="Graphing.plot_preamble-531"><a href="#Graphing.plot_preamble-531"><span class="linenos">531</span></a><span class="sd">            </span>
</span><span id="Graphing.plot_preamble-532"><a href="#Graphing.plot_preamble-532"><span class="linenos">532</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.plot_preamble-533"><a href="#Graphing.plot_preamble-533"><span class="linenos">533</span></a><span class="sd">            tuple: A tuple containing the filtered employee DataFrame, and Series objects for latitudes and longitudes of all included </span>
</span><span id="Graphing.plot_preamble-534"><a href="#Graphing.plot_preamble-534"><span class="linenos">534</span></a><span class="sd">            locations (employees and offices combined). The filtered DataFrame only includes employees within the `cutoff_radius` from </span>
</span><span id="Graphing.plot_preamble-535"><a href="#Graphing.plot_preamble-535"><span class="linenos">535</span></a><span class="sd">            any office location if specified.</span>
</span><span id="Graphing.plot_preamble-536"><a href="#Graphing.plot_preamble-536"><span class="linenos">536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.plot_preamble-537"><a href="#Graphing.plot_preamble-537"><span class="linenos">537</span></a>
</span><span id="Graphing.plot_preamble-538"><a href="#Graphing.plot_preamble-538"><span class="linenos">538</span></a>        <span class="c1"># we will use the haversine formula to calculate the distance between two lat/long pairs </span>
</span><span id="Graphing.plot_preamble-539"><a href="#Graphing.plot_preamble-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">cutoff_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.plot_preamble-540"><a href="#Graphing.plot_preamble-540"><span class="linenos">540</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_radius of any of the offices</span>
</span><span id="Graphing.plot_preamble-541"><a href="#Graphing.plot_preamble-541"><span class="linenos">541</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing.plot_preamble-542"><a href="#Graphing.plot_preamble-542"><span class="linenos">542</span></a>        <span class="k">elif</span> <span class="n">cutoff_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.plot_preamble-543"><a href="#Graphing.plot_preamble-543"><span class="linenos">543</span></a>            <span class="c1"># filter the employee lat/long pairs to only include those within cutoff_distance of any of the offices</span>
</span><span id="Graphing.plot_preamble-544"><a href="#Graphing.plot_preamble-544"><span class="linenos">544</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.plot_preamble-545"><a href="#Graphing.plot_preamble-545"><span class="linenos">545</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.plot_preamble-546"><a href="#Graphing.plot_preamble-546"><span class="linenos">546</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="n">emp</span>
</span><span id="Graphing.plot_preamble-547"><a href="#Graphing.plot_preamble-547"><span class="linenos">547</span></a>        
</span><span id="Graphing.plot_preamble-548"><a href="#Graphing.plot_preamble-548"><span class="linenos">548</span></a>        <span class="c1"># data is a pandas dataframe has coloumns latitude and longitude        </span>
</span><span id="Graphing.plot_preamble-549"><a href="#Graphing.plot_preamble-549"><span class="linenos">549</span></a>        <span class="c1"># append the office lat/longs to the employee lat/longs to get bounding box</span>
</span><span id="Graphing.plot_preamble-550"><a href="#Graphing.plot_preamble-550"><span class="linenos">550</span></a>        <span class="n">latitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing.plot_preamble-551"><a href="#Graphing.plot_preamble-551"><span class="linenos">551</span></a>        <span class="n">longitudes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">filtered_emp_points</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">offices</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]])</span>
</span><span id="Graphing.plot_preamble-552"><a href="#Graphing.plot_preamble-552"><span class="linenos">552</span></a>        <span class="k">return</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span>
</span></pre></div>


            <div class="docstring"><p>Filters employee locations based on a specified cutoff radius from office locations and prepares data for plotting.</p>

<p>Args:
    emp (DataFrame): DataFrame containing employee locations with 'latitude' and 'longitude'.
    offices (DataFrame): DataFrame containing office locations with 'latitude' and 'longitude'.
    cutoff_radius (float, optional): Radius in miles to filter employee locations. Only employee locations within this radius from any office location are included.
    cutoff_distance (float, optional): Driving distance in miles to filter employee locations. Only employee locations within this distance from any office location are included.
    commute_data (DataFrame): A DataFrame containing commute data between employee and office locations, required if <code>cutoff_distance</code> is specified.</p>

<p>Returns:
    tuple: A tuple containing the filtered employee DataFrame, and Series objects for latitudes and longitudes of all included 
    locations (employees and offices combined). The filtered DataFrame only includes employees within the <code>cutoff_radius</code> from 
    any office location if specified.</p>
</div>


                            </div>
                            <div id="Graphing.get_map_view" class="classattr">
                                        <input id="Graphing.get_map_view-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_map_view</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emp</span>,</span><span class="param">	<span class="n">offices</span>,</span><span class="param">	<span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_color</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">size_e</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">size_o</span><span class="o">=</span><span class="mi">200</span>,</span><span class="param">	<span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>,</span><span class="param">	<span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>,</span><span class="param">	<span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span>,</span><span class="param">	<span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span>,</span><span class="param">	<span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span>,</span><span class="param">	<span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_map_view-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_map_view"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_map_view-555"><a href="#Graphing.get_map_view-555"><span class="linenos">555</span></a>    <span class="k">def</span> <span class="nf">get_map_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing.get_map_view-556"><a href="#Graphing.get_map_view-556"><span class="linenos">556</span></a>                      <span class="n">commute_color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
</span><span id="Graphing.get_map_view-557"><a href="#Graphing.get_map_view-557"><span class="linenos">557</span></a>                      <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
</span><span id="Graphing.get_map_view-558"><a href="#Graphing.get_map_view-558"><span class="linenos">558</span></a>                      <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing.get_map_view-559"><a href="#Graphing.get_map_view-559"><span class="linenos">559</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_map_view-560"><a href="#Graphing.get_map_view-560"><span class="linenos">560</span></a><span class="sd">        Generates a map view showing employee and office locations, optionally with commute radius and coloring based on commute data.</span>
</span><span id="Graphing.get_map_view-561"><a href="#Graphing.get_map_view-561"><span class="linenos">561</span></a>
</span><span id="Graphing.get_map_view-562"><a href="#Graphing.get_map_view-562"><span class="linenos">562</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_map_view-563"><a href="#Graphing.get_map_view-563"><span class="linenos">563</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_map_view-564"><a href="#Graphing.get_map_view-564"><span class="linenos">564</span></a><span class="sd">            offices (DataFrame): DataFrame containing office locations with &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_map_view-565"><a href="#Graphing.get_map_view-565"><span class="linenos">565</span></a><span class="sd">            commute_data (DataFrame, optional): DataFrame containing commute data between employee and office locations. Required if commute_color is True.</span>
</span><span id="Graphing.get_map_view-566"><a href="#Graphing.get_map_view-566"><span class="linenos">566</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to filter employee locations for visualization.</span>
</span><span id="Graphing.get_map_view-567"><a href="#Graphing.get_map_view-567"><span class="linenos">567</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to filter employee locations for visualization.</span>
</span><span id="Graphing.get_map_view-568"><a href="#Graphing.get_map_view-568"><span class="linenos">568</span></a><span class="sd">            commute_radius (float, optional): Radius in miles from offices to visualize commute boundaries.</span>
</span><span id="Graphing.get_map_view-569"><a href="#Graphing.get_map_view-569"><span class="linenos">569</span></a><span class="sd">            commute_color (bool, optional): If True, colors employee locations based on commute data presence within commute_radius.</span>
</span><span id="Graphing.get_map_view-570"><a href="#Graphing.get_map_view-570"><span class="linenos">570</span></a><span class="sd">            title (str, optional): Title for the map.</span>
</span><span id="Graphing.get_map_view-571"><a href="#Graphing.get_map_view-571"><span class="linenos">571</span></a><span class="sd">            convex_hull (bool, optional): If True, draws a convex hull around employee locations within commute_radius.</span>
</span><span id="Graphing.get_map_view-572"><a href="#Graphing.get_map_view-572"><span class="linenos">572</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="Graphing.get_map_view-573"><a href="#Graphing.get_map_view-573"><span class="linenos">573</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="Graphing.get_map_view-574"><a href="#Graphing.get_map_view-574"><span class="linenos">574</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.get_map_view-575"><a href="#Graphing.get_map_view-575"><span class="linenos">575</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing.get_map_view-576"><a href="#Graphing.get_map_view-576"><span class="linenos">576</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing.get_map_view-577"><a href="#Graphing.get_map_view-577"><span class="linenos">577</span></a><span class="sd">            legend_loc (str, optional): Location of the legend on the map. Defaults to &#39;upper right&#39;.</span>
</span><span id="Graphing.get_map_view-578"><a href="#Graphing.get_map_view-578"><span class="linenos">578</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="Graphing.get_map_view-579"><a href="#Graphing.get_map_view-579"><span class="linenos">579</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="Graphing.get_map_view-580"><a href="#Graphing.get_map_view-580"><span class="linenos">580</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing.get_map_view-581"><a href="#Graphing.get_map_view-581"><span class="linenos">581</span></a><span class="sd">            font_mod (int, optional): Font size modifier for scale bar. Defaults to 1.</span>
</span><span id="Graphing.get_map_view-582"><a href="#Graphing.get_map_view-582"><span class="linenos">582</span></a>
</span><span id="Graphing.get_map_view-583"><a href="#Graphing.get_map_view-583"><span class="linenos">583</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_map_view-584"><a href="#Graphing.get_map_view-584"><span class="linenos">584</span></a><span class="sd">            tuple: A tuple containing the matplotlib plt and axes objects.</span>
</span><span id="Graphing.get_map_view-585"><a href="#Graphing.get_map_view-585"><span class="linenos">585</span></a>
</span><span id="Graphing.get_map_view-586"><a href="#Graphing.get_map_view-586"><span class="linenos">586</span></a><span class="sd">        Notes:</span>
</span><span id="Graphing.get_map_view-587"><a href="#Graphing.get_map_view-587"><span class="linenos">587</span></a><span class="sd">            - Requires `commute_data` for commute_color functionality.</span>
</span><span id="Graphing.get_map_view-588"><a href="#Graphing.get_map_view-588"><span class="linenos">588</span></a><span class="sd">            - Adjust `cutoff_radius` and `commute_radius` to fine-tune the visualization.</span>
</span><span id="Graphing.get_map_view-589"><a href="#Graphing.get_map_view-589"><span class="linenos">589</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_map_view-590"><a href="#Graphing.get_map_view-590"><span class="linenos">590</span></a>
</span><span id="Graphing.get_map_view-591"><a href="#Graphing.get_map_view-591"><span class="linenos">591</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing.get_map_view-592"><a href="#Graphing.get_map_view-592"><span class="linenos">592</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="n">cutoff_distance</span><span class="p">,</span> <span class="n">commute_data</span><span class="o">=</span><span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-593"><a href="#Graphing.get_map_view-593"><span class="linenos">593</span></a>
</span><span id="Graphing.get_map_view-594"><a href="#Graphing.get_map_view-594"><span class="linenos">594</span></a>        <span class="c1"># configure the plot</span>
</span><span id="Graphing.get_map_view-595"><a href="#Graphing.get_map_view-595"><span class="linenos">595</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">)</span>        
</span><span id="Graphing.get_map_view-596"><a href="#Graphing.get_map_view-596"><span class="linenos">596</span></a>
</span><span id="Graphing.get_map_view-597"><a href="#Graphing.get_map_view-597"><span class="linenos">597</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-598"><a href="#Graphing.get_map_view-598"><span class="linenos">598</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing.get_map_view-599"><a href="#Graphing.get_map_view-599"><span class="linenos">599</span></a>        <span class="c1"># plot the lat long points</span>
</span><span id="Graphing.get_map_view-600"><a href="#Graphing.get_map_view-600"><span class="linenos">600</span></a>        <span class="c1">#plt.plot(longitudes, latitudes, color=&#39;red&#39;, marker=&#39;*&#39;, markersize=3, linestyle=&#39;&#39;, transform=ccrs.PlateCarree())#ccrs.OSGB())</span>
</span><span id="Graphing.get_map_view-601"><a href="#Graphing.get_map_view-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">commute_color</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-602"><a href="#Graphing.get_map_view-602"><span class="linenos">602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-603"><a href="#Graphing.get_map_view-603"><span class="linenos">603</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-604"><a href="#Graphing.get_map_view-604"><span class="linenos">604</span></a>            
</span><span id="Graphing.get_map_view-605"><a href="#Graphing.get_map_view-605"><span class="linenos">605</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-606"><a href="#Graphing.get_map_view-606"><span class="linenos">606</span></a>            <span class="c1"># plot the lat long points with color based on if the employee is within the linear radius of any of the offices</span>
</span><span id="Graphing.get_map_view-607"><a href="#Graphing.get_map_view-607"><span class="linenos">607</span></a>            <span class="c1"># first create two new data frames for the employees within and outside the linear radius, and populate them with the appropriate lat/long pairs</span>
</span><span id="Graphing.get_map_view-608"><a href="#Graphing.get_map_view-608"><span class="linenos">608</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-609"><a href="#Graphing.get_map_view-609"><span class="linenos">609</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_radius</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-610"><a href="#Graphing.get_map_view-610"><span class="linenos">610</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="Graphing.get_map_view-611"><a href="#Graphing.get_map_view-611"><span class="linenos">611</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-612"><a href="#Graphing.get_map_view-612"><span class="linenos">612</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Within &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-613"><a href="#Graphing.get_map_view-613"><span class="linenos">613</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-614"><a href="#Graphing.get_map_view-614"><span class="linenos">614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Outside &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Radius&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-615"><a href="#Graphing.get_map_view-615"><span class="linenos">615</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-616"><a href="#Graphing.get_map_view-616"><span class="linenos">616</span></a>            
</span><span id="Graphing.get_map_view-617"><a href="#Graphing.get_map_view-617"><span class="linenos">617</span></a>        <span class="k">elif</span> <span class="n">commute_color</span> <span class="ow">and</span> <span class="n">commute_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-618"><a href="#Graphing.get_map_view-618"><span class="linenos">618</span></a>            <span class="c1"># use the commute data to use actual driving distance to color the data points</span>
</span><span id="Graphing.get_map_view-619"><a href="#Graphing.get_map_view-619"><span class="linenos">619</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-620"><a href="#Graphing.get_map_view-620"><span class="linenos">620</span></a>            <span class="n">emp_outside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">inside</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-621"><a href="#Graphing.get_map_view-621"><span class="linenos">621</span></a>            <span class="c1"># plot the lat long points</span>
</span><span id="Graphing.get_map_view-622"><a href="#Graphing.get_map_view-622"><span class="linenos">622</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_within</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-623"><a href="#Graphing.get_map_view-623"><span class="linenos">623</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color_e_in</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\N{LESS-THAN OR EQUAL TO}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-624"><a href="#Graphing.get_map_view-624"><span class="linenos">624</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">emp_outside</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-625"><a href="#Graphing.get_map_view-625"><span class="linenos">625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_outside</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_e_out</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">e_label</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Drive&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-626"><a href="#Graphing.get_map_view-626"><span class="linenos">626</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_o</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">o_label</span><span class="p">)</span>          
</span><span id="Graphing.get_map_view-627"><a href="#Graphing.get_map_view-627"><span class="linenos">627</span></a>
</span><span id="Graphing.get_map_view-628"><a href="#Graphing.get_map_view-628"><span class="linenos">628</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing.get_map_view-629"><a href="#Graphing.get_map_view-629"><span class="linenos">629</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-630"><a href="#Graphing.get_map_view-630"><span class="linenos">630</span></a>        
</span><span id="Graphing.get_map_view-631"><a href="#Graphing.get_map_view-631"><span class="linenos">631</span></a>        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="Graphing.get_map_view-632"><a href="#Graphing.get_map_view-632"><span class="linenos">632</span></a>        <span class="c1"># draw a circle around the office locations to represent the radius from each office and add legend entry, if commute_radius is not None</span>
</span><span id="Graphing.get_map_view-633"><a href="#Graphing.get_map_view-633"><span class="linenos">633</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-634"><a href="#Graphing.get_map_view-634"><span class="linenos">634</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-635"><a href="#Graphing.get_map_view-635"><span class="linenos">635</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Linear Radius </span><span class="se">\n</span><span class="s1">(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; miles)&#39;</span>
</span><span id="Graphing.get_map_view-636"><a href="#Graphing.get_map_view-636"><span class="linenos">636</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-637"><a href="#Graphing.get_map_view-637"><span class="linenos">637</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-638"><a href="#Graphing.get_map_view-638"><span class="linenos">638</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_elines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">offices</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-639"><a href="#Graphing.get_map_view-639"><span class="linenos">639</span></a>        
</span><span id="Graphing.get_map_view-640"><a href="#Graphing.get_map_view-640"><span class="linenos">640</span></a>        <span class="k">if</span> <span class="n">convex_hull</span> <span class="ow">and</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-641"><a href="#Graphing.get_map_view-641"><span class="linenos">641</span></a>            <span class="n">new_handle</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Convex Hull&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-642"><a href="#Graphing.get_map_view-642"><span class="linenos">642</span></a>            <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;Bounding Area, </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">commute_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Mile Commute&#39;</span>
</span><span id="Graphing.get_map_view-643"><a href="#Graphing.get_map_view-643"><span class="linenos">643</span></a>            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-644"><a href="#Graphing.get_map_view-644"><span class="linenos">644</span></a>            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-645"><a href="#Graphing.get_map_view-645"><span class="linenos">645</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-646"><a href="#Graphing.get_map_view-646"><span class="linenos">646</span></a>            
</span><span id="Graphing.get_map_view-647"><a href="#Graphing.get_map_view-647"><span class="linenos">647</span></a>        <span class="c1"># add a legend  to the plot on the middle left</span>
</span><span id="Graphing.get_map_view-648"><a href="#Graphing.get_map_view-648"><span class="linenos">648</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">map_view_standard_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span><span class="n">legend_loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-649"><a href="#Graphing.get_map_view-649"><span class="linenos">649</span></a>        <span class="c1"># add a title</span>
</span><span id="Graphing.get_map_view-650"><a href="#Graphing.get_map_view-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_map_view-651"><a href="#Graphing.get_map_view-651"><span class="linenos">651</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_map_view-652"><a href="#Graphing.get_map_view-652"><span class="linenos">652</span></a>
</span><span id="Graphing.get_map_view-653"><a href="#Graphing.get_map_view-653"><span class="linenos">653</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Generates a map view showing employee and office locations, optionally with commute radius and coloring based on commute data.</p>

<pre><code>    Args:
        emp (DataFrame): DataFrame containing employee locations with 'latitude' and 'longitude'.
        offices (DataFrame): DataFrame containing office locations with 'latitude' and 'longitude'.
        commute_data (DataFrame, optional): DataFrame containing commute data between employee and office locations. Required if commute_color is True.
        cutoff_radius (float, optional): Radius in miles to filter employee locations for visualization.
        cutoff_distance (float, optional): Driving distance in miles to filter employee locations for visualization.
        commute_radius (float, optional): Radius in miles from offices to visualize commute boundaries.
        commute_color (bool, optional): If True, colors employee locations based on commute data presence within commute_radius.
        title (str, optional): Title for the map.
        convex_hull (bool, optional): If True, draws a convex hull around employee locations within commute_radius.
        size_e (int, optional): Size of markers for employee locations. Defaults to 10.
        size_o (int, optional): Size of markers for office locations. Defaults to 200.
        color_o (str, optional): Color for office location markers. Defaults to 'black'.
        color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to 'green'.
        color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to 'red'.
        legend_loc (str, optional): Location of the legend on the map. Defaults to 'upper right'.
        o_label (str, optional): Label for office locations in the legend. Defaults to 'Potential Office
</code></pre>

<p>Locations'.
            e_label (str, optional): Label for employee locations in the legend. Defaults to 'Employee Addresses'.
            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.
            font_mod (int, optional): Font size modifier for scale bar. Defaults to 1.</p>

<pre><code>    Returns:
        tuple: A tuple containing the matplotlib plt and axes objects.

    Notes:
        - Requires `commute_data` for commute_color functionality.
        - Adjust `cutoff_radius` and `commute_radius` to fine-tune the visualization.
</code></pre>
</div>


                            </div>
                            <div id="Graphing.map_view_standard_legend" class="classattr">
                                        <input id="Graphing.map_view_standard_legend-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_view_standard_legend</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ax</span>,</span><span class="param">	<span class="n">handles</span>,</span><span class="param">	<span class="n">labels</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span>,</span><span class="param">	<span class="n">legend_edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">legend_frameon</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">legend_facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>,</span><span class="param">	<span class="n">legend_framealpha</span><span class="o">=</span><span class="mf">0.7</span>,</span><span class="param">	<span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.map_view_standard_legend-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.map_view_standard_legend"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.map_view_standard_legend-655"><a href="#Graphing.map_view_standard_legend-655"><span class="linenos">655</span></a>    <span class="k">def</span> <span class="nf">map_view_standard_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> 
</span><span id="Graphing.map_view_standard_legend-656"><a href="#Graphing.map_view_standard_legend-656"><span class="linenos">656</span></a>                                 <span class="n">legend_edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
</span><span id="Graphing.map_view_standard_legend-657"><a href="#Graphing.map_view_standard_legend-657"><span class="linenos">657</span></a>                                 <span class="n">legend_framealpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="Graphing.map_view_standard_legend-658"><a href="#Graphing.map_view_standard_legend-658"><span class="linenos">658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.map_view_standard_legend-659"><a href="#Graphing.map_view_standard_legend-659"><span class="linenos">659</span></a><span class="sd">        Adds a standard legend to a map view plot.</span>
</span><span id="Graphing.map_view_standard_legend-660"><a href="#Graphing.map_view_standard_legend-660"><span class="linenos">660</span></a>
</span><span id="Graphing.map_view_standard_legend-661"><a href="#Graphing.map_view_standard_legend-661"><span class="linenos">661</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.map_view_standard_legend-662"><a href="#Graphing.map_view_standard_legend-662"><span class="linenos">662</span></a><span class="sd">            ax: The matplotlib axes object on which to draw the legend.</span>
</span><span id="Graphing.map_view_standard_legend-663"><a href="#Graphing.map_view_standard_legend-663"><span class="linenos">663</span></a><span class="sd">            handles (list): A list of handles to the objects being represented in the legend.</span>
</span><span id="Graphing.map_view_standard_legend-664"><a href="#Graphing.map_view_standard_legend-664"><span class="linenos">664</span></a><span class="sd">            labels (list): A list of labels for the objects being represented in the legend.</span>
</span><span id="Graphing.map_view_standard_legend-665"><a href="#Graphing.map_view_standard_legend-665"><span class="linenos">665</span></a><span class="sd">            title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="Graphing.map_view_standard_legend-666"><a href="#Graphing.map_view_standard_legend-666"><span class="linenos">666</span></a><span class="sd">            legend_title (str, optional): Title for the legend. Defaults to None.</span>
</span><span id="Graphing.map_view_standard_legend-667"><a href="#Graphing.map_view_standard_legend-667"><span class="linenos">667</span></a><span class="sd">            legend_loc (str, optional): Location for the legend. Defaults to &#39;upper left&#39;.</span>
</span><span id="Graphing.map_view_standard_legend-668"><a href="#Graphing.map_view_standard_legend-668"><span class="linenos">668</span></a><span class="sd">            legend_labels (list, optional): Labels for the legend entries. Defaults to None.</span>
</span><span id="Graphing.map_view_standard_legend-669"><a href="#Graphing.map_view_standard_legend-669"><span class="linenos">669</span></a><span class="sd">            legend_colors (list, optional): Colors for the legend entries. Defaults to None.</span>
</span><span id="Graphing.map_view_standard_legend-670"><a href="#Graphing.map_view_standard_legend-670"><span class="linenos">670</span></a><span class="sd">            legend_markers (list, optional): Markers for the legend entries. Defaults to None.</span>
</span><span id="Graphing.map_view_standard_legend-671"><a href="#Graphing.map_view_standard_legend-671"><span class="linenos">671</span></a><span class="sd">            legend_edgecolor (str, optional): Edge color for the legend. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.map_view_standard_legend-672"><a href="#Graphing.map_view_standard_legend-672"><span class="linenos">672</span></a><span class="sd">            legend_frameon (bool, optional): Whether to draw a frame around the legend. Defaults to True.</span>
</span><span id="Graphing.map_view_standard_legend-673"><a href="#Graphing.map_view_standard_legend-673"><span class="linenos">673</span></a><span class="sd">            legend_facecolor (str, optional): Face color for the legend. Defaults to &#39;white&#39;.</span>
</span><span id="Graphing.map_view_standard_legend-674"><a href="#Graphing.map_view_standard_legend-674"><span class="linenos">674</span></a><span class="sd">            legend_framealpha (float, optional): Opacity of the legend frame. Defaults to 0.7.</span>
</span><span id="Graphing.map_view_standard_legend-675"><a href="#Graphing.map_view_standard_legend-675"><span class="linenos">675</span></a><span class="sd">            fontsize (int, optional): Font size for the legend. Defaults to 10.</span>
</span><span id="Graphing.map_view_standard_legend-676"><a href="#Graphing.map_view_standard_legend-676"><span class="linenos">676</span></a>
</span><span id="Graphing.map_view_standard_legend-677"><a href="#Graphing.map_view_standard_legend-677"><span class="linenos">677</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.map_view_standard_legend-678"><a href="#Graphing.map_view_standard_legend-678"><span class="linenos">678</span></a>        
</span><span id="Graphing.map_view_standard_legend-679"><a href="#Graphing.map_view_standard_legend-679"><span class="linenos">679</span></a>        <span class="c1"># Add legend to the plot</span>
</span><span id="Graphing.map_view_standard_legend-680"><a href="#Graphing.map_view_standard_legend-680"><span class="linenos">680</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">legend_edgecolor</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="n">legend_frameon</span><span class="p">,</span> 
</span><span id="Graphing.map_view_standard_legend-681"><a href="#Graphing.map_view_standard_legend-681"><span class="linenos">681</span></a>                  <span class="n">facecolor</span><span class="o">=</span><span class="n">legend_facecolor</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="n">legend_framealpha</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds a standard legend to a map view plot.</p>

<p>Args:
    ax: The matplotlib axes object on which to draw the legend.
    handles (list): A list of handles to the objects being represented in the legend.
    labels (list): A list of labels for the objects being represented in the legend.
    title (str, optional): Title for the legend. Defaults to None.
    legend_title (str, optional): Title for the legend. Defaults to None.
    legend_loc (str, optional): Location for the legend. Defaults to 'upper left'.
    legend_labels (list, optional): Labels for the legend entries. Defaults to None.
    legend_colors (list, optional): Colors for the legend entries. Defaults to None.
    legend_markers (list, optional): Markers for the legend entries. Defaults to None.
    legend_edgecolor (str, optional): Edge color for the legend. Defaults to 'black'.
    legend_frameon (bool, optional): Whether to draw a frame around the legend. Defaults to True.
    legend_facecolor (str, optional): Face color for the legend. Defaults to 'white'.
    legend_framealpha (float, optional): Opacity of the legend frame. Defaults to 0.7.
    fontsize (int, optional): Font size for the legend. Defaults to 10.</p>
</div>


                            </div>
                            <div id="Graphing.get_heatmap" class="classattr">
                                        <input id="Graphing.get_heatmap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_heatmap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emp</span>,</span><span class="param">	<span class="n">office</span>,</span><span class="param">	<span class="n">commute_data</span>,</span><span class="param">	<span class="n">value</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">imagery</span><span class="o">=</span><span class="s1">&#39;OSM&#39;</span>,</span><span class="param">	<span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span>,</span><span class="param">	<span class="n">size_e</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">size_o</span><span class="o">=</span><span class="mi">200</span>,</span><span class="param">	<span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>,</span><span class="param">	<span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>,</span><span class="param">	<span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span>,</span><span class="param">	<span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span>,</span><span class="param">	<span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>,</span><span class="param">	<span class="n">levels</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_heatmap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_heatmap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_heatmap-687"><a href="#Graphing.get_heatmap-687"><span class="linenos">687</span></a>    <span class="k">def</span> <span class="nf">get_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff_distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Graphing.get_heatmap-688"><a href="#Graphing.get_heatmap-688"><span class="linenos">688</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convex_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="s2">&quot;OSM&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
</span><span id="Graphing.get_heatmap-689"><a href="#Graphing.get_heatmap-689"><span class="linenos">689</span></a>                    <span class="n">size_e</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size_o</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_o</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color_e_in</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">color_e_out</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">o_label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">,</span> 
</span><span id="Graphing.get_heatmap-690"><a href="#Graphing.get_heatmap-690"><span class="linenos">690</span></a>                    <span class="n">e_label</span><span class="o">=</span><span class="s1">&#39;Employee Addresses&#39;</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)):</span>
</span><span id="Graphing.get_heatmap-691"><a href="#Graphing.get_heatmap-691"><span class="linenos">691</span></a>
</span><span id="Graphing.get_heatmap-692"><a href="#Graphing.get_heatmap-692"><span class="linenos">692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_heatmap-693"><a href="#Graphing.get_heatmap-693"><span class="linenos">693</span></a><span class="sd">        Generates a heatmap of a specific commute data metric for employee locations relative to a single office location.</span>
</span><span id="Graphing.get_heatmap-694"><a href="#Graphing.get_heatmap-694"><span class="linenos">694</span></a>
</span><span id="Graphing.get_heatmap-695"><a href="#Graphing.get_heatmap-695"><span class="linenos">695</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_heatmap-696"><a href="#Graphing.get_heatmap-696"><span class="linenos">696</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_heatmap-697"><a href="#Graphing.get_heatmap-697"><span class="linenos">697</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_heatmap-698"><a href="#Graphing.get_heatmap-698"><span class="linenos">698</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="Graphing.get_heatmap-699"><a href="#Graphing.get_heatmap-699"><span class="linenos">699</span></a><span class="sd">            value (str): The name of the column in `commute_data` representing the metric to visualize on the heatmap.</span>
</span><span id="Graphing.get_heatmap-700"><a href="#Graphing.get_heatmap-700"><span class="linenos">700</span></a><span class="sd">            title (str, optional): Title for the heatmap. Defaults to None.</span>
</span><span id="Graphing.get_heatmap-701"><a href="#Graphing.get_heatmap-701"><span class="linenos">701</span></a><span class="sd">            value_label (str, optional): Label for the color bar indicating the metric. Defaults to &#39;&#39;.</span>
</span><span id="Graphing.get_heatmap-702"><a href="#Graphing.get_heatmap-702"><span class="linenos">702</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="Graphing.get_heatmap-703"><a href="#Graphing.get_heatmap-703"><span class="linenos">703</span></a><span class="sd">            cutoff_distance (float, optional): Driving distance in miles to include employee locations from the office for the heatmap. Defaults to None.</span>
</span><span id="Graphing.get_heatmap-704"><a href="#Graphing.get_heatmap-704"><span class="linenos">704</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the heatmap. Defaults to None.</span>
</span><span id="Graphing.get_heatmap-705"><a href="#Graphing.get_heatmap-705"><span class="linenos">705</span></a><span class="sd">            convex_hull (bool, optional): If True, draw a convex hull around the employee locations included in the heatmap. Defaults to False.</span>
</span><span id="Graphing.get_heatmap-706"><a href="#Graphing.get_heatmap-706"><span class="linenos">706</span></a><span class="sd">            plot_points (bool, optional): If True, plot individual employee locations on the heatmap. Defaults to False.</span>
</span><span id="Graphing.get_heatmap-707"><a href="#Graphing.get_heatmap-707"><span class="linenos">707</span></a><span class="sd">            imagery (str, optional): Background map style. Supports &quot;OSM&quot; for OpenStreetMap and &quot;Google&quot; for Google Maps tiles. Defaults to &quot;OSM&quot;.</span>
</span><span id="Graphing.get_heatmap-708"><a href="#Graphing.get_heatmap-708"><span class="linenos">708</span></a><span class="sd">            cmap (str, optional): Colormap for the heatmap. Defaults to &#39;jet&#39;.</span>
</span><span id="Graphing.get_heatmap-709"><a href="#Graphing.get_heatmap-709"><span class="linenos">709</span></a><span class="sd">            size_e (int, optional): Size of markers for employee locations. Defaults to 10.</span>
</span><span id="Graphing.get_heatmap-710"><a href="#Graphing.get_heatmap-710"><span class="linenos">710</span></a><span class="sd">            size_o (int, optional): Size of markers for office locations. Defaults to 200.</span>
</span><span id="Graphing.get_heatmap-711"><a href="#Graphing.get_heatmap-711"><span class="linenos">711</span></a><span class="sd">            color_o (str, optional): Color for office location markers. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.get_heatmap-712"><a href="#Graphing.get_heatmap-712"><span class="linenos">712</span></a><span class="sd">            color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to &#39;green&#39;.</span>
</span><span id="Graphing.get_heatmap-713"><a href="#Graphing.get_heatmap-713"><span class="linenos">713</span></a><span class="sd">            color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to &#39;red&#39;.</span>
</span><span id="Graphing.get_heatmap-714"><a href="#Graphing.get_heatmap-714"><span class="linenos">714</span></a><span class="sd">            o_label (str, optional): Label for office locations in the legend. Defaults to &#39;Potential Office \nLocations&#39;.</span>
</span><span id="Graphing.get_heatmap-715"><a href="#Graphing.get_heatmap-715"><span class="linenos">715</span></a><span class="sd">            e_label (str, optional): Label for employee locations in the legend. Defaults to &#39;Employee Addresses&#39;.</span>
</span><span id="Graphing.get_heatmap-716"><a href="#Graphing.get_heatmap-716"><span class="linenos">716</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing.get_heatmap-717"><a href="#Graphing.get_heatmap-717"><span class="linenos">717</span></a><span class="sd">            alpha (float, optional): Transparency of the heatmap. Defaults to 0.5.</span>
</span><span id="Graphing.get_heatmap-718"><a href="#Graphing.get_heatmap-718"><span class="linenos">718</span></a><span class="sd">            levels (int, optional): Number of levels for the color bar. Defaults to 10.</span>
</span><span id="Graphing.get_heatmap-719"><a href="#Graphing.get_heatmap-719"><span class="linenos">719</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing.get_heatmap-720"><a href="#Graphing.get_heatmap-720"><span class="linenos">720</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="Graphing.get_heatmap-721"><a href="#Graphing.get_heatmap-721"><span class="linenos">721</span></a>
</span><span id="Graphing.get_heatmap-722"><a href="#Graphing.get_heatmap-722"><span class="linenos">722</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_heatmap-723"><a href="#Graphing.get_heatmap-723"><span class="linenos">723</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing.get_heatmap-724"><a href="#Graphing.get_heatmap-724"><span class="linenos">724</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_heatmap-725"><a href="#Graphing.get_heatmap-725"><span class="linenos">725</span></a>
</span><span id="Graphing.get_heatmap-726"><a href="#Graphing.get_heatmap-726"><span class="linenos">726</span></a>        
</span><span id="Graphing.get_heatmap-727"><a href="#Graphing.get_heatmap-727"><span class="linenos">727</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing.get_heatmap-728"><a href="#Graphing.get_heatmap-728"><span class="linenos">728</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-729"><a href="#Graphing.get_heatmap-729"><span class="linenos">729</span></a>    
</span><span id="Graphing.get_heatmap-730"><a href="#Graphing.get_heatmap-730"><span class="linenos">730</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="Graphing.get_heatmap-731"><a href="#Graphing.get_heatmap-731"><span class="linenos">731</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="Graphing.get_heatmap-732"><a href="#Graphing.get_heatmap-732"><span class="linenos">732</span></a>        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-733"><a href="#Graphing.get_heatmap-733"><span class="linenos">733</span></a>        <span class="c1"># plot a) heatmap of a data value relative to employee addresses and a target office location</span>
</span><span id="Graphing.get_heatmap-734"><a href="#Graphing.get_heatmap-734"><span class="linenos">734</span></a>        
</span><span id="Graphing.get_heatmap-735"><a href="#Graphing.get_heatmap-735"><span class="linenos">735</span></a>        <span class="c1"># create an np array of the lat long pairs and the value</span>
</span><span id="Graphing.get_heatmap-736"><a href="#Graphing.get_heatmap-736"><span class="linenos">736</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configure_map_plot</span><span class="p">(</span><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">,</span> <span class="n">imagery</span><span class="o">=</span><span class="n">imagery</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-737"><a href="#Graphing.get_heatmap-737"><span class="linenos">737</span></a>
</span><span id="Graphing.get_heatmap-738"><a href="#Graphing.get_heatmap-738"><span class="linenos">738</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_heatmap-739"><a href="#Graphing.get_heatmap-739"><span class="linenos">739</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing.get_heatmap-740"><a href="#Graphing.get_heatmap-740"><span class="linenos">740</span></a>
</span><span id="Graphing.get_heatmap-741"><a href="#Graphing.get_heatmap-741"><span class="linenos">741</span></a>        <span class="c1"># Create the heatmap</span>
</span><span id="Graphing.get_heatmap-742"><a href="#Graphing.get_heatmap-742"><span class="linenos">742</span></a>        <span class="c1">#plt.tricontourf(X, Y, Z, cmap=&#39;jet&#39;, levels=10, alpha=0.7, transform=ccrs.PlateCarree())</span>
</span><span id="Graphing.get_heatmap-743"><a href="#Graphing.get_heatmap-743"><span class="linenos">743</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">value</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Graphing.get_heatmap-744"><a href="#Graphing.get_heatmap-744"><span class="linenos">744</span></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">value_label</span><span class="p">)</span>  <span class="c1"># Add a color bar to show the temperature scale</span>
</span><span id="Graphing.get_heatmap-745"><a href="#Graphing.get_heatmap-745"><span class="linenos">745</span></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-746"><a href="#Graphing.get_heatmap-746"><span class="linenos">746</span></a>        
</span><span id="Graphing.get_heatmap-747"><a href="#Graphing.get_heatmap-747"><span class="linenos">747</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">convex_hull</span><span class="p">:</span>
</span><span id="Graphing.get_heatmap-748"><a href="#Graphing.get_heatmap-748"><span class="linenos">748</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing.get_heatmap-749"><a href="#Graphing.get_heatmap-749"><span class="linenos">749</span></a>            <span class="n">emp_within</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-750"><a href="#Graphing.get_heatmap-750"><span class="linenos">750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_convex_hull</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">emp_within</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-751"><a href="#Graphing.get_heatmap-751"><span class="linenos">751</span></a>        
</span><span id="Graphing.get_heatmap-752"><a href="#Graphing.get_heatmap-752"><span class="linenos">752</span></a>        <span class="k">if</span> <span class="n">plot_points</span><span class="p">:</span>
</span><span id="Graphing.get_heatmap-753"><a href="#Graphing.get_heatmap-753"><span class="linenos">753</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_addresses</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_e</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Employee </span><span class="se">\n</span><span class="s1">Addresses&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-754"><a href="#Graphing.get_heatmap-754"><span class="linenos">754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_offices</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_o</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Potential Office </span><span class="se">\n</span><span class="s1">Locations&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-755"><a href="#Graphing.get_heatmap-755"><span class="linenos">755</span></a>
</span><span id="Graphing.get_heatmap-756"><a href="#Graphing.get_heatmap-756"><span class="linenos">756</span></a>
</span><span id="Graphing.get_heatmap-757"><a href="#Graphing.get_heatmap-757"><span class="linenos">757</span></a>        <span class="c1"># add a scale bar</span>
</span><span id="Graphing.get_heatmap-758"><a href="#Graphing.get_heatmap-758"><span class="linenos">758</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span><span class="n">font_mod</span><span class="o">=</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-759"><a href="#Graphing.get_heatmap-759"><span class="linenos">759</span></a>        <span class="c1"># add a title</span>
</span><span id="Graphing.get_heatmap-760"><a href="#Graphing.get_heatmap-760"><span class="linenos">760</span></a>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_heatmap-761"><a href="#Graphing.get_heatmap-761"><span class="linenos">761</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_heatmap-762"><a href="#Graphing.get_heatmap-762"><span class="linenos">762</span></a>        
</span><span id="Graphing.get_heatmap-763"><a href="#Graphing.get_heatmap-763"><span class="linenos">763</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Generates a heatmap of a specific commute data metric for employee locations relative to a single office location.</p>

<pre><code>    Args:
        emp (DataFrame): DataFrame containing employee locations with columns 'latitude' and 'longitude'.
        office (DataFrame): Single-row DataFrame representing the target office location with columns 'latitude' and 'longitude'.
        commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.
        value (str): The name of the column in `commute_data` representing the metric to visualize on the heatmap.
        title (str, optional): Title for the heatmap. Defaults to None.
        value_label (str, optional): Label for the color bar indicating the metric. Defaults to ''.
        cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the heatmap. Defaults to None.
        cutoff_distance (float, optional): Driving distance in miles to include employee locations from the office for the heatmap. Defaults to None.
        commute_radius (float, optional): Specifies the radius within which employees are considered for the heatmap. Defaults to None.
        convex_hull (bool, optional): If True, draw a convex hull around the employee locations included in the heatmap. Defaults to False.
        plot_points (bool, optional): If True, plot individual employee locations on the heatmap. Defaults to False.
        imagery (str, optional): Background map style. Supports "OSM" for OpenStreetMap and "Google" for Google Maps tiles. Defaults to "OSM".
        cmap (str, optional): Colormap for the heatmap. Defaults to 'jet'.
        size_e (int, optional): Size of markers for employee locations. Defaults to 10.
        size_o (int, optional): Size of markers for office locations. Defaults to 200.
        color_o (str, optional): Color for office location markers. Defaults to 'black'.
        color_e_in (str, optional): Color for employee locations within commute_radius. Defaults to 'green'.
        color_e_out (str, optional): Color for employee locations outside commute_radius. Defaults to 'red'.
        o_label (str, optional): Label for office locations in the legend. Defaults to 'Potential Office
</code></pre>

<p>Locations'.
            e_label (str, optional): Label for employee locations in the legend. Defaults to 'Employee Addresses'.
            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.
            alpha (float, optional): Transparency of the heatmap. Defaults to 0.5.
            levels (int, optional): Number of levels for the color bar. Defaults to 10.
            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.
            figsize (tuple, optional): Figure size. Defaults to (15, 15).</p>

<pre><code>    Returns:
        tuple: A tuple containing the matplotlib figure and axes objects.
</code></pre>
</div>


                            </div>
                            <div id="Graphing.get_histogram" class="classattr">
                                        <input id="Graphing.get_histogram-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_histogram</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emp</span>,</span><span class="param">	<span class="n">office</span>,</span><span class="param">	<span class="n">commute_data</span>,</span><span class="param">	<span class="n">values</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">bins</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">rows</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">cols</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>,</span><span class="param">	<span class="n">column_titles</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cumulative_line</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cumulative_y_label</span><span class="o">=</span><span class="s1">&#39;Cumulative %&#39;</span>,</span><span class="param">	<span class="n">cumulative_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>,</span><span class="param">	<span class="n">cumulative_linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span>,</span><span class="param">	<span class="n">cumulative_linewidth</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">cumulative_markers</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cumulative_as_percentage</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">override_values</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">sharex</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">sharey</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_histogram-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_histogram"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_histogram-767"><a href="#Graphing.get_histogram-767"><span class="linenos">767</span></a>    <span class="k">def</span> <span class="nf">get_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing.get_histogram-768"><a href="#Graphing.get_histogram-768"><span class="linenos">768</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">column_titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cumulative_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_y_label</span><span class="o">=</span><span class="s2">&quot;Cumulative %&quot;</span><span class="p">,</span>
</span><span id="Graphing.get_histogram-769"><a href="#Graphing.get_histogram-769"><span class="linenos">769</span></a>                    <span class="n">cumulative_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cumulative_linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">cumulative_linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cumulative_markers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_as_percentage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Graphing.get_histogram-770"><a href="#Graphing.get_histogram-770"><span class="linenos">770</span></a>                    <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Graphing.get_histogram-771"><a href="#Graphing.get_histogram-771"><span class="linenos">771</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_histogram-772"><a href="#Graphing.get_histogram-772"><span class="linenos">772</span></a><span class="sd">        Generates a histogram (or set of histograms) for specified commute data metrics for employee locations relative to a single office location.</span>
</span><span id="Graphing.get_histogram-773"><a href="#Graphing.get_histogram-773"><span class="linenos">773</span></a>
</span><span id="Graphing.get_histogram-774"><a href="#Graphing.get_histogram-774"><span class="linenos">774</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_histogram-775"><a href="#Graphing.get_histogram-775"><span class="linenos">775</span></a><span class="sd">            emp (DataFrame): DataFrame containing employee locations with columns &#39;latitude&#39; and &#39;longitude&#39;.</span>
</span><span id="Graphing.get_histogram-776"><a href="#Graphing.get_histogram-776"><span class="linenos">776</span></a><span class="sd">            office (DataFrame): Single-row DataFrame representing the target office location.</span>
</span><span id="Graphing.get_histogram-777"><a href="#Graphing.get_histogram-777"><span class="linenos">777</span></a><span class="sd">            commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.</span>
</span><span id="Graphing.get_histogram-778"><a href="#Graphing.get_histogram-778"><span class="linenos">778</span></a><span class="sd">            values (list of str): Names of the columns in `commute_data` representing the metrics to visualize in the histograms.</span>
</span><span id="Graphing.get_histogram-779"><a href="#Graphing.get_histogram-779"><span class="linenos">779</span></a><span class="sd">            title (str, optional): Main title for the histogram plot(s). Defaults to None.</span>
</span><span id="Graphing.get_histogram-780"><a href="#Graphing.get_histogram-780"><span class="linenos">780</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="Graphing.get_histogram-781"><a href="#Graphing.get_histogram-781"><span class="linenos">781</span></a><span class="sd">            value_label (str, optional): Label for the metric values. Defaults to &#39;&#39;.</span>
</span><span id="Graphing.get_histogram-782"><a href="#Graphing.get_histogram-782"><span class="linenos">782</span></a><span class="sd">            x_label (str, optional): Label for the x-axis. Defaults to &#39;&#39;.</span>
</span><span id="Graphing.get_histogram-783"><a href="#Graphing.get_histogram-783"><span class="linenos">783</span></a><span class="sd">            y_label (str, optional): Label for the y-axis. Defaults to &#39;&#39;.</span>
</span><span id="Graphing.get_histogram-784"><a href="#Graphing.get_histogram-784"><span class="linenos">784</span></a><span class="sd">            cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the histograms. Defaults to None.</span>
</span><span id="Graphing.get_histogram-785"><a href="#Graphing.get_histogram-785"><span class="linenos">785</span></a><span class="sd">            commute_radius (float, optional): Specifies the radius within which employees are considered for the histograms. Defaults to None.</span>
</span><span id="Graphing.get_histogram-786"><a href="#Graphing.get_histogram-786"><span class="linenos">786</span></a><span class="sd">            bins (int, optional): Number of bins for the histograms. Defaults to 10.</span>
</span><span id="Graphing.get_histogram-787"><a href="#Graphing.get_histogram-787"><span class="linenos">787</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing.get_histogram-788"><a href="#Graphing.get_histogram-788"><span class="linenos">788</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing.get_histogram-789"><a href="#Graphing.get_histogram-789"><span class="linenos">789</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to (15, 15).</span>
</span><span id="Graphing.get_histogram-790"><a href="#Graphing.get_histogram-790"><span class="linenos">790</span></a><span class="sd">            column_titles (list of str, optional): Titles for each subplot column. Defaults to None.</span>
</span><span id="Graphing.get_histogram-791"><a href="#Graphing.get_histogram-791"><span class="linenos">791</span></a><span class="sd">            cumulative_line (bool, optional): If True, add a cumulative percentage line to the histograms. Defaults to False.</span>
</span><span id="Graphing.get_histogram-792"><a href="#Graphing.get_histogram-792"><span class="linenos">792</span></a><span class="sd">            cumulative_y_label (str, optional): Label for the cumulative percentage y-axis. Defaults to &quot;Cumulative %&quot;.</span>
</span><span id="Graphing.get_histogram-793"><a href="#Graphing.get_histogram-793"><span class="linenos">793</span></a><span class="sd">            cumulative_color (str, optional): Color for the cumulative line. Defaults to &#39;black&#39;.</span>
</span><span id="Graphing.get_histogram-794"><a href="#Graphing.get_histogram-794"><span class="linenos">794</span></a><span class="sd">            cumulative_linestyle (str, optional): Line style for the cumulative line. Defaults to &#39;--&#39;.</span>
</span><span id="Graphing.get_histogram-795"><a href="#Graphing.get_histogram-795"><span class="linenos">795</span></a><span class="sd">            cumulative_linewidth (int, optional): Line width for the cumulative line. Defaults to 1.</span>
</span><span id="Graphing.get_histogram-796"><a href="#Graphing.get_histogram-796"><span class="linenos">796</span></a><span class="sd">            cumulative_markers (dict, optional): Dictionary specifying markers for specific cumulative percentages on the line. Format {%value(float or int): {style_arguments:values}}, not all values need to be present. Defaults to False.</span>
</span><span id="Graphing.get_histogram-797"><a href="#Graphing.get_histogram-797"><span class="linenos">797</span></a><span class="sd">            cumulative_as_percentage (bool, optional): If True, the cumulative line is displayed as a percentage. Defaults to True.</span>
</span><span id="Graphing.get_histogram-798"><a href="#Graphing.get_histogram-798"><span class="linenos">798</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing.get_histogram-799"><a href="#Graphing.get_histogram-799"><span class="linenos">799</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing.get_histogram-800"><a href="#Graphing.get_histogram-800"><span class="linenos">800</span></a><span class="sd">            override_values (DataFrame, optional): DataFrame to override default values for the plot. Defaults to None.</span>
</span><span id="Graphing.get_histogram-801"><a href="#Graphing.get_histogram-801"><span class="linenos">801</span></a><span class="sd">            sharex (bool, optional): If True, share x-axis between subplots. Defaults to False.</span>
</span><span id="Graphing.get_histogram-802"><a href="#Graphing.get_histogram-802"><span class="linenos">802</span></a><span class="sd">            sharey (bool, optional): If True, share y-axis between subplots. Defaults to False.</span>
</span><span id="Graphing.get_histogram-803"><a href="#Graphing.get_histogram-803"><span class="linenos">803</span></a>
</span><span id="Graphing.get_histogram-804"><a href="#Graphing.get_histogram-804"><span class="linenos">804</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_histogram-805"><a href="#Graphing.get_histogram-805"><span class="linenos">805</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing.get_histogram-806"><a href="#Graphing.get_histogram-806"><span class="linenos">806</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_histogram-807"><a href="#Graphing.get_histogram-807"><span class="linenos">807</span></a>
</span><span id="Graphing.get_histogram-808"><a href="#Graphing.get_histogram-808"><span class="linenos">808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cumulative Markers format: {%value(float or int): {style_arguments:values}} not all values need to be present&quot;&quot;&quot;</span>
</span><span id="Graphing.get_histogram-809"><a href="#Graphing.get_histogram-809"><span class="linenos">809</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing.get_histogram-810"><a href="#Graphing.get_histogram-810"><span class="linenos">810</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-811"><a href="#Graphing.get_histogram-811"><span class="linenos">811</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-812"><a href="#Graphing.get_histogram-812"><span class="linenos">812</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing.get_histogram-813"><a href="#Graphing.get_histogram-813"><span class="linenos">813</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-814"><a href="#Graphing.get_histogram-814"><span class="linenos">814</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing.get_histogram-815"><a href="#Graphing.get_histogram-815"><span class="linenos">815</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_histogram-816"><a href="#Graphing.get_histogram-816"><span class="linenos">816</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-817"><a href="#Graphing.get_histogram-817"><span class="linenos">817</span></a>
</span><span id="Graphing.get_histogram-818"><a href="#Graphing.get_histogram-818"><span class="linenos">818</span></a>        <span class="c1"># extract rows from commute_data where office is the destination and data aligns with the employee addresses provided</span>
</span><span id="Graphing.get_histogram-819"><a href="#Graphing.get_histogram-819"><span class="linenos">819</span></a>        <span class="c1"># only the first row of office will be read, as it doesn&#39;t make sense to plot this for more than one on a heatmap</span>
</span><span id="Graphing.get_histogram-820"><a href="#Graphing.get_histogram-820"><span class="linenos">820</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-821"><a href="#Graphing.get_histogram-821"><span class="linenos">821</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="Graphing.get_histogram-822"><a href="#Graphing.get_histogram-822"><span class="linenos">822</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-823"><a href="#Graphing.get_histogram-823"><span class="linenos">823</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-824"><a href="#Graphing.get_histogram-824"><span class="linenos">824</span></a>
</span><span id="Graphing.get_histogram-825"><a href="#Graphing.get_histogram-825"><span class="linenos">825</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-826"><a href="#Graphing.get_histogram-826"><span class="linenos">826</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-827"><a href="#Graphing.get_histogram-827"><span class="linenos">827</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.995</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-828"><a href="#Graphing.get_histogram-828"><span class="linenos">828</span></a>        
</span><span id="Graphing.get_histogram-829"><a href="#Graphing.get_histogram-829"><span class="linenos">829</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing.get_histogram-830"><a href="#Graphing.get_histogram-830"><span class="linenos">830</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing.get_histogram-831"><a href="#Graphing.get_histogram-831"><span class="linenos">831</span></a>        <span class="n">y_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing.get_histogram-832"><a href="#Graphing.get_histogram-832"><span class="linenos">832</span></a>        <span class="n">x_max</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing.get_histogram-833"><a href="#Graphing.get_histogram-833"><span class="linenos">833</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="Graphing.get_histogram-834"><a href="#Graphing.get_histogram-834"><span class="linenos">834</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="Graphing.get_histogram-835"><a href="#Graphing.get_histogram-835"><span class="linenos">835</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="Graphing.get_histogram-836"><a href="#Graphing.get_histogram-836"><span class="linenos">836</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-837"><a href="#Graphing.get_histogram-837"><span class="linenos">837</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="Graphing.get_histogram-838"><a href="#Graphing.get_histogram-838"><span class="linenos">838</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="Graphing.get_histogram-839"><a href="#Graphing.get_histogram-839"><span class="linenos">839</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-840"><a href="#Graphing.get_histogram-840"><span class="linenos">840</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-841"><a href="#Graphing.get_histogram-841"><span class="linenos">841</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="Graphing.get_histogram-842"><a href="#Graphing.get_histogram-842"><span class="linenos">842</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-843"><a href="#Graphing.get_histogram-843"><span class="linenos">843</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-844"><a href="#Graphing.get_histogram-844"><span class="linenos">844</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="Graphing.get_histogram-845"><a href="#Graphing.get_histogram-845"><span class="linenos">845</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-846"><a href="#Graphing.get_histogram-846"><span class="linenos">846</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-847"><a href="#Graphing.get_histogram-847"><span class="linenos">847</span></a>            
</span><span id="Graphing.get_histogram-848"><a href="#Graphing.get_histogram-848"><span class="linenos">848</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing.get_histogram-849"><a href="#Graphing.get_histogram-849"><span class="linenos">849</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-850"><a href="#Graphing.get_histogram-850"><span class="linenos">850</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing.get_histogram-851"><a href="#Graphing.get_histogram-851"><span class="linenos">851</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing.get_histogram-852"><a href="#Graphing.get_histogram-852"><span class="linenos">852</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-853"><a href="#Graphing.get_histogram-853"><span class="linenos">853</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing.get_histogram-854"><a href="#Graphing.get_histogram-854"><span class="linenos">854</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing.get_histogram-855"><a href="#Graphing.get_histogram-855"><span class="linenos">855</span></a>            <span class="c1"># set x label only for last row</span>
</span><span id="Graphing.get_histogram-856"><a href="#Graphing.get_histogram-856"><span class="linenos">856</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-857"><a href="#Graphing.get_histogram-857"><span class="linenos">857</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-858"><a href="#Graphing.get_histogram-858"><span class="linenos">858</span></a>            <span class="c1"># set titles only for first row</span>
</span><span id="Graphing.get_histogram-859"><a href="#Graphing.get_histogram-859"><span class="linenos">859</span></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">column_titles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-860"><a href="#Graphing.get_histogram-860"><span class="linenos">860</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column_titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-861"><a href="#Graphing.get_histogram-861"><span class="linenos">861</span></a>            <span class="c1"># set y axis only for first col</span>
</span><span id="Graphing.get_histogram-862"><a href="#Graphing.get_histogram-862"><span class="linenos">862</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-863"><a href="#Graphing.get_histogram-863"><span class="linenos">863</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-864"><a href="#Graphing.get_histogram-864"><span class="linenos">864</span></a>            
</span><span id="Graphing.get_histogram-865"><a href="#Graphing.get_histogram-865"><span class="linenos">865</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing.get_histogram-866"><a href="#Graphing.get_histogram-866"><span class="linenos">866</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-867"><a href="#Graphing.get_histogram-867"><span class="linenos">867</span></a>                <span class="k">continue</span>
</span><span id="Graphing.get_histogram-868"><a href="#Graphing.get_histogram-868"><span class="linenos">868</span></a>        
</span><span id="Graphing.get_histogram-869"><a href="#Graphing.get_histogram-869"><span class="linenos">869</span></a>
</span><span id="Graphing.get_histogram-870"><a href="#Graphing.get_histogram-870"><span class="linenos">870</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing.get_histogram-871"><a href="#Graphing.get_histogram-871"><span class="linenos">871</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-872"><a href="#Graphing.get_histogram-872"><span class="linenos">872</span></a>
</span><span id="Graphing.get_histogram-873"><a href="#Graphing.get_histogram-873"><span class="linenos">873</span></a>            <span class="c1"># set the xticks and yticks font size</span>
</span><span id="Graphing.get_histogram-874"><a href="#Graphing.get_histogram-874"><span class="linenos">874</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-875"><a href="#Graphing.get_histogram-875"><span class="linenos">875</span></a>            
</span><span id="Graphing.get_histogram-876"><a href="#Graphing.get_histogram-876"><span class="linenos">876</span></a>
</span><span id="Graphing.get_histogram-877"><a href="#Graphing.get_histogram-877"><span class="linenos">877</span></a>            <span class="c1"># if cumulative line is requested, plot it</span>
</span><span id="Graphing.get_histogram-878"><a href="#Graphing.get_histogram-878"><span class="linenos">878</span></a>            <span class="k">if</span> <span class="n">cumulative_line</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-879"><a href="#Graphing.get_histogram-879"><span class="linenos">879</span></a>                <span class="n">twin</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="Graphing.get_histogram-880"><a href="#Graphing.get_histogram-880"><span class="linenos">880</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-881"><a href="#Graphing.get_histogram-881"><span class="linenos">881</span></a>
</span><span id="Graphing.get_histogram-882"><a href="#Graphing.get_histogram-882"><span class="linenos">882</span></a>                <span class="c1"># add a cumulative percentage line to the other y axis</span>
</span><span id="Graphing.get_histogram-883"><a href="#Graphing.get_histogram-883"><span class="linenos">883</span></a>                <span class="n">count</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-884"><a href="#Graphing.get_histogram-884"><span class="linenos">884</span></a>                <span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-885"><a href="#Graphing.get_histogram-885"><span class="linenos">885</span></a>                
</span><span id="Graphing.get_histogram-886"><a href="#Graphing.get_histogram-886"><span class="linenos">886</span></a>                <span class="c1"># get total cumulative for denominator to convert to percentage</span>
</span><span id="Graphing.get_histogram-887"><a href="#Graphing.get_histogram-887"><span class="linenos">887</span></a>                <span class="n">total</span> <span class="o">=</span> <span class="n">cumulative</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-888"><a href="#Graphing.get_histogram-888"><span class="linenos">888</span></a>                <span class="c1"># convert to percentage</span>
</span><span id="Graphing.get_histogram-889"><a href="#Graphing.get_histogram-889"><span class="linenos">889</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-890"><a href="#Graphing.get_histogram-890"><span class="linenos">890</span></a>                    <span class="n">cumulative</span> <span class="o">=</span> <span class="n">cumulative</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> 
</span><span id="Graphing.get_histogram-891"><a href="#Graphing.get_histogram-891"><span class="linenos">891</span></a>                
</span><span id="Graphing.get_histogram-892"><a href="#Graphing.get_histogram-892"><span class="linenos">892</span></a>                <span class="c1"># plot the cumulative line</span>
</span><span id="Graphing.get_histogram-893"><a href="#Graphing.get_histogram-893"><span class="linenos">893</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cumulative_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">cumulative_linestyle</span><span class="p">,</span> 
</span><span id="Graphing.get_histogram-894"><a href="#Graphing.get_histogram-894"><span class="linenos">894</span></a>                          <span class="n">linewidth</span><span class="o">=</span><span class="n">cumulative_linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cumulative_y_label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-895"><a href="#Graphing.get_histogram-895"><span class="linenos">895</span></a>
</span><span id="Graphing.get_histogram-896"><a href="#Graphing.get_histogram-896"><span class="linenos">896</span></a>                <span class="c1"># turn grid on relative to the twin y axis</span>
</span><span id="Graphing.get_histogram-897"><a href="#Graphing.get_histogram-897"><span class="linenos">897</span></a>                <span class="n">twin</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-898"><a href="#Graphing.get_histogram-898"><span class="linenos">898</span></a>                <span class="c1"># twin y ticks are percentage, set only for last column</span>
</span><span id="Graphing.get_histogram-899"><a href="#Graphing.get_histogram-899"><span class="linenos">899</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-900"><a href="#Graphing.get_histogram-900"><span class="linenos">900</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cumulative_y_label</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-901"><a href="#Graphing.get_histogram-901"><span class="linenos">901</span></a>                <span class="k">if</span> <span class="n">cumulative_as_percentage</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-902"><a href="#Graphing.get_histogram-902"><span class="linenos">902</span></a>                    <span class="c1"># set ticks every 25%, only show on last col</span>
</span><span id="Graphing.get_histogram-903"><a href="#Graphing.get_histogram-903"><span class="linenos">903</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</span><span id="Graphing.get_histogram-904"><a href="#Graphing.get_histogram-904"><span class="linenos">904</span></a>                <span class="c1"># turn off twin y axis numbers for first col</span>
</span><span id="Graphing.get_histogram-905"><a href="#Graphing.get_histogram-905"><span class="linenos">905</span></a>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-906"><a href="#Graphing.get_histogram-906"><span class="linenos">906</span></a>                    <span class="n">twin</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="Graphing.get_histogram-907"><a href="#Graphing.get_histogram-907"><span class="linenos">907</span></a>                
</span><span id="Graphing.get_histogram-908"><a href="#Graphing.get_histogram-908"><span class="linenos">908</span></a>                <span class="c1"># add markers to the cumulative line if requested</span>
</span><span id="Graphing.get_histogram-909"><a href="#Graphing.get_histogram-909"><span class="linenos">909</span></a>                <span class="k">if</span> <span class="n">cumulative_markers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-910"><a href="#Graphing.get_histogram-910"><span class="linenos">910</span></a>                    <span class="c1">#cumulative_markers format: {%value: {&#39;color&#39;: &#39;red&#39;, &#39;marker&#39;: &#39;o&#39;, &#39;label&#39;: &#39;75%&#39;, linestyle=&quot;--&quot;}} not all values need to be present</span>
</span><span id="Graphing.get_histogram-911"><a href="#Graphing.get_histogram-911"><span class="linenos">911</span></a>                    <span class="c1"># we plot a vertical line at x where y=%value on the twin</span>
</span><span id="Graphing.get_histogram-912"><a href="#Graphing.get_histogram-912"><span class="linenos">912</span></a>
</span><span id="Graphing.get_histogram-913"><a href="#Graphing.get_histogram-913"><span class="linenos">913</span></a>                    <span class="c1"># first get a polynomial fit to the cumulative percentage and find the x value where y is closest to %value</span>
</span><span id="Graphing.get_histogram-914"><a href="#Graphing.get_histogram-914"><span class="linenos">914</span></a>                    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="Graphing.get_histogram-915"><a href="#Graphing.get_histogram-915"><span class="linenos">915</span></a>                    
</span><span id="Graphing.get_histogram-916"><a href="#Graphing.get_histogram-916"><span class="linenos">916</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2000</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-917"><a href="#Graphing.get_histogram-917"><span class="linenos">917</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-918"><a href="#Graphing.get_histogram-918"><span class="linenos">918</span></a>                    
</span><span id="Graphing.get_histogram-919"><a href="#Graphing.get_histogram-919"><span class="linenos">919</span></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cumulative_markers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Graphing.get_histogram-920"><a href="#Graphing.get_histogram-920"><span class="linenos">920</span></a>                        <span class="c1"># get the x value where y is closest to key</span>
</span><span id="Graphing.get_histogram-921"><a href="#Graphing.get_histogram-921"><span class="linenos">921</span></a>                        <span class="n">xval</span> <span class="o">=</span> <span class="n">x</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
</span><span id="Graphing.get_histogram-922"><a href="#Graphing.get_histogram-922"><span class="linenos">922</span></a>                        <span class="c1"># add the line with the style arguments</span>
</span><span id="Graphing.get_histogram-923"><a href="#Graphing.get_histogram-923"><span class="linenos">923</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xval</span><span class="p">,</span> <span class="o">**</span><span class="n">value</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-924"><a href="#Graphing.get_histogram-924"><span class="linenos">924</span></a>                        <span class="c1"># insert a label at the top of the line</span>
</span><span id="Graphing.get_histogram-925"><a href="#Graphing.get_histogram-925"><span class="linenos">925</span></a>                        <span class="c1"># get width of the plot</span>
</span><span id="Graphing.get_histogram-926"><a href="#Graphing.get_histogram-926"><span class="linenos">926</span></a>                        <span class="n">x_max</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-927"><a href="#Graphing.get_histogram-927"><span class="linenos">927</span></a>                        <span class="n">x_min</span> <span class="o">=</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Graphing.get_histogram-928"><a href="#Graphing.get_histogram-928"><span class="linenos">928</span></a>                        <span class="c1"># calculate a delta for the label based on length                         </span>
</span><span id="Graphing.get_histogram-929"><a href="#Graphing.get_histogram-929"><span class="linenos">929</span></a>                        <span class="n">x_delta</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
</span><span id="Graphing.get_histogram-930"><a href="#Graphing.get_histogram-930"><span class="linenos">930</span></a>                        <span class="n">twin</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xval</span><span class="o">-</span><span class="n">x_delta</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cumulative</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xval</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
</span><span id="Graphing.get_histogram-931"><a href="#Graphing.get_histogram-931"><span class="linenos">931</span></a>
</span><span id="Graphing.get_histogram-932"><a href="#Graphing.get_histogram-932"><span class="linenos">932</span></a>            <span class="c1"># capture dimensionality for matching limits across cols/rows</span>
</span><span id="Graphing.get_histogram-933"><a href="#Graphing.get_histogram-933"><span class="linenos">933</span></a>            <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing.get_histogram-934"><a href="#Graphing.get_histogram-934"><span class="linenos">934</span></a>            <span class="n">x_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_max</span><span class="p">,</span> <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Graphing.get_histogram-935"><a href="#Graphing.get_histogram-935"><span class="linenos">935</span></a>
</span><span id="Graphing.get_histogram-936"><a href="#Graphing.get_histogram-936"><span class="linenos">936</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing.get_histogram-937"><a href="#Graphing.get_histogram-937"><span class="linenos">937</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-938"><a href="#Graphing.get_histogram-938"><span class="linenos">938</span></a>                <span class="k">continue</span>
</span><span id="Graphing.get_histogram-939"><a href="#Graphing.get_histogram-939"><span class="linenos">939</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-940"><a href="#Graphing.get_histogram-940"><span class="linenos">940</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing.get_histogram-941"><a href="#Graphing.get_histogram-941"><span class="linenos">941</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing.get_histogram-942"><a href="#Graphing.get_histogram-942"><span class="linenos">942</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_histogram-943"><a href="#Graphing.get_histogram-943"><span class="linenos">943</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing.get_histogram-944"><a href="#Graphing.get_histogram-944"><span class="linenos">944</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing.get_histogram-945"><a href="#Graphing.get_histogram-945"><span class="linenos">945</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-946"><a href="#Graphing.get_histogram-946"><span class="linenos">946</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>
</span><span id="Graphing.get_histogram-947"><a href="#Graphing.get_histogram-947"><span class="linenos">947</span></a>            <span class="c1">#axf(r,c).set_xticks(np.arange(0, max(xyz[values[i]]), max(xyz[values[i]])/bins))</span>
</span><span id="Graphing.get_histogram-948"><a href="#Graphing.get_histogram-948"><span class="linenos">948</span></a>            
</span><span id="Graphing.get_histogram-949"><a href="#Graphing.get_histogram-949"><span class="linenos">949</span></a>
</span><span id="Graphing.get_histogram-950"><a href="#Graphing.get_histogram-950"><span class="linenos">950</span></a>        <span class="c1">#plt.xlabel(x_label)</span>
</span><span id="Graphing.get_histogram-951"><a href="#Graphing.get_histogram-951"><span class="linenos">951</span></a>        <span class="c1">#plt.ylabel(y_label)</span>
</span><span id="Graphing.get_histogram-952"><a href="#Graphing.get_histogram-952"><span class="linenos">952</span></a>        
</span><span id="Graphing.get_histogram-953"><a href="#Graphing.get_histogram-953"><span class="linenos">953</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Generates a histogram (or set of histograms) for specified commute data metrics for employee locations relative to a single office location.</p>

<p>Args:
    emp (DataFrame): DataFrame containing employee locations with columns 'latitude' and 'longitude'.
    office (DataFrame): Single-row DataFrame representing the target office location.
    commute_data (DataFrame): DataFrame containing commute data metrics between employee locations and office locations.
    values (list of str): Names of the columns in <code>commute_data</code> representing the metrics to visualize in the histograms.
    title (str, optional): Main title for the histogram plot(s). Defaults to None.
    suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.
    value_label (str, optional): Label for the metric values. Defaults to ''.
    x_label (str, optional): Label for the x-axis. Defaults to ''.
    y_label (str, optional): Label for the y-axis. Defaults to ''.
    cutoff_radius (float, optional): Radius in miles to include employee locations from the office for the histograms. Defaults to None.
    commute_radius (float, optional): Specifies the radius within which employees are considered for the histograms. Defaults to None.
    bins (int, optional): Number of bins for the histograms. Defaults to 10.
    rows (int, optional): Number of rows in the subplot grid. Defaults to 1.
    cols (int, optional): Number of columns in the subplot grid. Defaults to 1.
    figsize (tuple, optional): Figure size. Defaults to (15, 15).
    column_titles (list of str, optional): Titles for each subplot column. Defaults to None.
    cumulative_line (bool, optional): If True, add a cumulative percentage line to the histograms. Defaults to False.
    cumulative_y_label (str, optional): Label for the cumulative percentage y-axis. Defaults to "Cumulative %".
    cumulative_color (str, optional): Color for the cumulative line. Defaults to 'black'.
    cumulative_linestyle (str, optional): Line style for the cumulative line. Defaults to '--'.
    cumulative_linewidth (int, optional): Line width for the cumulative line. Defaults to 1.
    cumulative_markers (dict, optional): Dictionary specifying markers for specific cumulative percentages on the line. Format {%value(float or int): {style_arguments:values}}, not all values need to be present. Defaults to False.
    cumulative_as_percentage (bool, optional): If True, the cumulative line is displayed as a percentage. Defaults to True.
    font_mod (int, optional): Font size modifier for the plot. Defaults to 1.
    manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.
    override_values (DataFrame, optional): DataFrame to override default values for the plot. Defaults to None.
    sharex (bool, optional): If True, share x-axis between subplots. Defaults to False.
    sharey (bool, optional): If True, share y-axis between subplots. Defaults to False.</p>

<p>Returns:
    tuple: A tuple containing the matplotlib figure and axes objects.</p>
</div>


                            </div>
                            <div id="Graphing.get_scatterplot" class="classattr">
                                        <input id="Graphing.get_scatterplot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_scatterplot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emp</span>,</span><span class="param">	<span class="n">office</span>,</span><span class="param">	<span class="n">commute_data</span>,</span><span class="param">	<span class="n">x_value</span>,</span><span class="param">	<span class="n">y_value</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>,</span><span class="param">	<span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">override_values</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_scatterplot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_scatterplot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_scatterplot-957"><a href="#Graphing.get_scatterplot-957"><span class="linenos"> 957</span></a>    <span class="k">def</span> <span class="nf">get_scatterplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing.get_scatterplot-958"><a href="#Graphing.get_scatterplot-958"><span class="linenos"> 958</span></a>                    <span class="n">commute_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Graphing.get_scatterplot-959"><a href="#Graphing.get_scatterplot-959"><span class="linenos"> 959</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_scatterplot-960"><a href="#Graphing.get_scatterplot-960"><span class="linenos"> 960</span></a><span class="sd">        Generates a scatterplot for selected commute (or provided) data.</span>
</span><span id="Graphing.get_scatterplot-961"><a href="#Graphing.get_scatterplot-961"><span class="linenos"> 961</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_scatterplot-962"><a href="#Graphing.get_scatterplot-962"><span class="linenos"> 962</span></a>
</span><span id="Graphing.get_scatterplot-963"><a href="#Graphing.get_scatterplot-963"><span class="linenos"> 963</span></a>
</span><span id="Graphing.get_scatterplot-964"><a href="#Graphing.get_scatterplot-964"><span class="linenos"> 964</span></a>        <span class="c1"># basic pre-filtering</span>
</span><span id="Graphing.get_scatterplot-965"><a href="#Graphing.get_scatterplot-965"><span class="linenos"> 965</span></a>        <span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_preamble</span><span class="p">(</span><span class="n">emp</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-966"><a href="#Graphing.get_scatterplot-966"><span class="linenos"> 966</span></a>        <span class="k">if</span> <span class="n">commute_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_scatterplot-967"><a href="#Graphing.get_scatterplot-967"><span class="linenos"> 967</span></a>            <span class="c1"># get the filtered_emp_points within the commute radius</span>
</span><span id="Graphing.get_scatterplot-968"><a href="#Graphing.get_scatterplot-968"><span class="linenos"> 968</span></a>            <span class="n">filtered_emp_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_drive_distance</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_radius</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-969"><a href="#Graphing.get_scatterplot-969"><span class="linenos"> 969</span></a>
</span><span id="Graphing.get_scatterplot-970"><a href="#Graphing.get_scatterplot-970"><span class="linenos"> 970</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing.get_scatterplot-971"><a href="#Graphing.get_scatterplot-971"><span class="linenos"> 971</span></a>        
</span><span id="Graphing.get_scatterplot-972"><a href="#Graphing.get_scatterplot-972"><span class="linenos"> 972</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_scatterplot-973"><a href="#Graphing.get_scatterplot-973"><span class="linenos"> 973</span></a>            <span class="n">x_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_value</span><span class="p">]</span>
</span><span id="Graphing.get_scatterplot-974"><a href="#Graphing.get_scatterplot-974"><span class="linenos"> 974</span></a>
</span><span id="Graphing.get_scatterplot-975"><a href="#Graphing.get_scatterplot-975"><span class="linenos"> 975</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_scatterplot-976"><a href="#Graphing.get_scatterplot-976"><span class="linenos"> 976</span></a>            <span class="n">y_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_value</span><span class="p">]</span>
</span><span id="Graphing.get_scatterplot-977"><a href="#Graphing.get_scatterplot-977"><span class="linenos"> 977</span></a>
</span><span id="Graphing.get_scatterplot-978"><a href="#Graphing.get_scatterplot-978"><span class="linenos"> 978</span></a>        
</span><span id="Graphing.get_scatterplot-979"><a href="#Graphing.get_scatterplot-979"><span class="linenos"> 979</span></a>        <span class="k">if</span> <span class="n">override_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_scatterplot-980"><a href="#Graphing.get_scatterplot-980"><span class="linenos"> 980</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">override_values</span>
</span><span id="Graphing.get_scatterplot-981"><a href="#Graphing.get_scatterplot-981"><span class="linenos"> 981</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_scatterplot-982"><a href="#Graphing.get_scatterplot-982"><span class="linenos"> 982</span></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_commute_values</span><span class="p">(</span><span class="n">filtered_emp_points</span><span class="p">,</span> <span class="n">office</span><span class="p">,</span> <span class="n">commute_data</span><span class="p">,</span> <span class="n">x_value</span> <span class="o">+</span> <span class="n">y_value</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-983"><a href="#Graphing.get_scatterplot-983"><span class="linenos"> 983</span></a>        
</span><span id="Graphing.get_scatterplot-984"><a href="#Graphing.get_scatterplot-984"><span class="linenos"> 984</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-985"><a href="#Graphing.get_scatterplot-985"><span class="linenos"> 985</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-986"><a href="#Graphing.get_scatterplot-986"><span class="linenos"> 986</span></a>        
</span><span id="Graphing.get_scatterplot-987"><a href="#Graphing.get_scatterplot-987"><span class="linenos"> 987</span></a>        <span class="c1"># set x label </span>
</span><span id="Graphing.get_scatterplot-988"><a href="#Graphing.get_scatterplot-988"><span class="linenos"> 988</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-989"><a href="#Graphing.get_scatterplot-989"><span class="linenos"> 989</span></a>        <span class="c1"># set title</span>
</span><span id="Graphing.get_scatterplot-990"><a href="#Graphing.get_scatterplot-990"><span class="linenos"> 990</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-991"><a href="#Graphing.get_scatterplot-991"><span class="linenos"> 991</span></a>        <span class="c1"># set y axis </span>
</span><span id="Graphing.get_scatterplot-992"><a href="#Graphing.get_scatterplot-992"><span class="linenos"> 992</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-993"><a href="#Graphing.get_scatterplot-993"><span class="linenos"> 993</span></a>        
</span><span id="Graphing.get_scatterplot-994"><a href="#Graphing.get_scatterplot-994"><span class="linenos"> 994</span></a>        <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing.get_scatterplot-995"><a href="#Graphing.get_scatterplot-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_scatterplot-996"><a href="#Graphing.get_scatterplot-996"><span class="linenos"> 996</span></a>            <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="Graphing.get_scatterplot-997"><a href="#Graphing.get_scatterplot-997"><span class="linenos"> 997</span></a>
</span><span id="Graphing.get_scatterplot-998"><a href="#Graphing.get_scatterplot-998"><span class="linenos"> 998</span></a>        <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing.get_scatterplot-999"><a href="#Graphing.get_scatterplot-999"><span class="linenos"> 999</span></a>        <span class="c1">#axf(r,c).hist(xyz[values[i]], bins=bins, alpha=0.5, edgecolor=&#39;gray&#39;, linewidth=1, zorder=2, align=&#39;mid&#39;, rwidth=0.8)</span>
</span><span id="Graphing.get_scatterplot-1000"><a href="#Graphing.get_scatterplot-1000"><span class="linenos">1000</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">x_value</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xyz</span><span class="p">[</span><span class="n">y_value</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-1001"><a href="#Graphing.get_scatterplot-1001"><span class="linenos">1001</span></a>
</span><span id="Graphing.get_scatterplot-1002"><a href="#Graphing.get_scatterplot-1002"><span class="linenos">1002</span></a>        <span class="c1"># set the xticks and yticks font size</span>
</span><span id="Graphing.get_scatterplot-1003"><a href="#Graphing.get_scatterplot-1003"><span class="linenos">1003</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_scatterplot-1004"><a href="#Graphing.get_scatterplot-1004"><span class="linenos">1004</span></a>            
</span><span id="Graphing.get_scatterplot-1005"><a href="#Graphing.get_scatterplot-1005"><span class="linenos">1005</span></a>        
</span><span id="Graphing.get_scatterplot-1006"><a href="#Graphing.get_scatterplot-1006"><span class="linenos">1006</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Generates a scatterplot for selected commute (or provided) data.</p>
</div>


                            </div>
                            <div id="Graphing.get_piechart" class="classattr">
                                        <input id="Graphing.get_piechart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_piechart</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">values</span>,</span><span class="param">	<span class="n">titles</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">value_labels</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">rows</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">cols</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">startangle</span><span class="o">=</span><span class="mi">90</span>,</span><span class="param">	<span class="n">colors</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Graphing.get_piechart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Graphing.get_piechart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Graphing.get_piechart-1008"><a href="#Graphing.get_piechart-1008"><span class="linenos">1008</span></a>    <span class="k">def</span> <span class="nf">get_piechart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value_labels</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Graphing.get_piechart-1009"><a href="#Graphing.get_piechart-1009"><span class="linenos">1009</span></a>                     <span class="n">manual_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_mod</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Graphing.get_piechart-1010"><a href="#Graphing.get_piechart-1010"><span class="linenos">1010</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Graphing.get_piechart-1011"><a href="#Graphing.get_piechart-1011"><span class="linenos">1011</span></a><span class="sd">        Generates a pie chart or charts for selected commute data.</span>
</span><span id="Graphing.get_piechart-1012"><a href="#Graphing.get_piechart-1012"><span class="linenos">1012</span></a>
</span><span id="Graphing.get_piechart-1013"><a href="#Graphing.get_piechart-1013"><span class="linenos">1013</span></a><span class="sd">        Args:</span>
</span><span id="Graphing.get_piechart-1014"><a href="#Graphing.get_piechart-1014"><span class="linenos">1014</span></a><span class="sd">            values (str or list): Names of the columns in `commute_data` representing the metrics to visualize in the pie chart(s).</span>
</span><span id="Graphing.get_piechart-1015"><a href="#Graphing.get_piechart-1015"><span class="linenos">1015</span></a><span class="sd">            title (str, optional): Title for the pie chart(s). Defaults to None.</span>
</span><span id="Graphing.get_piechart-1016"><a href="#Graphing.get_piechart-1016"><span class="linenos">1016</span></a><span class="sd">            suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.</span>
</span><span id="Graphing.get_piechart-1017"><a href="#Graphing.get_piechart-1017"><span class="linenos">1017</span></a><span class="sd">            value_labels (str or list, optional): Labels for the values in the pie chart(s). Defaults to &#39;&#39;.</span>
</span><span id="Graphing.get_piechart-1018"><a href="#Graphing.get_piechart-1018"><span class="linenos">1018</span></a><span class="sd">            figsize (tuple, optional): Figure size. Defaults to None.</span>
</span><span id="Graphing.get_piechart-1019"><a href="#Graphing.get_piechart-1019"><span class="linenos">1019</span></a><span class="sd">            manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.</span>
</span><span id="Graphing.get_piechart-1020"><a href="#Graphing.get_piechart-1020"><span class="linenos">1020</span></a><span class="sd">            font_mod (int, optional): Font size modifier for the plot. Defaults to 1.</span>
</span><span id="Graphing.get_piechart-1021"><a href="#Graphing.get_piechart-1021"><span class="linenos">1021</span></a><span class="sd">            rows (int, optional): Number of rows in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing.get_piechart-1022"><a href="#Graphing.get_piechart-1022"><span class="linenos">1022</span></a><span class="sd">            cols (int, optional): Number of columns in the subplot grid. Defaults to 1.</span>
</span><span id="Graphing.get_piechart-1023"><a href="#Graphing.get_piechart-1023"><span class="linenos">1023</span></a><span class="sd">            startangle (int, optional): Starting angle for the pie chart. Defaults to 90.</span>
</span><span id="Graphing.get_piechart-1024"><a href="#Graphing.get_piechart-1024"><span class="linenos">1024</span></a><span class="sd">            colors (list, optional): List of colors for the pie chart. For multi-row/col, list of lists. Defaults to None.</span>
</span><span id="Graphing.get_piechart-1025"><a href="#Graphing.get_piechart-1025"><span class="linenos">1025</span></a>
</span><span id="Graphing.get_piechart-1026"><a href="#Graphing.get_piechart-1026"><span class="linenos">1026</span></a><span class="sd">        Returns:</span>
</span><span id="Graphing.get_piechart-1027"><a href="#Graphing.get_piechart-1027"><span class="linenos">1027</span></a><span class="sd">            tuple: A tuple containing the matplotlib figure and axes objects.</span>
</span><span id="Graphing.get_piechart-1028"><a href="#Graphing.get_piechart-1028"><span class="linenos">1028</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Graphing.get_piechart-1029"><a href="#Graphing.get_piechart-1029"><span class="linenos">1029</span></a>        <span class="c1"># basic preamble</span>
</span><span id="Graphing.get_piechart-1030"><a href="#Graphing.get_piechart-1030"><span class="linenos">1030</span></a>        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1031"><a href="#Graphing.get_piechart-1031"><span class="linenos">1031</span></a>            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1032"><a href="#Graphing.get_piechart-1032"><span class="linenos">1032</span></a>            
</span><span id="Graphing.get_piechart-1033"><a href="#Graphing.get_piechart-1033"><span class="linenos">1033</span></a>        <span class="c1"># if values is a string, it is one value to plot, if it is iterable, we get and plot multiple</span>
</span><span id="Graphing.get_piechart-1034"><a href="#Graphing.get_piechart-1034"><span class="linenos">1034</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_piechart-1035"><a href="#Graphing.get_piechart-1035"><span class="linenos">1035</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1036"><a href="#Graphing.get_piechart-1036"><span class="linenos">1036</span></a>        
</span><span id="Graphing.get_piechart-1037"><a href="#Graphing.get_piechart-1037"><span class="linenos">1037</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_labels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_piechart-1038"><a href="#Graphing.get_piechart-1038"><span class="linenos">1038</span></a>            <span class="n">value_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">value_labels</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1039"><a href="#Graphing.get_piechart-1039"><span class="linenos">1039</span></a>
</span><span id="Graphing.get_piechart-1040"><a href="#Graphing.get_piechart-1040"><span class="linenos">1040</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Graphing.get_piechart-1041"><a href="#Graphing.get_piechart-1041"><span class="linenos">1041</span></a>            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">titles</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1042"><a href="#Graphing.get_piechart-1042"><span class="linenos">1042</span></a>
</span><span id="Graphing.get_piechart-1043"><a href="#Graphing.get_piechart-1043"><span class="linenos">1043</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1044"><a href="#Graphing.get_piechart-1044"><span class="linenos">1044</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1045"><a href="#Graphing.get_piechart-1045"><span class="linenos">1045</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1046"><a href="#Graphing.get_piechart-1046"><span class="linenos">1046</span></a>        
</span><span id="Graphing.get_piechart-1047"><a href="#Graphing.get_piechart-1047"><span class="linenos">1047</span></a>        <span class="n">r</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing.get_piechart-1048"><a href="#Graphing.get_piechart-1048"><span class="linenos">1048</span></a>        <span class="n">c</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Graphing.get_piechart-1049"><a href="#Graphing.get_piechart-1049"><span class="linenos">1049</span></a>        <span class="k">def</span> <span class="nf">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">):</span>
</span><span id="Graphing.get_piechart-1050"><a href="#Graphing.get_piechart-1050"><span class="linenos">1050</span></a>            <span class="c1"># if rows or cols is 1, ax is a 1D array, so we need to handle it differently</span>
</span><span id="Graphing.get_piechart-1051"><a href="#Graphing.get_piechart-1051"><span class="linenos">1051</span></a>            <span class="c1"># 1 row, 1 col, ax is a 1D array</span>
</span><span id="Graphing.get_piechart-1052"><a href="#Graphing.get_piechart-1052"><span class="linenos">1052</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1053"><a href="#Graphing.get_piechart-1053"><span class="linenos">1053</span></a>                <span class="k">return</span> <span class="n">ax</span>
</span><span id="Graphing.get_piechart-1054"><a href="#Graphing.get_piechart-1054"><span class="linenos">1054</span></a>            <span class="c1"># 1 row, multiple cols, ax is a 1D array</span>
</span><span id="Graphing.get_piechart-1055"><a href="#Graphing.get_piechart-1055"><span class="linenos">1055</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1056"><a href="#Graphing.get_piechart-1056"><span class="linenos">1056</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1057"><a href="#Graphing.get_piechart-1057"><span class="linenos">1057</span></a>            <span class="c1"># multiple rows, 1 col, ax is a 1D array</span>
</span><span id="Graphing.get_piechart-1058"><a href="#Graphing.get_piechart-1058"><span class="linenos">1058</span></a>            <span class="k">elif</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1059"><a href="#Graphing.get_piechart-1059"><span class="linenos">1059</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1060"><a href="#Graphing.get_piechart-1060"><span class="linenos">1060</span></a>            <span class="c1"># multiple rows, multiple cols, ax is a 2D array</span>
</span><span id="Graphing.get_piechart-1061"><a href="#Graphing.get_piechart-1061"><span class="linenos">1061</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1062"><a href="#Graphing.get_piechart-1062"><span class="linenos">1062</span></a>                <span class="k">return</span> <span class="n">ax</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="Graphing.get_piechart-1063"><a href="#Graphing.get_piechart-1063"><span class="linenos">1063</span></a>
</span><span id="Graphing.get_piechart-1064"><a href="#Graphing.get_piechart-1064"><span class="linenos">1064</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
</span><span id="Graphing.get_piechart-1065"><a href="#Graphing.get_piechart-1065"><span class="linenos">1065</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1066"><a href="#Graphing.get_piechart-1066"><span class="linenos">1066</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="Graphing.get_piechart-1067"><a href="#Graphing.get_piechart-1067"><span class="linenos">1067</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="Graphing.get_piechart-1068"><a href="#Graphing.get_piechart-1068"><span class="linenos">1068</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1069"><a href="#Graphing.get_piechart-1069"><span class="linenos">1069</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Graphing.get_piechart-1070"><a href="#Graphing.get_piechart-1070"><span class="linenos">1070</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Graphing.get_piechart-1071"><a href="#Graphing.get_piechart-1071"><span class="linenos">1071</span></a>            <span class="c1"># set title </span>
</span><span id="Graphing.get_piechart-1072"><a href="#Graphing.get_piechart-1072"><span class="linenos">1072</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1073"><a href="#Graphing.get_piechart-1073"><span class="linenos">1073</span></a>            <span class="c1"># if manually plotting, return the figure and axes</span>
</span><span id="Graphing.get_piechart-1074"><a href="#Graphing.get_piechart-1074"><span class="linenos">1074</span></a>            <span class="k">if</span> <span class="n">manual_plot</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1075"><a href="#Graphing.get_piechart-1075"><span class="linenos">1075</span></a>                <span class="k">continue</span>
</span><span id="Graphing.get_piechart-1076"><a href="#Graphing.get_piechart-1076"><span class="linenos">1076</span></a>            <span class="c1"># give the bars a border for visibility</span>
</span><span id="Graphing.get_piechart-1077"><a href="#Graphing.get_piechart-1077"><span class="linenos">1077</span></a>            <span class="n">textprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="o">*</span><span class="n">font_mod</span><span class="p">}</span>
</span><span id="Graphing.get_piechart-1078"><a href="#Graphing.get_piechart-1078"><span class="linenos">1078</span></a>            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1079"><a href="#Graphing.get_piechart-1079"><span class="linenos">1079</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1080"><a href="#Graphing.get_piechart-1080"><span class="linenos">1080</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Graphing.get_piechart-1081"><a href="#Graphing.get_piechart-1081"><span class="linenos">1081</span></a>                <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">value_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="n">startangle</span><span class="p">,</span> <span class="n">textprops</span><span class="o">=</span><span class="n">textprops</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1082"><a href="#Graphing.get_piechart-1082"><span class="linenos">1082</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>  <span class="c1"># Equal aspect ratio ensures that pie is drawn as a circle</span>
</span><span id="Graphing.get_piechart-1083"><a href="#Graphing.get_piechart-1083"><span class="linenos">1083</span></a>            <span class="n">axf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</span><span id="Graphing.get_piechart-1084"><a href="#Graphing.get_piechart-1084"><span class="linenos">1084</span></a>
</span><span id="Graphing.get_piechart-1085"><a href="#Graphing.get_piechart-1085"><span class="linenos">1085</span></a>
</span><span id="Graphing.get_piechart-1086"><a href="#Graphing.get_piechart-1086"><span class="linenos">1086</span></a>        <span class="k">return</span> <span class="n">plt</span><span class="p">,</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Generates a pie chart or charts for selected commute data.</p>

<p>Args:
    values (str or list): Names of the columns in <code>commute_data</code> representing the metrics to visualize in the pie chart(s).
    title (str, optional): Title for the pie chart(s). Defaults to None.
    suptitle (str, optional): Supplementary title for the whole figure. Defaults to None.
    value_labels (str or list, optional): Labels for the values in the pie chart(s). Defaults to ''.
    figsize (tuple, optional): Figure size. Defaults to None.
    manual_plot (bool, optional): If True, returns the matplotlib plt and axes objects for manual plotting. Defaults to False.
    font_mod (int, optional): Font size modifier for the plot. Defaults to 1.
    rows (int, optional): Number of rows in the subplot grid. Defaults to 1.
    cols (int, optional): Number of columns in the subplot grid. Defaults to 1.
    startangle (int, optional): Starting angle for the pie chart. Defaults to 90.
    colors (list, optional): List of colors for the pie chart. For multi-row/col, list of lists. Defaults to None.</p>

<p>Returns:
    tuple: A tuple containing the matplotlib figure and axes objects.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>